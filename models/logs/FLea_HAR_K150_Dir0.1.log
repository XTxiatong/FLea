================================================================================
Summary of training process:
Dataset                : UCI_HAR
Batch size             : 32
Learing rate           : 0.001
Number of total clients: 150
Split method           : distribution
Split parameter        : 0.1
Clients per round      : 15
Number of global rounds: 100
Number of local rounds : 5
Feature from layer     : 1
Feature percentage     : 0.1
Is interplolated       : False
Local training loss    : MCE_DeC_KL
Loss of beta           : 1.0
Algorithm              : FLea
Modelname              : HARNet
Mode                   : training
Seed                   : 0
================================================================================
Dataset: UCI_HAR
training: 7352 testing: 2947
Here
Pre-splits: [   0    1    2 ... 3673 3674 3675]
[   0    1    2 ... 3673 3674 3675]
[4 4 4 ... 3 3 3]
Pre-splits: [3676 3677 3678 ... 7349 7350 7351]
[3676 3677 3678 ... 7349 7350 7351]
[3 3 3 ... 1 1 1]
Done
Class frequencies:
client,class0,class1,class2,class3,class4,class5,Amount
Client   0,0.00,0.00,0.00,0.818,0.00,0.182,11
Client   1,0.00,0.071,0.00,0.286,0.643,0.00,14
Client   2,0.029,0.971,0.00,0.00,0.00,0.00,68
Client   3,0.00,0.059,0.00,0.912,0.00,0.029,34
Client   4,0.00,0.929,0.00,0.024,0.00,0.048,42
Client   5,0.00,0.00,0.00,0.00,1.000,0.00,31
Client   6,0.00,0.00,0.200,0.00,0.800,0.00,15
Client   7,0.00,0.00,0.00,0.500,0.500,0.00,4
Client   8,0.039,0.020,0.00,0.941,0.00,0.00,102
Client   9,0.417,0.00,0.00,0.583,0.00,0.00,12
Client  10,0.056,0.00,0.00,0.111,0.00,0.833,36
Client  11,0.00,0.00,0.00,0.389,0.611,0.00,18
Client  12,0.00,1.000,0.00,0.00,0.00,0.00,74
Client  13,0.00,0.00,0.00,0.00,0.500,0.500,4
Client  14,0.941,0.00,0.00,0.00,0.059,0.00,17
Client  15,0.00,0.00,0.00,1.000,0.00,0.00,50
Client  16,0.011,0.011,0.011,0.00,0.00,0.966,87
Client  17,0.00,0.00,0.00,0.636,0.273,0.091,11
Client  18,0.115,0.00,0.00,0.00,0.885,0.00,113
Client  19,0.00,0.00,0.00,1.000,0.00,0.00,143
Client  20,0.00,0.00,0.250,0.00,0.167,0.583,12
Client  21,0.00,0.00,0.00,0.333,0.667,0.00,9
Client  22,0.600,0.00,0.00,0.00,0.360,0.040,25
Client  23,0.333,0.00,0.00,0.00,0.00,0.667,3
Client  24,0.075,0.00,0.075,0.849,0.00,0.00,53
Client  25,0.00,0.00,0.00,0.571,0.00,0.429,7
Client  26,0.036,0.00,0.929,0.00,0.036,0.00,28
Client  27,0.00,0.00,1.000,0.00,0.00,0.00,58
Client  28,0.00,0.034,0.00,0.672,0.00,0.293,58
Client  29,0.00,0.244,0.00,0.00,0.756,0.00,123
Client  30,0.00,0.795,0.077,0.00,0.128,0.00,39
Client  31,1.000,0.00,0.00,0.00,0.00,0.00,133
Client  32,0.00,0.016,0.00,0.00,0.984,0.00,125
Client  33,0.00,0.00,0.250,0.750,0.00,0.00,36
Client  34,0.00,0.00,0.00,1.000,0.00,0.00,3
Client  35,0.765,0.00,0.00,0.059,0.059,0.118,17
Client  36,0.00,0.389,0.333,0.00,0.278,0.00,36
Client  37,1.000,0.00,0.00,0.00,0.00,0.00,51
Client  38,1.000,0.00,0.00,0.00,0.00,0.00,58
Client  39,0.250,0.00,0.250,0.00,0.500,0.00,4
Client  40,0.889,0.00,0.00,0.00,0.111,0.00,9
Client  41,1.000,0.00,0.00,0.00,0.00,0.00,200
Client  42,0.00,0.00,0.955,0.045,0.00,0.00,22
Client  43,0.00,0.276,0.069,0.00,0.00,0.655,29
Client  44,0.00,0.00,0.00,0.00,0.062,0.938,48
Client  45,0.050,0.00,0.950,0.00,0.00,0.00,40
Client  46,0.069,0.138,0.00,0.310,0.483,0.00,29
Client  47,0.038,0.00,0.00,0.00,0.00,0.962,52
Client  48,1.000,0.00,0.00,0.00,0.00,0.00,8
Client  49,0.00,0.00,1.000,0.00,0.00,0.00,9
Client  50,0.00,0.750,0.00,0.00,0.250,0.00,4
Client  51,0.288,0.00,0.219,0.00,0.493,0.00,73
Client  52,0.00,1.000,0.00,0.00,0.00,0.00,138
Client  53,0.00,0.00,0.00,0.315,0.222,0.463,54
Client  54,0.00,0.200,0.600,0.200,0.00,0.00,5
Client  55,0.00,0.171,0.00,0.224,0.00,0.605,76
Client  56,0.415,0.024,0.00,0.00,0.439,0.122,41
Client  57,1.000,0.00,0.00,0.00,0.00,0.00,50
Client  58,0.00,0.00,0.125,0.562,0.00,0.312,16
Client  59,0.00,0.00,0.00,0.344,0.00,0.656,61
Client  60,0.00,0.00,0.00,0.00,0.00,1.000,108
Client  61,0.019,0.00,0.981,0.00,0.00,0.00,104
Client  62,0.006,0.086,0.00,0.023,0.886,0.00,175
Client  63,0.00,0.00,0.971,0.029,0.00,0.00,34
Client  64,0.00,1.000,0.00,0.00,0.00,0.00,63
Client  65,0.00,0.00,0.00,0.007,0.118,0.876,153
Client  66,0.00,0.00,0.571,0.00,0.102,0.327,49
Client  67,0.00,0.800,0.00,0.00,0.200,0.00,20
Client  68,0.00,0.00,0.00,1.000,0.00,0.00,9
Client  69,0.00,1.000,0.00,0.00,0.00,0.00,8
Client  70,0.00,0.132,0.00,0.868,0.00,0.00,38
Client  71,0.00,1.000,0.00,0.00,0.00,0.00,17
Client  72,0.346,0.00,0.00,0.577,0.038,0.038,26
Client  73,0.169,0.00,0.831,0.00,0.00,0.00,71
Client  74,0.014,0.014,0.973,0.00,0.00,0.00,73
Client  75,0.00,0.750,0.00,0.250,0.00,0.00,4
Client  76,0.00,0.00,0.00,0.00,0.00,1.000,295
Client  77,0.00,0.889,0.00,0.111,0.00,0.00,9
Client  78,0.00,0.00,0.00,0.00,0.00,1.000,7
Client  79,0.583,0.00,0.417,0.00,0.00,0.00,84
Client  80,0.193,0.035,0.193,0.00,0.00,0.579,57
Client  81,0.790,0.210,0.00,0.00,0.00,0.00,62
Client  82,0.750,0.00,0.250,0.00,0.00,0.00,4
Client  83,0.787,0.00,0.021,0.021,0.149,0.021,47
Client  84,0.00,0.826,0.174,0.00,0.00,0.00,23
Client  85,0.00,0.00,0.176,0.00,0.059,0.765,17
Client  86,0.00,0.092,0.00,0.015,0.00,0.892,65
Client  87,0.024,0.024,0.00,0.024,0.00,0.927,41
Client  88,0.088,0.00,0.00,0.824,0.088,0.00,34
Client  89,0.00,0.154,0.00,0.538,0.192,0.115,26
Client  90,0.00,0.00,0.235,0.765,0.00,0.00,34
Client  91,0.00,0.133,0.00,0.767,0.033,0.067,30
Client  92,0.013,0.00,0.988,0.00,0.00,0.00,80
Client  93,0.00,0.00,0.167,0.00,0.833,0.00,6
Client  94,0.400,0.00,0.400,0.200,0.00,0.00,5
Client  95,0.00,0.00,0.909,0.00,0.091,0.00,11
Client  96,0.023,0.930,0.00,0.00,0.047,0.00,43
Client  97,1.000,0.00,0.00,0.00,0.00,0.00,113
Client  98,0.686,0.314,0.00,0.00,0.00,0.00,51
Client  99,0.00,0.200,0.250,0.00,0.00,0.550,20
Client 100,0.00,0.214,0.071,0.00,0.014,0.700,70
Client 101,0.348,0.00,0.652,0.00,0.00,0.00,69
Client 102,0.00,0.00,0.00,1.000,0.00,0.00,146
Client 103,0.007,0.00,0.993,0.00,0.00,0.00,151
Client 104,0.00,0.00,0.333,0.333,0.00,0.333,3
Client 105,0.00,0.00,0.500,0.00,0.00,0.500,4
Client 106,0.00,0.00,0.00,0.00,0.00,1.000,6
Client 107,0.00,0.00,0.00,0.00,0.00,1.000,15
Client 108,0.00,0.100,0.200,0.700,0.00,0.00,10
Client 109,0.00,1.000,0.00,0.00,0.00,0.00,159
Client 110,0.00,0.371,0.014,0.614,0.00,0.00,70
Client 111,0.053,0.00,0.00,0.842,0.00,0.105,19
Client 112,0.00,0.00,0.625,0.00,0.125,0.250,8
Client 113,0.00,0.00,0.068,0.932,0.00,0.00,103
Client 114,0.00,0.00,0.294,0.676,0.00,0.029,34
Client 115,0.103,0.00,0.00,0.00,0.897,0.00,136
Client 116,0.00,0.917,0.00,0.00,0.00,0.083,12
Client 117,0.00,0.00,0.00,0.270,0.730,0.00,111
Client 118,0.00,0.013,0.00,0.987,0.00,0.00,79
Client 119,0.068,0.003,0.00,0.00,0.929,0.00,367
Client 120,0.00,0.00,0.00,0.640,0.360,0.00,25
Client 121,0.875,0.00,0.00,0.00,0.00,0.125,8
Client 122,0.667,0.00,0.00,0.00,0.00,0.333,36
Client 123,0.00,0.00,0.615,0.00,0.308,0.077,13
Client 124,0.00,0.00,0.00,0.979,0.021,0.00,48
Client 125,0.034,0.00,0.00,0.00,0.00,0.966,29
Client 126,1.000,0.00,0.00,0.00,0.00,0.00,6
Client 127,0.00,0.00,0.122,0.585,0.293,0.00,41
Client 128,0.061,0.939,0.00,0.00,0.00,0.00,99
Client 129,0.00,0.00,0.451,0.00,0.00,0.549,91
Client 130,0.00,0.114,0.00,0.00,0.057,0.829,35
Client 131,0.00,0.00,0.250,0.00,0.00,0.750,8
Client 132,0.00,0.00,0.00,1.000,0.00,0.00,4
Client 133,0.050,0.050,0.00,0.500,0.00,0.400,20
Client 134,0.00,0.750,0.00,0.00,0.250,0.00,8
Client 135,0.833,0.00,0.00,0.167,0.00,0.00,6
Client 136,0.343,0.00,0.029,0.00,0.171,0.457,35
Client 137,0.00,0.030,0.364,0.00,0.00,0.606,33
Client 138,0.00,0.00,0.00,0.067,0.933,0.00,15
Client 139,0.00,0.00,0.00,1.000,0.00,0.00,11
Client 140,0.00,0.00,0.182,0.727,0.091,0.00,11
Client 141,0.00,0.100,0.900,0.00,0.00,0.00,20
Client 142,1.000,0.00,0.00,0.00,0.00,0.00,103
Client 143,0.00,0.527,0.00,0.00,0.00,0.473,93
Client 144,0.00,0.00,1.000,0.00,0.00,0.00,4
Client 145,0.775,0.00,0.00,0.00,0.225,0.00,40
Client 146,0.800,0.00,0.00,0.200,0.00,0.00,5
Client 147,0.00,1.000,0.00,0.00,0.00,0.00,13
Client 148,0.00,0.00,0.00,0.00,1.000,0.00,51
Client 149,0.040,0.520,0.040,0.200,0.040,0.160,25
Num_samples of Training set per client: [11, 14, 68, 34, 42, 31, 15, 4, 102, 12, 36, 18, 74, 4, 17, 50, 87, 11, 113, 143, 12, 9, 25, 3, 53, 7, 28, 58, 58, 123, 39, 133, 125, 36, 3, 17, 36, 51, 58, 4, 9, 200, 22, 29, 48, 40, 29, 52, 8, 9, 4, 73, 138, 54, 5, 76, 41, 50, 16, 61, 108, 104, 175, 34, 63, 153, 49, 20, 9, 8, 38, 17, 26, 71, 73, 4, 295, 9, 7, 84, 57, 62, 4, 47, 23, 17, 65, 41, 34, 26, 34, 30, 80, 6, 5, 11, 43, 113, 51, 20, 70, 69, 146, 151, 3, 4, 6, 15, 10, 159, 70, 19, 8, 103, 34, 136, 12, 111, 79, 367, 25, 8, 36, 13, 48, 29, 6, 41, 99, 91, 35, 8, 4, 20, 8, 6, 35, 33, 15, 11, 11, 20, 103, 93, 4, 40, 5, 13, 51, 25]
Total_training_samples: 7352
Global test set: 2947
Finish Generating Samples, distribution saved
HARNet(
  (layers): Sequential(
    (0): Sequential(
      (0): Conv2d(1, 64, kernel_size=(3, 1), stride=(3, 1), padding=(1, 1))
      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU(inplace=True)
    )
    (1): Sequential(
      (0): Conv2d(64, 128, kernel_size=(6, 1), stride=(2, 1), padding=(1, 1))
      (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU(inplace=True)
    )
    (2): Sequential(
      (0): Conv2d(128, 256, kernel_size=(6, 1), stride=(2, 1), padding=(1, 1))
      (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU(inplace=True)
    )
    (3): Sequential(
      (0): Conv2d(256, 256, kernel_size=(6, 1), stride=(2, 1), padding=(1, 1))
      (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU(inplace=True)
    )
  )
  (lin): Linear(in_features=8448, out_features=6, bias=True)
)
####### cuda #######
number of parameters: 691974
clients initializting...
output size: 6
torch.Size([11, 1, 128, 3]) torch.Size([11]) torch.Size([2947, 1, 128, 3])
torch.Size([11, 1, 128, 3]) torch.Size([11]) torch.Size([2947, 1, 128, 3])
torch.Size([14, 1, 128, 3]) torch.Size([14]) torch.Size([2947, 1, 128, 3])
torch.Size([68, 1, 128, 3]) torch.Size([68]) torch.Size([2947, 1, 128, 3])
torch.Size([34, 1, 128, 3]) torch.Size([34]) torch.Size([2947, 1, 128, 3])
torch.Size([42, 1, 128, 3]) torch.Size([42]) torch.Size([2947, 1, 128, 3])
torch.Size([31, 1, 128, 3]) torch.Size([31]) torch.Size([2947, 1, 128, 3])
torch.Size([15, 1, 128, 3]) torch.Size([15]) torch.Size([2947, 1, 128, 3])
torch.Size([4, 1, 128, 3]) torch.Size([4]) torch.Size([2947, 1, 128, 3])
torch.Size([102, 1, 128, 3]) torch.Size([102]) torch.Size([2947, 1, 128, 3])
torch.Size([12, 1, 128, 3]) torch.Size([12]) torch.Size([2947, 1, 128, 3])
torch.Size([36, 1, 128, 3]) torch.Size([36]) torch.Size([2947, 1, 128, 3])
torch.Size([18, 1, 128, 3]) torch.Size([18]) torch.Size([2947, 1, 128, 3])
torch.Size([74, 1, 128, 3]) torch.Size([74]) torch.Size([2947, 1, 128, 3])
torch.Size([4, 1, 128, 3]) torch.Size([4]) torch.Size([2947, 1, 128, 3])
torch.Size([17, 1, 128, 3]) torch.Size([17]) torch.Size([2947, 1, 128, 3])
torch.Size([50, 1, 128, 3]) torch.Size([50]) torch.Size([2947, 1, 128, 3])
torch.Size([87, 1, 128, 3]) torch.Size([87]) torch.Size([2947, 1, 128, 3])
torch.Size([11, 1, 128, 3]) torch.Size([11]) torch.Size([2947, 1, 128, 3])
torch.Size([113, 1, 128, 3]) torch.Size([113]) torch.Size([2947, 1, 128, 3])
torch.Size([143, 1, 128, 3]) torch.Size([143]) torch.Size([2947, 1, 128, 3])
torch.Size([12, 1, 128, 3]) torch.Size([12]) torch.Size([2947, 1, 128, 3])
torch.Size([9, 1, 128, 3]) torch.Size([9]) torch.Size([2947, 1, 128, 3])
torch.Size([25, 1, 128, 3]) torch.Size([25]) torch.Size([2947, 1, 128, 3])
torch.Size([3, 1, 128, 3]) torch.Size([3]) torch.Size([2947, 1, 128, 3])
torch.Size([53, 1, 128, 3]) torch.Size([53]) torch.Size([2947, 1, 128, 3])
torch.Size([7, 1, 128, 3]) torch.Size([7]) torch.Size([2947, 1, 128, 3])
torch.Size([28, 1, 128, 3]) torch.Size([28]) torch.Size([2947, 1, 128, 3])
torch.Size([58, 1, 128, 3]) torch.Size([58]) torch.Size([2947, 1, 128, 3])
torch.Size([58, 1, 128, 3]) torch.Size([58]) torch.Size([2947, 1, 128, 3])
torch.Size([123, 1, 128, 3]) torch.Size([123]) torch.Size([2947, 1, 128, 3])
torch.Size([39, 1, 128, 3]) torch.Size([39]) torch.Size([2947, 1, 128, 3])
torch.Size([133, 1, 128, 3]) torch.Size([133]) torch.Size([2947, 1, 128, 3])
torch.Size([125, 1, 128, 3]) torch.Size([125]) torch.Size([2947, 1, 128, 3])
torch.Size([36, 1, 128, 3]) torch.Size([36]) torch.Size([2947, 1, 128, 3])
torch.Size([3, 1, 128, 3]) torch.Size([3]) torch.Size([2947, 1, 128, 3])
torch.Size([17, 1, 128, 3]) torch.Size([17]) torch.Size([2947, 1, 128, 3])
torch.Size([36, 1, 128, 3]) torch.Size([36]) torch.Size([2947, 1, 128, 3])
torch.Size([51, 1, 128, 3]) torch.Size([51]) torch.Size([2947, 1, 128, 3])
torch.Size([58, 1, 128, 3]) torch.Size([58]) torch.Size([2947, 1, 128, 3])
torch.Size([4, 1, 128, 3]) torch.Size([4]) torch.Size([2947, 1, 128, 3])
torch.Size([9, 1, 128, 3]) torch.Size([9]) torch.Size([2947, 1, 128, 3])
torch.Size([200, 1, 128, 3]) torch.Size([200]) torch.Size([2947, 1, 128, 3])
torch.Size([22, 1, 128, 3]) torch.Size([22]) torch.Size([2947, 1, 128, 3])
torch.Size([29, 1, 128, 3]) torch.Size([29]) torch.Size([2947, 1, 128, 3])
torch.Size([48, 1, 128, 3]) torch.Size([48]) torch.Size([2947, 1, 128, 3])
torch.Size([40, 1, 128, 3]) torch.Size([40]) torch.Size([2947, 1, 128, 3])
torch.Size([29, 1, 128, 3]) torch.Size([29]) torch.Size([2947, 1, 128, 3])
torch.Size([52, 1, 128, 3]) torch.Size([52]) torch.Size([2947, 1, 128, 3])
torch.Size([8, 1, 128, 3]) torch.Size([8]) torch.Size([2947, 1, 128, 3])
torch.Size([9, 1, 128, 3]) torch.Size([9]) torch.Size([2947, 1, 128, 3])
torch.Size([4, 1, 128, 3]) torch.Size([4]) torch.Size([2947, 1, 128, 3])
torch.Size([73, 1, 128, 3]) torch.Size([73]) torch.Size([2947, 1, 128, 3])
torch.Size([138, 1, 128, 3]) torch.Size([138]) torch.Size([2947, 1, 128, 3])
torch.Size([54, 1, 128, 3]) torch.Size([54]) torch.Size([2947, 1, 128, 3])
torch.Size([5, 1, 128, 3]) torch.Size([5]) torch.Size([2947, 1, 128, 3])
torch.Size([76, 1, 128, 3]) torch.Size([76]) torch.Size([2947, 1, 128, 3])
torch.Size([41, 1, 128, 3]) torch.Size([41]) torch.Size([2947, 1, 128, 3])
torch.Size([50, 1, 128, 3]) torch.Size([50]) torch.Size([2947, 1, 128, 3])
torch.Size([16, 1, 128, 3]) torch.Size([16]) torch.Size([2947, 1, 128, 3])
torch.Size([61, 1, 128, 3]) torch.Size([61]) torch.Size([2947, 1, 128, 3])
torch.Size([108, 1, 128, 3]) torch.Size([108]) torch.Size([2947, 1, 128, 3])
torch.Size([104, 1, 128, 3]) torch.Size([104]) torch.Size([2947, 1, 128, 3])
torch.Size([175, 1, 128, 3]) torch.Size([175]) torch.Size([2947, 1, 128, 3])
torch.Size([34, 1, 128, 3]) torch.Size([34]) torch.Size([2947, 1, 128, 3])
torch.Size([63, 1, 128, 3]) torch.Size([63]) torch.Size([2947, 1, 128, 3])
torch.Size([153, 1, 128, 3]) torch.Size([153]) torch.Size([2947, 1, 128, 3])
torch.Size([49, 1, 128, 3]) torch.Size([49]) torch.Size([2947, 1, 128, 3])
torch.Size([20, 1, 128, 3]) torch.Size([20]) torch.Size([2947, 1, 128, 3])
torch.Size([9, 1, 128, 3]) torch.Size([9]) torch.Size([2947, 1, 128, 3])
torch.Size([8, 1, 128, 3]) torch.Size([8]) torch.Size([2947, 1, 128, 3])
torch.Size([38, 1, 128, 3]) torch.Size([38]) torch.Size([2947, 1, 128, 3])
torch.Size([17, 1, 128, 3]) torch.Size([17]) torch.Size([2947, 1, 128, 3])
torch.Size([26, 1, 128, 3]) torch.Size([26]) torch.Size([2947, 1, 128, 3])
torch.Size([71, 1, 128, 3]) torch.Size([71]) torch.Size([2947, 1, 128, 3])
torch.Size([73, 1, 128, 3]) torch.Size([73]) torch.Size([2947, 1, 128, 3])
torch.Size([4, 1, 128, 3]) torch.Size([4]) torch.Size([2947, 1, 128, 3])
torch.Size([295, 1, 128, 3]) torch.Size([295]) torch.Size([2947, 1, 128, 3])
torch.Size([9, 1, 128, 3]) torch.Size([9]) torch.Size([2947, 1, 128, 3])
torch.Size([7, 1, 128, 3]) torch.Size([7]) torch.Size([2947, 1, 128, 3])
torch.Size([84, 1, 128, 3]) torch.Size([84]) torch.Size([2947, 1, 128, 3])
torch.Size([57, 1, 128, 3]) torch.Size([57]) torch.Size([2947, 1, 128, 3])
torch.Size([62, 1, 128, 3]) torch.Size([62]) torch.Size([2947, 1, 128, 3])
torch.Size([4, 1, 128, 3]) torch.Size([4]) torch.Size([2947, 1, 128, 3])
torch.Size([47, 1, 128, 3]) torch.Size([47]) torch.Size([2947, 1, 128, 3])
torch.Size([23, 1, 128, 3]) torch.Size([23]) torch.Size([2947, 1, 128, 3])
torch.Size([17, 1, 128, 3]) torch.Size([17]) torch.Size([2947, 1, 128, 3])
torch.Size([65, 1, 128, 3]) torch.Size([65]) torch.Size([2947, 1, 128, 3])
torch.Size([41, 1, 128, 3]) torch.Size([41]) torch.Size([2947, 1, 128, 3])
torch.Size([34, 1, 128, 3]) torch.Size([34]) torch.Size([2947, 1, 128, 3])
torch.Size([26, 1, 128, 3]) torch.Size([26]) torch.Size([2947, 1, 128, 3])
torch.Size([34, 1, 128, 3]) torch.Size([34]) torch.Size([2947, 1, 128, 3])
torch.Size([30, 1, 128, 3]) torch.Size([30]) torch.Size([2947, 1, 128, 3])
torch.Size([80, 1, 128, 3]) torch.Size([80]) torch.Size([2947, 1, 128, 3])
torch.Size([6, 1, 128, 3]) torch.Size([6]) torch.Size([2947, 1, 128, 3])
torch.Size([5, 1, 128, 3]) torch.Size([5]) torch.Size([2947, 1, 128, 3])
torch.Size([11, 1, 128, 3]) torch.Size([11]) torch.Size([2947, 1, 128, 3])
torch.Size([43, 1, 128, 3]) torch.Size([43]) torch.Size([2947, 1, 128, 3])
torch.Size([113, 1, 128, 3]) torch.Size([113]) torch.Size([2947, 1, 128, 3])
torch.Size([51, 1, 128, 3]) torch.Size([51]) torch.Size([2947, 1, 128, 3])
torch.Size([20, 1, 128, 3]) torch.Size([20]) torch.Size([2947, 1, 128, 3])
torch.Size([70, 1, 128, 3]) torch.Size([70]) torch.Size([2947, 1, 128, 3])
torch.Size([69, 1, 128, 3]) torch.Size([69]) torch.Size([2947, 1, 128, 3])
torch.Size([146, 1, 128, 3]) torch.Size([146]) torch.Size([2947, 1, 128, 3])
torch.Size([151, 1, 128, 3]) torch.Size([151]) torch.Size([2947, 1, 128, 3])
torch.Size([3, 1, 128, 3]) torch.Size([3]) torch.Size([2947, 1, 128, 3])
torch.Size([4, 1, 128, 3]) torch.Size([4]) torch.Size([2947, 1, 128, 3])
torch.Size([6, 1, 128, 3]) torch.Size([6]) torch.Size([2947, 1, 128, 3])
torch.Size([15, 1, 128, 3]) torch.Size([15]) torch.Size([2947, 1, 128, 3])
torch.Size([10, 1, 128, 3]) torch.Size([10]) torch.Size([2947, 1, 128, 3])
torch.Size([159, 1, 128, 3]) torch.Size([159]) torch.Size([2947, 1, 128, 3])
torch.Size([70, 1, 128, 3]) torch.Size([70]) torch.Size([2947, 1, 128, 3])
torch.Size([19, 1, 128, 3]) torch.Size([19]) torch.Size([2947, 1, 128, 3])
torch.Size([8, 1, 128, 3]) torch.Size([8]) torch.Size([2947, 1, 128, 3])
torch.Size([103, 1, 128, 3]) torch.Size([103]) torch.Size([2947, 1, 128, 3])
torch.Size([34, 1, 128, 3]) torch.Size([34]) torch.Size([2947, 1, 128, 3])
torch.Size([136, 1, 128, 3]) torch.Size([136]) torch.Size([2947, 1, 128, 3])
torch.Size([12, 1, 128, 3]) torch.Size([12]) torch.Size([2947, 1, 128, 3])
torch.Size([111, 1, 128, 3]) torch.Size([111]) torch.Size([2947, 1, 128, 3])
torch.Size([79, 1, 128, 3]) torch.Size([79]) torch.Size([2947, 1, 128, 3])
torch.Size([367, 1, 128, 3]) torch.Size([367]) torch.Size([2947, 1, 128, 3])
torch.Size([25, 1, 128, 3]) torch.Size([25]) torch.Size([2947, 1, 128, 3])
torch.Size([8, 1, 128, 3]) torch.Size([8]) torch.Size([2947, 1, 128, 3])
torch.Size([36, 1, 128, 3]) torch.Size([36]) torch.Size([2947, 1, 128, 3])
torch.Size([13, 1, 128, 3]) torch.Size([13]) torch.Size([2947, 1, 128, 3])
torch.Size([48, 1, 128, 3]) torch.Size([48]) torch.Size([2947, 1, 128, 3])
torch.Size([29, 1, 128, 3]) torch.Size([29]) torch.Size([2947, 1, 128, 3])
torch.Size([6, 1, 128, 3]) torch.Size([6]) torch.Size([2947, 1, 128, 3])
torch.Size([41, 1, 128, 3]) torch.Size([41]) torch.Size([2947, 1, 128, 3])
torch.Size([99, 1, 128, 3]) torch.Size([99]) torch.Size([2947, 1, 128, 3])
torch.Size([91, 1, 128, 3]) torch.Size([91]) torch.Size([2947, 1, 128, 3])
torch.Size([35, 1, 128, 3]) torch.Size([35]) torch.Size([2947, 1, 128, 3])
torch.Size([8, 1, 128, 3]) torch.Size([8]) torch.Size([2947, 1, 128, 3])
torch.Size([4, 1, 128, 3]) torch.Size([4]) torch.Size([2947, 1, 128, 3])
torch.Size([20, 1, 128, 3]) torch.Size([20]) torch.Size([2947, 1, 128, 3])
torch.Size([8, 1, 128, 3]) torch.Size([8]) torch.Size([2947, 1, 128, 3])
torch.Size([6, 1, 128, 3]) torch.Size([6]) torch.Size([2947, 1, 128, 3])
torch.Size([35, 1, 128, 3]) torch.Size([35]) torch.Size([2947, 1, 128, 3])
torch.Size([33, 1, 128, 3]) torch.Size([33]) torch.Size([2947, 1, 128, 3])
torch.Size([15, 1, 128, 3]) torch.Size([15]) torch.Size([2947, 1, 128, 3])
torch.Size([11, 1, 128, 3]) torch.Size([11]) torch.Size([2947, 1, 128, 3])
torch.Size([11, 1, 128, 3]) torch.Size([11]) torch.Size([2947, 1, 128, 3])
torch.Size([20, 1, 128, 3]) torch.Size([20]) torch.Size([2947, 1, 128, 3])
torch.Size([103, 1, 128, 3]) torch.Size([103]) torch.Size([2947, 1, 128, 3])
torch.Size([93, 1, 128, 3]) torch.Size([93]) torch.Size([2947, 1, 128, 3])
torch.Size([4, 1, 128, 3]) torch.Size([4]) torch.Size([2947, 1, 128, 3])
torch.Size([40, 1, 128, 3]) torch.Size([40]) torch.Size([2947, 1, 128, 3])
torch.Size([5, 1, 128, 3]) torch.Size([5]) torch.Size([2947, 1, 128, 3])
torch.Size([13, 1, 128, 3]) torch.Size([13]) torch.Size([2947, 1, 128, 3])
torch.Size([51, 1, 128, 3]) torch.Size([51]) torch.Size([2947, 1, 128, 3])
torch.Size([25, 1, 128, 3]) torch.Size([25]) torch.Size([2947, 1, 128, 3])
Number of users per round / total users: 15  /  150
Finished creating FL server.
=== Training starts: algorithm FLea ===
-------------Round number:  0  -------------
selected users: [114, 62, 33, 107, 7, 100, 40, 86, 76, 71, 134, 51, 73, 54, 63]
Local adapation with distilling: 0.001
alpha3: 3
training: CE_COR_KL CEloss: tensor(1.0032) KLloss: tensor(1.1388) Decorrelation loss: tensor(2.9524)
decorrelation: tensor([0.9899, 0.9876, 0.9870, 0.9877, 0.9869, 0.9872, 0.9838, 0.9823, 0.9841,
        0.9826, 0.9835, 0.9819, 0.9795, 0.9790, 0.9790])
The last decorrelation: tensor(0.9790)
Local adapation with distilling: 0.001
alpha3: 3
training: CE_COR_KL CEloss: tensor(0.7741) KLloss: tensor(0.9468) Decorrelation loss: tensor(2.8860)
decorrelation: tensor([0.9868, 0.9864, 0.9809, 0.9741, 0.9702, 0.9603, 0.9629, 0.9618, 0.9593,
        0.9326, 0.9592, 0.9536, 0.9462, 0.9453, 0.9504])
The last decorrelation: tensor(0.9504)
Local adapation with distilling: 0.001
alpha3: 3
training: CE_COR_KL CEloss: tensor(1.0306) KLloss: tensor(1.2645) Decorrelation loss: tensor(2.9377)
decorrelation: tensor([0.9893, 0.9840, 0.9872, 0.9911, 0.9822, 0.9806, 0.9805, 0.9812, 0.9824,
        0.9719, 0.9748, 0.9764, 0.9587, 0.9724, 0.9758])
The last decorrelation: tensor(0.9758)
Local adapation with distilling: 0.001
alpha3: 3
training: CE_COR_KL CEloss: tensor(0.7997) KLloss: tensor(1.7157) Decorrelation loss: tensor(2.8347)
decorrelation: tensor([0.9819, 0.9797, 0.9771, 0.9772, 0.9703, 0.9661, 0.9563, 0.9506, 0.9402,
        0.9344, 0.9222, 0.9176, 0.9065, 0.9009, 0.8926])
The last decorrelation: tensor(0.8926)
Local adapation with distilling: 0.001
alpha3: 3
training: CE_COR_KL CEloss: tensor(1.2873) KLloss: tensor(1.1957) Decorrelation loss: tensor(2.9919)
decorrelation: tensor([0.9985, 0.9985, 0.9980, 0.9978, 0.9980, 0.9981, 0.9972, 0.9971, 0.9976,
        0.9974, 0.9964, 0.9970, 0.9956, 0.9963, 0.9958])
The last decorrelation: tensor(0.9958)
Local adapation with distilling: 0.001
alpha3: 3
training: CE_COR_KL CEloss: tensor(0.9840) KLloss: tensor(1.1893) Decorrelation loss: tensor(2.9098)
decorrelation: tensor([0.9816, 0.9797, 0.9734, 0.9735, 0.9755, 0.9729, 0.9723, 0.9675, 0.9718,
        0.9688, 0.9667, 0.9714, 0.9581, 0.9591, 0.9568])
The last decorrelation: tensor(0.9568)
Local adapation with distilling: 0.001
alpha3: 3
training: CE_COR_KL CEloss: tensor(0.6606) KLloss: tensor(2.4762) Decorrelation loss: tensor(2.9616)
decorrelation: tensor([0.9910, 0.9907, 0.9904, 0.9908, 0.9904, 0.9902, 0.9892, 0.9886, 0.9876,
        0.9870, 0.9856, 0.9841, 0.9820, 0.9813, 0.9791])
The last decorrelation: tensor(0.9791)
Local adapation with distilling: 0.001
alpha3: 3
training: CE_COR_KL CEloss: tensor(0.7904) KLloss: tensor(1.4142) Decorrelation loss: tensor(2.9340)
decorrelation: tensor([0.9900, 0.9891, 0.9869, 0.9865, 0.9878, 0.9787, 0.9779, 0.9710, 0.9722,
        0.9768, 0.9767, 0.9738, 0.9700, 0.9662, 0.9662])
The last decorrelation: tensor(0.9662)
Local adapation with distilling: 0.001
alpha3: 3
training: CE_COR_KL CEloss: tensor(0.5602) KLloss: tensor(1.0467) Decorrelation loss: tensor(2.8801)
decorrelation: tensor([0.9863, 0.9794, 0.9769, 0.9661, 0.9592, 0.9591, 0.9579, 0.9624, 0.9587,
        0.9390, 0.9501, 0.9553, 0.9553, 0.9506, 0.9443])
The last decorrelation: tensor(0.9443)
Local adapation with distilling: 0.001
alpha3: 3
training: CE_COR_KL CEloss: tensor(0.6807) KLloss: tensor(2.2879) Decorrelation loss: tensor(2.8857)
decorrelation: tensor([0.9813, 0.9829, 0.9824, 0.9819, 0.9799, 0.9770, 0.9720, 0.9639, 0.9587,
        0.9515, 0.9443, 0.9447, 0.9363, 0.9363, 0.9353])
The last decorrelation: tensor(0.9353)
Local adapation with distilling: 0.001
alpha3: 3
training: CE_COR_KL CEloss: tensor(1.0718) KLloss: tensor(1.6098) Decorrelation loss: tensor(2.9359)
decorrelation: tensor([0.9856, 0.9848, 0.9843, 0.9846, 0.9836, 0.9828, 0.9811, 0.9813, 0.9791,
        0.9781, 0.9760, 0.9741, 0.9710, 0.9684, 0.9649])
The last decorrelation: tensor(0.9649)
Local adapation with distilling: 0.001
alpha3: 3
training: CE_COR_KL CEloss: tensor(0.8809) KLloss: tensor(1.2361) Decorrelation loss: tensor(2.8525)
decorrelation: tensor([0.9764, 0.9728, 0.9731, 0.9710, 0.9625, 0.9574, 0.9551, 0.9494, 0.9472,
        0.9435, 0.9347, 0.9390, 0.9302, 0.9275, 0.9226])
The last decorrelation: tensor(0.9226)
Local adapation with distilling: 0.001
alpha3: 3
training: CE_COR_KL CEloss: tensor(1.3940) KLloss: tensor(1.1151) Decorrelation loss: tensor(2.8243)
decorrelation: tensor([0.9807, 0.9795, 0.9685, 0.9648, 0.9558, 0.9351, 0.9444, 0.9348, 0.9250,
        0.9300, 0.9270, 0.9237, 0.9197, 0.9192, 0.9134])
The last decorrelation: tensor(0.9134)
Local adapation with distilling: 0.001
alpha3: 3
training: CE_COR_KL CEloss: tensor(1.1998) KLloss: tensor(1.5395) Decorrelation loss: tensor(2.9830)
decorrelation: tensor([0.9951, 0.9952, 0.9950, 0.9951, 0.9948, 0.9944, 0.9946, 0.9944, 0.9943,
        0.9939, 0.9942, 0.9937, 0.9937, 0.9932, 0.9935])
The last decorrelation: tensor(0.9935)
Local adapation with distilling: 0.001
alpha3: 3
training: CE_COR_KL CEloss: tensor(1.5123) KLloss: tensor(1.4692) Decorrelation loss: tensor(2.9013)
decorrelation: tensor([0.9876, 0.9848, 0.9791, 0.9750, 0.9750, 0.9752, 0.9686, 0.9618, 0.9618,
        0.9599, 0.9651, 0.9562, 0.9504, 0.9561, 0.9499])
The last decorrelation: tensor(0.9499)
Global Model Acc on global data: 0.18221920597217509 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  1  -------------
selected users: [14, 98, 75, 16, 131, 56, 141, 44, 29, 120, 94, 5, 102, 51, 78]
Current data/feature buff: torch.Size([84, 128, 20, 7]) torch.Size([84]) 84
Buffer classes: Counter({5: 39, 4: 21, 2: 15, 3: 4, 1: 3, 0: 2})
Local adapation with distilling: 0.000982 alphas: 1 1 2.9 1
MCE_DeC_KL Total: tensor(7.5626) local CE: tensor(2.0492) Feature CE: tensor(2.3253) KL: tensor(0.3971)
The last decorrelation: tensor(0.9539)
Local adapation with distilling: 0.000982 alphas: 1 1 2.9 1
MCE_DeC_KL Total: tensor(7.2667) local CE: tensor(1.8568) Feature CE: tensor(2.2304) KL: tensor(0.4665)
The last decorrelation: tensor(0.9239)
Local adapation with distilling: 0.000982 alphas: 1 1 2.9 1
MCE_DeC_KL Total: tensor(6.6340) local CE: tensor(1.1839) Feature CE: tensor(1.7689) KL: tensor(0.8159)
The last decorrelation: tensor(0.9878)
Local adapation with distilling: 0.000982 alphas: 1 1 2.9 1
MCE_DeC_KL Total: tensor(5.2922) local CE: tensor(0.6162) Feature CE: tensor(1.2576) KL: tensor(0.5934)
The last decorrelation: tensor(0.9774)
Local adapation with distilling: 0.000982 alphas: 1 1 2.9 1
MCE_DeC_KL Total: tensor(5.8960) local CE: tensor(0.8625) Feature CE: tensor(1.5077) KL: tensor(0.6938)
The last decorrelation: tensor(0.9768)
Local adapation with distilling: 0.000982 alphas: 1 1 2.9 1
MCE_DeC_KL Total: tensor(6.6853) local CE: tensor(1.2792) Feature CE: tensor(1.9631) KL: tensor(0.6865)
The last decorrelation: tensor(0.9490)
Local adapation with distilling: 0.000982 alphas: 1 1 2.9 1
MCE_DeC_KL Total: tensor(7.0415) local CE: tensor(1.8122) Feature CE: tensor(2.0461) KL: tensor(0.3944)
The last decorrelation: tensor(0.9490)
Local adapation with distilling: 0.000982 alphas: 1 1 2.9 1
MCE_DeC_KL Total: tensor(5.6133) local CE: tensor(0.8004) Feature CE: tensor(1.2772) KL: tensor(0.6490)
The last decorrelation: tensor(0.9952)
Local adapation with distilling: 0.000982 alphas: 1 1 2.9 1
MCE_DeC_KL Total: tensor(5.4684) local CE: tensor(0.7455) Feature CE: tensor(1.5153) KL: tensor(0.5465)
The last decorrelation: tensor(0.9052)
Local adapation with distilling: 0.000982 alphas: 1 1 2.9 1
MCE_DeC_KL Total: tensor(6.4592) local CE: tensor(1.3648) Feature CE: tensor(1.9141) KL: tensor(0.4390)
The last decorrelation: tensor(0.9448)
Local adapation with distilling: 0.000982 alphas: 1 1 2.9 1
MCE_DeC_KL Total: tensor(6.6564) local CE: tensor(1.3615) Feature CE: tensor(1.9342) KL: tensor(0.5253)
The last decorrelation: tensor(0.9756)
Local adapation with distilling: 0.000982 alphas: 1 1 2.9 1
MCE_DeC_KL Total: tensor(5.8693) local CE: tensor(1.0504) Feature CE: tensor(1.5473) KL: tensor(0.5968)
The last decorrelation: tensor(0.9192)
Local adapation with distilling: 0.000982 alphas: 1 1 2.9 1
MCE_DeC_KL Total: tensor(5.5765) local CE: tensor(0.7577) Feature CE: tensor(1.5653) KL: tensor(0.4817)
The last decorrelation: tensor(0.9453)
Local adapation with distilling: 0.000982 alphas: 1 1 2.9 1
MCE_DeC_KL Total: tensor(6.1549) local CE: tensor(1.2100) Feature CE: tensor(1.7411) KL: tensor(0.4919)
The last decorrelation: tensor(0.9321)
Local adapation with distilling: 0.000982 alphas: 1 1 2.9 1
MCE_DeC_KL Total: tensor(4.8342) local CE: tensor(0.5535) Feature CE: tensor(0.9980) KL: tensor(0.3845)
The last decorrelation: tensor(0.9993)
Global Model Acc on global data: 0.166949440108585 length of data: 2947
save a model
size of the global feature buffer: 15
-------------Round number:  2  -------------
selected users: [6, 3, 113, 12, 24, 129, 25, 108, 128, 45, 48, 42, 35, 5, 85]
Current data/feature buff: torch.Size([62, 128, 20, 7]) torch.Size([62]) 62
Buffer classes: Counter({4: 21, 3: 15, 5: 10, 0: 8, 1: 5, 2: 3})
Local adapation with distilling: 0.000964 alphas: 1 1 2.8 1
MCE_DeC_KL Total: tensor(5.3085) local CE: tensor(0.7264) Feature CE: tensor(1.4680) KL: tensor(0.4616)
The last decorrelation: tensor(0.9421)
Local adapation with distilling: 0.000964 alphas: 1 1 2.8 1
MCE_DeC_KL Total: tensor(6.0014) local CE: tensor(0.6958) Feature CE: tensor(1.4612) KL: tensor(1.0870)
The last decorrelation: tensor(0.9861)
Local adapation with distilling: 0.000964 alphas: 1 1 2.8 1
MCE_DeC_KL Total: tensor(5.5303) local CE: tensor(0.7111) Feature CE: tensor(1.4814) KL: tensor(0.6157)
The last decorrelation: tensor(0.9787)
Local adapation with distilling: 0.000964 alphas: 1 1 2.8 1
MCE_DeC_KL Total: tensor(5.8952) local CE: tensor(1.0721) Feature CE: tensor(1.7790) KL: tensor(0.4648)
The last decorrelation: tensor(0.9085)
Local adapation with distilling: 0.000964 alphas: 1 1 2.8 1
MCE_DeC_KL Total: tensor(5.8917) local CE: tensor(1.0290) Feature CE: tensor(1.5408) KL: tensor(0.6471)
The last decorrelation: tensor(0.9495)
Local adapation with distilling: 0.000964 alphas: 1 1 2.8 1
MCE_DeC_KL Total: tensor(5.4727) local CE: tensor(0.7088) Feature CE: tensor(1.7307) KL: tensor(0.5114)
The last decorrelation: tensor(0.8904)
Local adapation with distilling: 0.000964 alphas: 1 1 2.8 1
MCE_DeC_KL Total: tensor(5.6841) local CE: tensor(1.1215) Feature CE: tensor(1.3790) KL: tensor(0.3841)
The last decorrelation: tensor(0.9999)
Local adapation with distilling: 0.000964 alphas: 1 1 2.8 1
MCE_DeC_KL Total: tensor(5.9693) local CE: tensor(1.0411) Feature CE: tensor(1.7158) KL: tensor(0.5205)
The last decorrelation: tensor(0.9616)
Local adapation with distilling: 0.000964 alphas: 1 1 2.8 1
MCE_DeC_KL Total: tensor(6.4722) local CE: tensor(1.2537) Feature CE: tensor(1.8907) KL: tensor(0.7342)
The last decorrelation: tensor(0.9133)
Local adapation with distilling: 0.000964 alphas: 1 1 2.8 1
MCE_DeC_KL Total: tensor(6.1976) local CE: tensor(0.9490) Feature CE: tensor(2.0153) KL: tensor(0.6217)
The last decorrelation: tensor(0.9154)
Local adapation with distilling: 0.000964 alphas: 1 1 2.8 1
MCE_DeC_KL Total: tensor(6.9699) local CE: tensor(1.5820) Feature CE: tensor(1.9743) KL: tensor(0.7120)
The last decorrelation: tensor(0.9513)
Local adapation with distilling: 0.000964 alphas: 1 1 2.8 1
MCE_DeC_KL Total: tensor(6.0427) local CE: tensor(1.1536) Feature CE: tensor(1.8512) KL: tensor(0.5100)
The last decorrelation: tensor(0.8817)
Local adapation with distilling: 0.000964 alphas: 1 1 2.8 1
MCE_DeC_KL Total: tensor(6.6400) local CE: tensor(1.6257) Feature CE: tensor(1.8332) KL: tensor(0.6334)
The last decorrelation: tensor(0.8906)
Local adapation with distilling: 0.000964 alphas: 1 1 2.8 1
MCE_DeC_KL Total: tensor(5.3757) local CE: tensor(0.8384) Feature CE: tensor(1.4386) KL: tensor(0.5288)
The last decorrelation: tensor(0.9175)
Local adapation with distilling: 0.000964 alphas: 1 1 2.8 1
MCE_DeC_KL Total: tensor(5.6334) local CE: tensor(0.8034) Feature CE: tensor(1.5311) KL: tensor(0.5980)
The last decorrelation: tensor(0.9664)
Global Model Acc on global data: 0.20732948761452324 length of data: 2947
save a model
size of the global feature buffer: 15
-------------Round number:  3  -------------
selected users: [47, 3, 31, 25, 15, 118, 89, 6, 103, 65, 88, 38, 92, 53, 140]
Current data/feature buff: torch.Size([56, 128, 20, 7]) torch.Size([56]) 56
Buffer classes: Counter({3: 16, 1: 15, 2: 11, 5: 7, 4: 4, 0: 3})
Local adapation with distilling: 0.000946 alphas: 1 1 2.7 1
MCE_DeC_KL Total: tensor(5.9400) local CE: tensor(0.9020) Feature CE: tensor(1.6534) KL: tensor(0.7174)
The last decorrelation: tensor(0.9884)
Local adapation with distilling: 0.000946 alphas: 1 1 2.7 1
MCE_DeC_KL Total: tensor(6.0697) local CE: tensor(0.5562) Feature CE: tensor(1.7808) KL: tensor(1.0745)
The last decorrelation: tensor(0.9849)
Local adapation with distilling: 0.000946 alphas: 1 1 2.7 1
MCE_DeC_KL Total: tensor(5.7230) local CE: tensor(0.8006) Feature CE: tensor(1.9269) KL: tensor(0.5843)
The last decorrelation: tensor(0.8832)
Local adapation with distilling: 0.000946 alphas: 1 1 2.7 1
MCE_DeC_KL Total: tensor(5.8142) local CE: tensor(1.0633) Feature CE: tensor(1.5293) KL: tensor(0.5222)
The last decorrelation: tensor(0.9998)
Local adapation with distilling: 0.000946 alphas: 1 1 2.7 1
MCE_DeC_KL Total: tensor(5.4572) local CE: tensor(0.7019) Feature CE: tensor(1.4918) KL: tensor(0.7899)
The last decorrelation: tensor(0.8969)
Local adapation with distilling: 0.000946 alphas: 1 1 2.7 1
MCE_DeC_KL Total: tensor(5.3179) local CE: tensor(0.5443) Feature CE: tensor(1.4292) KL: tensor(0.7502)
The last decorrelation: tensor(0.9843)
Local adapation with distilling: 0.000946 alphas: 1 1 2.7 1
MCE_DeC_KL Total: tensor(5.9101) local CE: tensor(1.1489) Feature CE: tensor(1.6193) KL: tensor(0.5889)
The last decorrelation: tensor(0.9457)
Local adapation with distilling: 0.000946 alphas: 1 1 2.7 1
MCE_DeC_KL Total: tensor(5.7186) local CE: tensor(0.7932) Feature CE: tensor(1.6340) KL: tensor(0.7628)
The last decorrelation: tensor(0.9318)
Local adapation with distilling: 0.000946 alphas: 1 1 2.7 1
MCE_DeC_KL Total: tensor(5.3844) local CE: tensor(0.8588) Feature CE: tensor(1.6507) KL: tensor(0.6104)
The last decorrelation: tensor(0.8235)
Local adapation with distilling: 0.000946 alphas: 1 1 2.7 1
MCE_DeC_KL Total: tensor(5.7802) local CE: tensor(0.9680) Feature CE: tensor(1.6922) KL: tensor(0.5932)
The last decorrelation: tensor(0.9342)
Local adapation with distilling: 0.000946 alphas: 1 1 2.7 1
MCE_DeC_KL Total: tensor(6.9070) local CE: tensor(1.1578) Feature CE: tensor(2.1048) KL: tensor(1.0084)
The last decorrelation: tensor(0.9768)
Local adapation with distilling: 0.000946 alphas: 1 1 2.7 1
MCE_DeC_KL Total: tensor(6.3130) local CE: tensor(1.2008) Feature CE: tensor(1.9804) KL: tensor(0.7510)
The last decorrelation: tensor(0.8587)
Local adapation with distilling: 0.000946 alphas: 1 1 2.7 1
MCE_DeC_KL Total: tensor(5.6319) local CE: tensor(0.8808) Feature CE: tensor(1.6608) KL: tensor(0.7385)
The last decorrelation: tensor(0.8544)
Local adapation with distilling: 0.000946 alphas: 1 1 2.7 1
MCE_DeC_KL Total: tensor(6.1383) local CE: tensor(1.3264) Feature CE: tensor(1.7008) KL: tensor(0.5411)
The last decorrelation: tensor(0.9485)
Local adapation with distilling: 0.000946 alphas: 1 1 2.7 1
MCE_DeC_KL Total: tensor(5.7481) local CE: tensor(0.9668) Feature CE: tensor(1.5458) KL: tensor(0.6206)
The last decorrelation: tensor(0.9680)
Global Model Acc on global data: 0.26874787919918564 length of data: 2947
save a model
size of the global feature buffer: 15
-------------Round number:  4  -------------
selected users: [128, 18, 130, 105, 107, 78, 83, 14, 5, 133, 25, 11, 12, 63, 113]
Current data/feature buff: torch.Size([88, 128, 20, 7]) torch.Size([88]) 88
Buffer classes: Counter({2: 23, 3: 22, 5: 20, 0: 18, 4: 5})
Local adapation with distilling: 0.0009280000000000001 alphas: 1 1 2.6 1
MCE_DeC_KL Total: tensor(5.8969) local CE: tensor(1.0191) Feature CE: tensor(1.7781) KL: tensor(0.7612)
The last decorrelation: tensor(0.8945)
Local adapation with distilling: 0.0009280000000000001 alphas: 1 1 2.6 1
MCE_DeC_KL Total: tensor(5.3149) local CE: tensor(0.7632) Feature CE: tensor(1.5646) KL: tensor(0.5295)
The last decorrelation: tensor(0.9484)
Local adapation with distilling: 0.0009280000000000001 alphas: 1 1 2.6 1
MCE_DeC_KL Total: tensor(5.7793) local CE: tensor(0.8003) Feature CE: tensor(1.5800) KL: tensor(0.8685)
The last decorrelation: tensor(0.9739)
Local adapation with distilling: 0.0009280000000000001 alphas: 1 1 2.6 1
MCE_DeC_KL Total: tensor(5.0108) local CE: tensor(0.5177) Feature CE: tensor(1.3874) KL: tensor(0.5420)
The last decorrelation: tensor(0.9862)
Local adapation with distilling: 0.0009280000000000001 alphas: 1 1 2.6 1
MCE_DeC_KL Total: tensor(5.4659) local CE: tensor(0.9511) Feature CE: tensor(1.5884) KL: tensor(0.6858)
The last decorrelation: tensor(0.8599)
Local adapation with distilling: 0.0009280000000000001 alphas: 1 1 2.6 1
MCE_DeC_KL Total: tensor(5.4661) local CE: tensor(0.7576) Feature CE: tensor(1.5834) KL: tensor(0.5256)
The last decorrelation: tensor(0.9998)
Local adapation with distilling: 0.0009280000000000001 alphas: 1 1 2.6 1
MCE_DeC_KL Total: tensor(5.9891) local CE: tensor(1.3014) Feature CE: tensor(1.7997) KL: tensor(0.6629)
The last decorrelation: tensor(0.8445)
Local adapation with distilling: 0.0009280000000000001 alphas: 1 1 2.6 1
MCE_DeC_KL Total: tensor(6.1281) local CE: tensor(1.4718) Feature CE: tensor(1.6314) KL: tensor(0.6571)
The last decorrelation: tensor(0.9019)
Local adapation with distilling: 0.0009280000000000001 alphas: 1 1 2.6 1
MCE_DeC_KL Total: tensor(5.4134) local CE: tensor(1.0418) Feature CE: tensor(1.5466) KL: tensor(0.4523)
The last decorrelation: tensor(0.9119)
Local adapation with distilling: 0.0009280000000000001 alphas: 1 1 2.6 1
MCE_DeC_KL Total: tensor(5.3528) local CE: tensor(0.9412) Feature CE: tensor(1.4607) KL: tensor(0.4263)
The last decorrelation: tensor(0.9708)
Local adapation with distilling: 0.0009280000000000001 alphas: 1 1 2.6 1
MCE_DeC_KL Total: tensor(5.4745) local CE: tensor(0.9882) Feature CE: tensor(1.5105) KL: tensor(0.3763)
The last decorrelation: tensor(0.9998)
Local adapation with distilling: 0.0009280000000000001 alphas: 1 1 2.6 1
MCE_DeC_KL Total: tensor(5.6680) local CE: tensor(1.0064) Feature CE: tensor(1.6252) KL: tensor(0.5896)
The last decorrelation: tensor(0.9415)
Local adapation with distilling: 0.0009280000000000001 alphas: 1 1 2.6 1
MCE_DeC_KL Total: tensor(5.6745) local CE: tensor(1.0675) Feature CE: tensor(1.7798) KL: tensor(0.5006)
The last decorrelation: tensor(0.8885)
Local adapation with distilling: 0.0009280000000000001 alphas: 1 1 2.6 1
MCE_DeC_KL Total: tensor(5.8107) local CE: tensor(0.8399) Feature CE: tensor(1.7055) KL: tensor(0.9048)
The last decorrelation: tensor(0.9036)
Local adapation with distilling: 0.0009280000000000001 alphas: 1 1 2.6 1
MCE_DeC_KL Total: tensor(5.1002) local CE: tensor(0.5575) Feature CE: tensor(1.4056) KL: tensor(0.6124)
The last decorrelation: tensor(0.9694)
Global Model Acc on global data: 0.22293858160841534 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  5  -------------
selected users: [82, 134, 114, 42, 109, 57, 1, 70, 25, 84, 66, 133, 102, 107, 26]
Current data/feature buff: torch.Size([55, 128, 20, 7]) torch.Size([55]) 55
Buffer classes: Counter({4: 16, 1: 15, 3: 13, 0: 4, 5: 4, 2: 3})
Local adapation with distilling: 0.00091 alphas: 1 1 2.5 1
MCE_DeC_KL Total: tensor(5.5865) local CE: tensor(0.9952) Feature CE: tensor(1.6812) KL: tensor(0.5610)
The last decorrelation: tensor(0.9476)
Local adapation with distilling: 0.00091 alphas: 1 1 2.5 1
MCE_DeC_KL Total: tensor(5.4155) local CE: tensor(1.1722) Feature CE: tensor(1.4103) KL: tensor(0.5679)
The last decorrelation: tensor(0.9041)
Local adapation with distilling: 0.00091 alphas: 1 1 2.5 1
MCE_DeC_KL Total: tensor(6.1115) local CE: tensor(0.6762) Feature CE: tensor(1.9258) KL: tensor(1.1027)
The last decorrelation: tensor(0.9722)
Local adapation with distilling: 0.00091 alphas: 1 1 2.5 1
MCE_DeC_KL Total: tensor(5.0996) local CE: tensor(0.8598) Feature CE: tensor(1.6295) KL: tensor(0.5021)
The last decorrelation: tensor(0.8424)
Local adapation with distilling: 0.00091 alphas: 1 1 2.5 1
MCE_DeC_KL Total: tensor(4.8511) local CE: tensor(0.7110) Feature CE: tensor(1.5007) KL: tensor(0.4629)
The last decorrelation: tensor(0.8642)
Local adapation with distilling: 0.00091 alphas: 1 1 2.5 1
MCE_DeC_KL Total: tensor(5.0939) local CE: tensor(0.4970) Feature CE: tensor(1.7399) KL: tensor(0.6471)
The last decorrelation: tensor(0.8742)
Local adapation with distilling: 0.00091 alphas: 1 1 2.5 1
MCE_DeC_KL Total: tensor(5.1303) local CE: tensor(0.8403) Feature CE: tensor(1.2747) KL: tensor(0.5446)
The last decorrelation: tensor(0.9883)
Local adapation with distilling: 0.00091 alphas: 1 1 2.5 1
MCE_DeC_KL Total: tensor(5.1232) local CE: tensor(0.6117) Feature CE: tensor(1.4923) KL: tensor(0.6057)
The last decorrelation: tensor(0.9699)
Local adapation with distilling: 0.00091 alphas: 1 1 2.5 1
MCE_DeC_KL Total: tensor(5.4441) local CE: tensor(0.8956) Feature CE: tensor(1.6034) KL: tensor(0.4456)
The last decorrelation: tensor(0.9998)
Local adapation with distilling: 0.00091 alphas: 1 1 2.5 1
MCE_DeC_KL Total: tensor(5.7832) local CE: tensor(1.4177) Feature CE: tensor(1.6597) KL: tensor(0.4675)
The last decorrelation: tensor(0.8928)
Local adapation with distilling: 0.00091 alphas: 1 1 2.5 1
MCE_DeC_KL Total: tensor(5.4355) local CE: tensor(0.9034) Feature CE: tensor(1.7006) KL: tensor(0.6927)
The last decorrelation: tensor(0.8462)
Local adapation with distilling: 0.00091 alphas: 1 1 2.5 1
MCE_DeC_KL Total: tensor(5.3234) local CE: tensor(0.9407) Feature CE: tensor(1.4659) KL: tensor(0.4891)
The last decorrelation: tensor(0.9713)
Local adapation with distilling: 0.00091 alphas: 1 1 2.5 1
MCE_DeC_KL Total: tensor(4.7413) local CE: tensor(0.4160) Feature CE: tensor(1.4369) KL: tensor(0.4882)
The last decorrelation: tensor(0.9594)
Local adapation with distilling: 0.00091 alphas: 1 1 2.5 1
MCE_DeC_KL Total: tensor(5.0673) local CE: tensor(0.6963) Feature CE: tensor(1.6615) KL: tensor(0.5586)
The last decorrelation: tensor(0.8557)
Local adapation with distilling: 0.00091 alphas: 1 1 2.5 1
MCE_DeC_KL Total: tensor(5.4175) local CE: tensor(1.1007) Feature CE: tensor(1.8058) KL: tensor(0.5008)
The last decorrelation: tensor(0.7988)
Global Model Acc on global data: 0.32405836443841196 length of data: 2947
save a model
size of the global feature buffer: 15
-------------Round number:  6  -------------
selected users: [4, 116, 2, 23, 123, 96, 134, 39, 137, 53, 127, 81, 115, 135, 74]
Current data/feature buff: torch.Size([54, 128, 20, 7]) torch.Size([54]) 54
Buffer classes: Counter({3: 21, 1: 17, 2: 8, 0: 5, 5: 3})
Local adapation with distilling: 0.000892 alphas: 1 1 2.4 1
MCE_DeC_KL Total: tensor(5.2108) local CE: tensor(1.1136) Feature CE: tensor(1.4880) KL: tensor(0.4741)
The last decorrelation: tensor(0.8918)
Local adapation with distilling: 0.000892 alphas: 1 1 2.4 1
MCE_DeC_KL Total: tensor(4.6904) local CE: tensor(0.5147) Feature CE: tensor(1.3469) KL: tensor(0.6204)
The last decorrelation: tensor(0.9147)
Local adapation with distilling: 0.000892 alphas: 1 1 2.4 1
MCE_DeC_KL Total: tensor(4.9683) local CE: tensor(0.8831) Feature CE: tensor(1.3899) KL: tensor(0.5369)
The last decorrelation: tensor(0.8960)
Local adapation with distilling: 0.000892 alphas: 1 1 2.4 1
MCE_DeC_KL Total: tensor(6.5190) local CE: tensor(0.6271) Feature CE: tensor(1.6308) KL: tensor(1.8639)
The last decorrelation: tensor(0.9989)
Local adapation with distilling: 0.000892 alphas: 1 1 2.4 1
MCE_DeC_KL Total: tensor(5.2676) local CE: tensor(1.1667) Feature CE: tensor(1.5608) KL: tensor(0.4735)
The last decorrelation: tensor(0.8571)
Local adapation with distilling: 0.000892 alphas: 1 1 2.4 1
MCE_DeC_KL Total: tensor(5.3209) local CE: tensor(1.1631) Feature CE: tensor(1.5669) KL: tensor(0.4754)
The last decorrelation: tensor(0.8834)
Local adapation with distilling: 0.000892 alphas: 1 1 2.4 1
MCE_DeC_KL Total: tensor(5.6418) local CE: tensor(1.0564) Feature CE: tensor(1.6873) KL: tensor(0.7236)
The last decorrelation: tensor(0.9045)
Local adapation with distilling: 0.000892 alphas: 1 1 2.4 1
MCE_DeC_KL Total: tensor(5.6788) local CE: tensor(1.0392) Feature CE: tensor(1.8244) KL: tensor(0.5029)
The last decorrelation: tensor(0.9633)
Local adapation with distilling: 0.000892 alphas: 1 1 2.4 1
MCE_DeC_KL Total: tensor(6.0747) local CE: tensor(0.9749) Feature CE: tensor(1.7937) KL: tensor(1.0375)
The last decorrelation: tensor(0.9466)
Local adapation with distilling: 0.000892 alphas: 1 1 2.4 1
MCE_DeC_KL Total: tensor(5.7983) local CE: tensor(1.3600) Feature CE: tensor(1.6673) KL: tensor(0.4315)
The last decorrelation: tensor(0.9849)
Local adapation with distilling: 0.000892 alphas: 1 1 2.4 1
MCE_DeC_KL Total: tensor(5.2255) local CE: tensor(0.8590) Feature CE: tensor(1.4226) KL: tensor(0.6370)
The last decorrelation: tensor(0.9629)
Local adapation with distilling: 0.000892 alphas: 1 1 2.4 1
MCE_DeC_KL Total: tensor(5.6150) local CE: tensor(1.2608) Feature CE: tensor(1.6237) KL: tensor(0.6353)
The last decorrelation: tensor(0.8769)
Local adapation with distilling: 0.000892 alphas: 1 1 2.4 1
MCE_DeC_KL Total: tensor(5.2576) local CE: tensor(0.7941) Feature CE: tensor(1.5610) KL: tensor(0.6436)
The last decorrelation: tensor(0.9442)
Local adapation with distilling: 0.000892 alphas: 1 1 2.4 1
MCE_DeC_KL Total: tensor(5.4206) local CE: tensor(1.1116) Feature CE: tensor(1.5664) KL: tensor(0.5181)
The last decorrelation: tensor(0.9203)
Local adapation with distilling: 0.000892 alphas: 1 1 2.4 1
MCE_DeC_KL Total: tensor(4.9017) local CE: tensor(0.9450) Feature CE: tensor(1.3774) KL: tensor(0.5090)
The last decorrelation: tensor(0.8575)
Global Model Acc on global data: 0.32609433322022396 length of data: 2947
save a model
size of the global feature buffer: 15
-------------Round number:  7  -------------
selected users: [149, 84, 40, 66, 106, 41, 52, 94, 11, 51, 77, 85, 32, 109, 28]
Current data/feature buff: torch.Size([54, 128, 20, 7]) torch.Size([54]) 54
Buffer classes: Counter({1: 17, 4: 14, 2: 10, 3: 7, 5: 3, 0: 3})
Local adapation with distilling: 0.000874 alphas: 1 1 2.3 1
MCE_DeC_KL Total: tensor(5.1893) local CE: tensor(1.0362) Feature CE: tensor(1.6383) KL: tensor(0.4658)
The last decorrelation: tensor(0.8913)
Local adapation with distilling: 0.000874 alphas: 1 1 2.3 1
MCE_DeC_KL Total: tensor(4.9334) local CE: tensor(0.9707) Feature CE: tensor(1.4821) KL: tensor(0.4299)
The last decorrelation: tensor(0.8916)
Local adapation with distilling: 0.000874 alphas: 1 1 2.3 1
MCE_DeC_KL Total: tensor(5.3853) local CE: tensor(1.0594) Feature CE: tensor(1.6851) KL: tensor(0.5226)
The last decorrelation: tensor(0.9195)
Local adapation with distilling: 0.000874 alphas: 1 1 2.3 1
MCE_DeC_KL Total: tensor(4.9869) local CE: tensor(0.8985) Feature CE: tensor(1.5323) KL: tensor(0.6125)
The last decorrelation: tensor(0.8477)
Local adapation with distilling: 0.000874 alphas: 1 1 2.3 1
MCE_DeC_KL Total: tensor(5.3519) local CE: tensor(0.9731) Feature CE: tensor(1.8004) KL: tensor(0.4013)
The last decorrelation: tensor(0.9435)
Local adapation with distilling: 0.000874 alphas: 1 1 2.3 1
MCE_DeC_KL Total: tensor(4.7086) local CE: tensor(0.8006) Feature CE: tensor(1.5846) KL: tensor(0.3495)
The last decorrelation: tensor(0.8536)
Local adapation with distilling: 0.000874 alphas: 1 1 2.3 1
MCE_DeC_KL Total: tensor(4.0144) local CE: tensor(0.2739) Feature CE: tensor(1.3559) KL: tensor(0.3956)
The last decorrelation: tensor(0.8653)
Local adapation with distilling: 0.000874 alphas: 1 1 2.3 1
MCE_DeC_KL Total: tensor(5.0213) local CE: tensor(0.8835) Feature CE: tensor(1.6318) KL: tensor(0.3634)
The last decorrelation: tensor(0.9362)
Local adapation with distilling: 0.000874 alphas: 1 1 2.3 1
MCE_DeC_KL Total: tensor(5.3674) local CE: tensor(1.0807) Feature CE: tensor(1.6516) KL: tensor(0.4688)
The last decorrelation: tensor(0.9434)
Local adapation with distilling: 0.000874 alphas: 1 1 2.3 1
MCE_DeC_KL Total: tensor(4.9087) local CE: tensor(0.7753) Feature CE: tensor(1.5440) KL: tensor(0.5366)
The last decorrelation: tensor(0.8898)
Local adapation with distilling: 0.000874 alphas: 1 1 2.3 1
MCE_DeC_KL Total: tensor(4.8632) local CE: tensor(0.6428) Feature CE: tensor(1.5114) KL: tensor(0.5999)
The last decorrelation: tensor(0.9173)
Local adapation with distilling: 0.000874 alphas: 1 1 2.3 1
MCE_DeC_KL Total: tensor(5.2732) local CE: tensor(1.0445) Feature CE: tensor(1.5483) KL: tensor(0.4965)
The last decorrelation: tensor(0.9498)
Local adapation with distilling: 0.000874 alphas: 1 1 2.3 1
MCE_DeC_KL Total: tensor(4.4121) local CE: tensor(0.5947) Feature CE: tensor(1.2392) KL: tensor(0.4364)
The last decorrelation: tensor(0.9423)
Local adapation with distilling: 0.000874 alphas: 1 1 2.3 1
MCE_DeC_KL Total: tensor(3.9750) local CE: tensor(0.2148) Feature CE: tensor(1.3625) KL: tensor(0.4078)
The last decorrelation: tensor(0.8567)
Local adapation with distilling: 0.000874 alphas: 1 1 2.3 1
MCE_DeC_KL Total: tensor(5.1642) local CE: tensor(0.9550) Feature CE: tensor(1.6909) KL: tensor(0.3484)
The last decorrelation: tensor(0.9423)
Global Model Acc on global data: 0.32507634882931796 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  8  -------------
selected users: [4, 29, 27, 141, 65, 34, 23, 145, 132, 74, 56, 30, 106, 50, 119]
Current data/feature buff: torch.Size([82, 128, 20, 7]) torch.Size([82]) 82
Buffer classes: Counter({1: 31, 0: 22, 4: 18, 3: 5, 2: 3, 5: 3})
Local adapation with distilling: 0.000856 alphas: 1 1 2.2 1
MCE_DeC_KL Total: tensor(4.6321) local CE: tensor(0.9177) Feature CE: tensor(1.3208) KL: tensor(0.4875)
The last decorrelation: tensor(0.8546)
Local adapation with distilling: 0.000856 alphas: 1 1 2.2 1
MCE_DeC_KL Total: tensor(4.2351) local CE: tensor(0.4413) Feature CE: tensor(1.2629) KL: tensor(0.5509)
The last decorrelation: tensor(0.8984)
Local adapation with distilling: 0.000856 alphas: 1 1 2.2 1
MCE_DeC_KL Total: tensor(5.0700) local CE: tensor(1.1037) Feature CE: tensor(1.6047) KL: tensor(0.5622)
The last decorrelation: tensor(0.8131)
Local adapation with distilling: 0.000856 alphas: 1 1 2.2 1
MCE_DeC_KL Total: tensor(5.1008) local CE: tensor(0.9565) Feature CE: tensor(1.6833) KL: tensor(0.5028)
The last decorrelation: tensor(0.8901)
Local adapation with distilling: 0.000856 alphas: 1 1 2.2 1
MCE_DeC_KL Total: tensor(5.0022) local CE: tensor(0.8633) Feature CE: tensor(1.6019) KL: tensor(0.4893)
The last decorrelation: tensor(0.9283)
Local adapation with distilling: 0.000856 alphas: 1 1 2.2 1
MCE_DeC_KL Total: tensor(4.9454) local CE: tensor(0.6759) Feature CE: tensor(1.6825) KL: tensor(0.3991)
The last decorrelation: tensor(0.9940)
Local adapation with distilling: 0.000856 alphas: 1 1 2.2 1
MCE_DeC_KL Total: tensor(5.7752) local CE: tensor(0.9550) Feature CE: tensor(1.9189) KL: tensor(0.7038)
The last decorrelation: tensor(0.9989)
Local adapation with distilling: 0.000856 alphas: 1 1 2.2 1
MCE_DeC_KL Total: tensor(5.1585) local CE: tensor(0.9930) Feature CE: tensor(1.4374) KL: tensor(0.8060)
The last decorrelation: tensor(0.8714)
Local adapation with distilling: 0.000856 alphas: 1 1 2.2 1
MCE_DeC_KL Total: tensor(4.5015) local CE: tensor(0.5197) Feature CE: tensor(1.2576) KL: tensor(0.5317)
The last decorrelation: tensor(0.9966)
Local adapation with distilling: 0.000856 alphas: 1 1 2.2 1
MCE_DeC_KL Total: tensor(5.1568) local CE: tensor(1.0261) Feature CE: tensor(1.7136) KL: tensor(0.5419)
The last decorrelation: tensor(0.8564)
Local adapation with distilling: 0.000856 alphas: 1 1 2.2 1
MCE_DeC_KL Total: tensor(5.2120) local CE: tensor(0.9622) Feature CE: tensor(1.5530) KL: tensor(0.6967)
The last decorrelation: tensor(0.9096)
Local adapation with distilling: 0.000856 alphas: 1 1 2.2 1
MCE_DeC_KL Total: tensor(4.6364) local CE: tensor(0.9184) Feature CE: tensor(1.4047) KL: tensor(0.4208)
The last decorrelation: tensor(0.8556)
Local adapation with distilling: 0.000856 alphas: 1 1 2.2 1
MCE_DeC_KL Total: tensor(5.9845) local CE: tensor(1.0252) Feature CE: tensor(1.9552) KL: tensor(0.9126)
The last decorrelation: tensor(0.9533)
Local adapation with distilling: 0.000856 alphas: 1 1 2.2 1
MCE_DeC_KL Total: tensor(4.5013) local CE: tensor(0.4433) Feature CE: tensor(1.2535) KL: tensor(0.7102)
The last decorrelation: tensor(0.9512)
Local adapation with distilling: 0.000856 alphas: 1 1 2.2 1
MCE_DeC_KL Total: tensor(4.1642) local CE: tensor(0.2354) Feature CE: tensor(1.2470) KL: tensor(0.5807)
The last decorrelation: tensor(0.9480)
Global Model Acc on global data: 0.40380047505938244 length of data: 2947
save a model
size of the global feature buffer: 15
-------------Round number:  9  -------------
selected users: [135, 90, 145, 147, 60, 37, 26, 3, 75, 9, 25, 73, 98, 94, 39]
Current data/feature buff: torch.Size([92, 128, 20, 7]) torch.Size([92]) 92
Buffer classes: Counter({4: 47, 2: 14, 5: 14, 1: 9, 0: 7, 3: 1})
Local adapation with distilling: 0.0008380000000000001 alphas: 1 1 2.1 1
MCE_DeC_KL Total: tensor(4.9050) local CE: tensor(0.8566) Feature CE: tensor(1.7267) KL: tensor(0.3911)
The last decorrelation: tensor(0.9109)
Local adapation with distilling: 0.0008380000000000001 alphas: 1 1 2.1 1
MCE_DeC_KL Total: tensor(5.1492) local CE: tensor(0.7920) Feature CE: tensor(1.6084) KL: tensor(0.7415)
The last decorrelation: tensor(0.9568)
Local adapation with distilling: 0.0008380000000000001 alphas: 1 1 2.1 1
MCE_DeC_KL Total: tensor(3.7967) local CE: tensor(0.4192) Feature CE: tensor(1.2217) KL: tensor(0.3443)
The last decorrelation: tensor(0.8593)
Local adapation with distilling: 0.0008380000000000001 alphas: 1 1 2.1 1
MCE_DeC_KL Total: tensor(4.3903) local CE: tensor(0.6169) Feature CE: tensor(1.4677) KL: tensor(0.2912)
The last decorrelation: tensor(0.9582)
Local adapation with distilling: 0.0008380000000000001 alphas: 1 1 2.1 1
MCE_DeC_KL Total: tensor(4.4267) local CE: tensor(0.6689) Feature CE: tensor(1.3353) KL: tensor(0.4120)
The last decorrelation: tensor(0.9604)
Local adapation with distilling: 0.0008380000000000001 alphas: 1 1 2.1 1
MCE_DeC_KL Total: tensor(3.8496) local CE: tensor(0.2599) Feature CE: tensor(1.4297) KL: tensor(0.2928)
The last decorrelation: tensor(0.8759)
Local adapation with distilling: 0.0008380000000000001 alphas: 1 1 2.1 1
MCE_DeC_KL Total: tensor(4.7366) local CE: tensor(1.1258) Feature CE: tensor(1.5425) KL: tensor(0.3545)
The last decorrelation: tensor(0.8134)
Local adapation with distilling: 0.0008380000000000001 alphas: 1 1 2.1 1
MCE_DeC_KL Total: tensor(5.5481) local CE: tensor(0.8020) Feature CE: tensor(1.4279) KL: tensor(1.2535)
The last decorrelation: tensor(0.9832)
Local adapation with distilling: 0.0008380000000000001 alphas: 1 1 2.1 1
MCE_DeC_KL Total: tensor(5.5074) local CE: tensor(0.7891) Feature CE: tensor(1.7791) KL: tensor(0.9053)
The last decorrelation: tensor(0.9678)
Local adapation with distilling: 0.0008380000000000001 alphas: 1 1 2.1 1
MCE_DeC_KL Total: tensor(4.8393) local CE: tensor(0.7494) Feature CE: tensor(1.6764) KL: tensor(0.5473)
The last decorrelation: tensor(0.8853)
Local adapation with distilling: 0.0008380000000000001 alphas: 1 1 2.1 1
MCE_DeC_KL Total: tensor(5.1846) local CE: tensor(1.1590) Feature CE: tensor(1.6217) KL: tensor(0.3043)
The last decorrelation: tensor(0.9997)
Local adapation with distilling: 0.0008380000000000001 alphas: 1 1 2.1 1
MCE_DeC_KL Total: tensor(4.5800) local CE: tensor(0.9710) Feature CE: tensor(1.4509) KL: tensor(0.3784)
The last decorrelation: tensor(0.8305)
Local adapation with distilling: 0.0008380000000000001 alphas: 1 1 2.1 1
MCE_DeC_KL Total: tensor(4.0675) local CE: tensor(0.5947) Feature CE: tensor(1.3899) KL: tensor(0.2454)
The last decorrelation: tensor(0.8837)
Local adapation with distilling: 0.0008380000000000001 alphas: 1 1 2.1 1
MCE_DeC_KL Total: tensor(6.0732) local CE: tensor(0.9303) Feature CE: tensor(1.8053) KL: tensor(1.3713)
The last decorrelation: tensor(0.9361)
Local adapation with distilling: 0.0008380000000000001 alphas: 1 1 2.1 1
MCE_DeC_KL Total: tensor(5.0452) local CE: tensor(0.5181) Feature CE: tensor(1.6305) KL: tensor(0.8675)
The last decorrelation: tensor(0.9674)
Global Model Acc on global data: 0.4428232100441127 length of data: 2947
save a model
size of the global feature buffer: 15
-------------Round number:  10  -------------
selected users: [87, 111, 10, 91, 49, 60, 72, 67, 39, 55, 66, 142, 53, 1, 19]
Current data/feature buff: torch.Size([41, 128, 20, 7]) torch.Size([41]) 41
Buffer classes: Counter({0: 10, 5: 10, 2: 9, 3: 7, 1: 3, 4: 2})
Local adapation with distilling: 0.0008200000000000001 alphas: 1 1 2.0 1
MCE_DeC_KL Total: tensor(4.6718) local CE: tensor(0.8110) Feature CE: tensor(1.3533) KL: tensor(0.5700)
The last decorrelation: tensor(0.9797)
Local adapation with distilling: 0.0008200000000000001 alphas: 1 1 2.0 1
MCE_DeC_KL Total: tensor(5.1092) local CE: tensor(1.0352) Feature CE: tensor(1.5965) KL: tensor(0.4895)
The last decorrelation: tensor(0.9940)
Local adapation with distilling: 0.0008200000000000001 alphas: 1 1 2.0 1
MCE_DeC_KL Total: tensor(4.9682) local CE: tensor(0.8880) Feature CE: tensor(1.4478) KL: tensor(0.6666)
The last decorrelation: tensor(0.9812)
Local adapation with distilling: 0.0008200000000000001 alphas: 1 1 2.0 1
MCE_DeC_KL Total: tensor(4.7305) local CE: tensor(0.8600) Feature CE: tensor(1.4424) KL: tensor(0.5249)
The last decorrelation: tensor(0.9513)
Local adapation with distilling: 0.0008200000000000001 alphas: 1 1 2.0 1
MCE_DeC_KL Total: tensor(4.5111) local CE: tensor(0.6225) Feature CE: tensor(1.4888) KL: tensor(0.4777)
The last decorrelation: tensor(0.9596)
Local adapation with distilling: 0.0008200000000000001 alphas: 1 1 2.0 1
MCE_DeC_KL Total: tensor(4.1658) local CE: tensor(0.4185) Feature CE: tensor(1.3296) KL: tensor(0.5383)
The last decorrelation: tensor(0.9409)
Local adapation with distilling: 0.0008200000000000001 alphas: 1 1 2.0 1
MCE_DeC_KL Total: tensor(4.5785) local CE: tensor(0.7342) Feature CE: tensor(1.5625) KL: tensor(0.4618)
The last decorrelation: tensor(0.9082)
Local adapation with distilling: 0.0008200000000000001 alphas: 1 1 2.0 1
MCE_DeC_KL Total: tensor(4.9146) local CE: tensor(0.9431) Feature CE: tensor(1.7711) KL: tensor(0.4642)
The last decorrelation: tensor(0.8676)
Local adapation with distilling: 0.0008200000000000001 alphas: 1 1 2.0 1
MCE_DeC_KL Total: tensor(4.0630) local CE: tensor(0.4667) Feature CE: tensor(1.3726) KL: tensor(0.2935)
The last decorrelation: tensor(0.9668)
Local adapation with distilling: 0.0008200000000000001 alphas: 1 1 2.0 1
MCE_DeC_KL Total: tensor(4.9192) local CE: tensor(0.8936) Feature CE: tensor(1.4982) KL: tensor(0.6809)
The last decorrelation: tensor(0.9521)
Local adapation with distilling: 0.0008200000000000001 alphas: 1 1 2.0 1
MCE_DeC_KL Total: tensor(4.4762) local CE: tensor(0.8423) Feature CE: tensor(1.3672) KL: tensor(0.5747)
The last decorrelation: tensor(0.8524)
Local adapation with distilling: 0.0008200000000000001 alphas: 1 1 2.0 1
MCE_DeC_KL Total: tensor(3.8558) local CE: tensor(0.3219) Feature CE: tensor(1.4753) KL: tensor(0.3428)
The last decorrelation: tensor(0.8493)
Local adapation with distilling: 0.0008200000000000001 alphas: 1 1 2.0 1
MCE_DeC_KL Total: tensor(5.3797) local CE: tensor(1.2601) Feature CE: tensor(1.7203) KL: tensor(0.5029)
The last decorrelation: tensor(0.9419)
Local adapation with distilling: 0.0008200000000000001 alphas: 1 1 2.0 1
MCE_DeC_KL Total: tensor(4.1374) local CE: tensor(0.6160) Feature CE: tensor(1.3431) KL: tensor(0.2011)
The last decorrelation: tensor(0.9886)
Local adapation with distilling: 0.0008200000000000001 alphas: 1 1 2.0 1
MCE_DeC_KL Total: tensor(4.3074) local CE: tensor(0.4424) Feature CE: tensor(1.4329) KL: tensor(0.5584)
The last decorrelation: tensor(0.9271)
Global Model Acc on global data: 0.4316253817441466 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  11  -------------
selected users: [112, 145, 133, 56, 111, 9, 65, 15, 30, 63, 119, 62, 84, 113, 139]
Current data/feature buff: torch.Size([66, 128, 20, 7]) torch.Size([66]) 66
Buffer classes: Counter({5: 25, 3: 24, 0: 11, 1: 3, 2: 2, 4: 1})
Local adapation with distilling: 0.0008020000000000001 alphas: 1 1 1.9 1
MCE_DeC_KL Total: tensor(4.8034) local CE: tensor(0.6446) Feature CE: tensor(1.6008) KL: tensor(0.7965)
The last decorrelation: tensor(0.9271)
Local adapation with distilling: 0.0008020000000000001 alphas: 1 1 1.9 1
MCE_DeC_KL Total: tensor(4.2483) local CE: tensor(0.5325) Feature CE: tensor(1.6333) KL: tensor(0.4220)
The last decorrelation: tensor(0.8821)
Local adapation with distilling: 0.0008020000000000001 alphas: 1 1 1.9 1
MCE_DeC_KL Total: tensor(4.2948) local CE: tensor(0.8129) Feature CE: tensor(1.0740) KL: tensor(0.5640)
The last decorrelation: tensor(0.9706)
Local adapation with distilling: 0.0008020000000000001 alphas: 1 1 1.9 1
MCE_DeC_KL Total: tensor(4.7262) local CE: tensor(0.7814) Feature CE: tensor(1.4971) KL: tensor(0.6985)
The last decorrelation: tensor(0.9064)
Local adapation with distilling: 0.0008020000000000001 alphas: 1 1 1.9 1
MCE_DeC_KL Total: tensor(3.9558) local CE: tensor(0.7766) Feature CE: tensor(0.9548) KL: tensor(0.3355)
The last decorrelation: tensor(0.9941)
Local adapation with distilling: 0.0008020000000000001 alphas: 1 1 1.9 1
MCE_DeC_KL Total: tensor(3.8536) local CE: tensor(0.4714) Feature CE: tensor(1.3893) KL: tensor(0.2951)
The last decorrelation: tensor(0.8914)
Local adapation with distilling: 0.0008020000000000001 alphas: 1 1 1.9 1
MCE_DeC_KL Total: tensor(4.1005) local CE: tensor(0.5803) Feature CE: tensor(1.3605) KL: tensor(0.3665)
The last decorrelation: tensor(0.9431)
Local adapation with distilling: 0.0008020000000000001 alphas: 1 1 1.9 1
MCE_DeC_KL Total: tensor(3.6939) local CE: tensor(0.4065) Feature CE: tensor(1.0796) KL: tensor(0.4624)
The last decorrelation: tensor(0.9200)
Local adapation with distilling: 0.0008020000000000001 alphas: 1 1 1.9 1
MCE_DeC_KL Total: tensor(5.1085) local CE: tensor(1.1572) Feature CE: tensor(1.9149) KL: tensor(0.3883)
The last decorrelation: tensor(0.8498)
Local adapation with distilling: 0.0008020000000000001 alphas: 1 1 1.9 1
MCE_DeC_KL Total: tensor(4.3561) local CE: tensor(0.3711) Feature CE: tensor(1.7046) KL: tensor(0.5676)
The last decorrelation: tensor(0.8978)
Local adapation with distilling: 0.0008020000000000001 alphas: 1 1 1.9 1
MCE_DeC_KL Total: tensor(3.8274) local CE: tensor(0.2286) Feature CE: tensor(1.3388) KL: tensor(0.4435)
The last decorrelation: tensor(0.9594)
Local adapation with distilling: 0.0008020000000000001 alphas: 1 1 1.9 1
MCE_DeC_KL Total: tensor(4.4286) local CE: tensor(0.4739) Feature CE: tensor(1.6049) KL: tensor(0.5375)
The last decorrelation: tensor(0.9499)
Local adapation with distilling: 0.0008020000000000001 alphas: 1 1 1.9 1
MCE_DeC_KL Total: tensor(5.1348) local CE: tensor(1.2918) Feature CE: tensor(1.8304) KL: tensor(0.3127)
The last decorrelation: tensor(0.8894)
Local adapation with distilling: 0.0008020000000000001 alphas: 1 1 1.9 1
MCE_DeC_KL Total: tensor(4.0882) local CE: tensor(0.5492) Feature CE: tensor(1.2648) KL: tensor(0.4410)
The last decorrelation: tensor(0.9631)
Local adapation with distilling: 0.0008020000000000001 alphas: 1 1 1.9 1
MCE_DeC_KL Total: tensor(3.6766) local CE: tensor(0.4597) Feature CE: tensor(0.8602) KL: tensor(0.5595)
The last decorrelation: tensor(0.9429)
Global Model Acc on global data: 0.3627417712928402 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  12  -------------
selected users: [40, 146, 38, 99, 143, 116, 148, 39, 135, 23, 66, 16, 31, 21, 50]
Current data/feature buff: torch.Size([104, 128, 20, 7]) torch.Size([104]) 104
Buffer classes: Counter({4: 54, 3: 20, 5: 14, 0: 7, 1: 5, 2: 4})
Local adapation with distilling: 0.0007840000000000001 alphas: 1 1 1.7999999999999998 1
MCE_DeC_KL Total: tensor(3.5851) local CE: tensor(0.3299) Feature CE: tensor(1.4877) KL: tensor(0.0983)
The last decorrelation: tensor(0.9245)
Local adapation with distilling: 0.0007840000000000001 alphas: 1 1 1.7999999999999998 1
MCE_DeC_KL Total: tensor(3.9138) local CE: tensor(0.5134) Feature CE: tensor(1.4680) KL: tensor(0.2655)
The last decorrelation: tensor(0.9229)
Local adapation with distilling: 0.0007840000000000001 alphas: 1 1 1.7999999999999998 1
MCE_DeC_KL Total: tensor(3.2901) local CE: tensor(0.2456) Feature CE: tensor(1.3798) KL: tensor(0.1356)
The last decorrelation: tensor(0.8370)
Local adapation with distilling: 0.0007840000000000001 alphas: 1 1 1.7999999999999998 1
MCE_DeC_KL Total: tensor(4.6018) local CE: tensor(1.1481) Feature CE: tensor(1.4844) KL: tensor(0.3690)
The last decorrelation: tensor(0.8884)
Local adapation with distilling: 0.0007840000000000001 alphas: 1 1 1.7999999999999998 1
MCE_DeC_KL Total: tensor(4.3585) local CE: tensor(0.7421) Feature CE: tensor(1.6455) KL: tensor(0.3837)
The last decorrelation: tensor(0.8847)
Local adapation with distilling: 0.0007840000000000001 alphas: 1 1 1.7999999999999998 1
MCE_DeC_KL Total: tensor(5.3616) local CE: tensor(1.3860) Feature CE: tensor(1.8542) KL: tensor(0.4637)
The last decorrelation: tensor(0.9157)
Local adapation with distilling: 0.0007840000000000001 alphas: 1 1 1.7999999999999998 1
MCE_DeC_KL Total: tensor(2.8048) local CE: tensor(0.1928) Feature CE: tensor(0.8605) KL: tensor(0.1473)
The last decorrelation: tensor(0.8855)
Local adapation with distilling: 0.0007840000000000001 alphas: 1 1 1.7999999999999998 1
MCE_DeC_KL Total: tensor(3.9314) local CE: tensor(0.5681) Feature CE: tensor(1.3007) KL: tensor(0.3208)
The last decorrelation: tensor(0.9686)
Local adapation with distilling: 0.0007840000000000001 alphas: 1 1 1.7999999999999998 1
MCE_DeC_KL Total: tensor(4.6867) local CE: tensor(0.7738) Feature CE: tensor(2.0295) KL: tensor(0.2154)
The last decorrelation: tensor(0.9265)
Local adapation with distilling: 0.0007840000000000001 alphas: 1 1 1.7999999999999998 1
MCE_DeC_KL Total: tensor(5.0896) local CE: tensor(0.8647) Feature CE: tensor(1.8355) KL: tensor(0.5906)
The last decorrelation: tensor(0.9994)
Local adapation with distilling: 0.0007840000000000001 alphas: 1 1 1.7999999999999998 1
MCE_DeC_KL Total: tensor(4.4043) local CE: tensor(0.7604) Feature CE: tensor(1.6291) KL: tensor(0.4826)
The last decorrelation: tensor(0.8513)
Local adapation with distilling: 0.0007840000000000001 alphas: 1 1 1.7999999999999998 1
MCE_DeC_KL Total: tensor(4.0820) local CE: tensor(0.6110) Feature CE: tensor(1.3464) KL: tensor(0.3873)
The last decorrelation: tensor(0.9638)
Local adapation with distilling: 0.0007840000000000001 alphas: 1 1 1.7999999999999998 1
MCE_DeC_KL Total: tensor(3.3491) local CE: tensor(0.2115) Feature CE: tensor(1.4390) KL: tensor(0.1196)
The last decorrelation: tensor(0.8663)
Local adapation with distilling: 0.0007840000000000001 alphas: 1 1 1.7999999999999998 1
MCE_DeC_KL Total: tensor(3.7332) local CE: tensor(0.6649) Feature CE: tensor(1.1255) KL: tensor(0.1719)
The last decorrelation: tensor(0.9842)
Local adapation with distilling: 0.0007840000000000001 alphas: 1 1 1.7999999999999998 1
MCE_DeC_KL Total: tensor(5.1353) local CE: tensor(0.9072) Feature CE: tensor(1.7738) KL: tensor(0.7257)
The last decorrelation: tensor(0.9606)
Global Model Acc on global data: 0.3512046148625721 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  13  -------------
selected users: [55, 64, 21, 101, 112, 33, 135, 123, 46, 90, 138, 133, 87, 44, 114]
Current data/feature buff: torch.Size([47, 128, 20, 7]) torch.Size([47]) 47
Buffer classes: Counter({0: 18, 5: 14, 1: 7, 4: 5, 2: 3})
Local adapation with distilling: 0.0007660000000000001 alphas: 1 1 1.7 1
MCE_DeC_KL Total: tensor(4.2490) local CE: tensor(0.7882) Feature CE: tensor(1.3560) KL: tensor(0.5228)
The last decorrelation: tensor(0.9217)
Local adapation with distilling: 0.0007660000000000001 alphas: 1 1 1.7 1
MCE_DeC_KL Total: tensor(4.2845) local CE: tensor(0.8274) Feature CE: tensor(1.5412) KL: tensor(0.4708)
The last decorrelation: tensor(0.8553)
Local adapation with distilling: 0.0007660000000000001 alphas: 1 1 1.7 1
MCE_DeC_KL Total: tensor(4.2543) local CE: tensor(0.7786) Feature CE: tensor(1.4900) KL: tensor(0.3137)
The last decorrelation: tensor(0.9839)
Local adapation with distilling: 0.0007660000000000001 alphas: 1 1 1.7 1
MCE_DeC_KL Total: tensor(4.6257) local CE: tensor(1.0702) Feature CE: tensor(1.5870) KL: tensor(0.4769)
The last decorrelation: tensor(0.8786)
Local adapation with distilling: 0.0007660000000000001 alphas: 1 1 1.7 1
MCE_DeC_KL Total: tensor(4.7849) local CE: tensor(1.0348) Feature CE: tensor(1.6930) KL: tensor(0.4855)
The last decorrelation: tensor(0.9253)
Local adapation with distilling: 0.0007660000000000001 alphas: 1 1 1.7 1
MCE_DeC_KL Total: tensor(4.3102) local CE: tensor(0.6022) Feature CE: tensor(1.5769) KL: tensor(0.5215)
The last decorrelation: tensor(0.9603)
Local adapation with distilling: 0.0007660000000000001 alphas: 1 1 1.7 1
MCE_DeC_KL Total: tensor(3.7943) local CE: tensor(0.5133) Feature CE: tensor(1.2298) KL: tensor(0.5012)
The last decorrelation: tensor(0.9085)
Local adapation with distilling: 0.0007660000000000001 alphas: 1 1 1.7 1
MCE_DeC_KL Total: tensor(4.4513) local CE: tensor(0.9240) Feature CE: tensor(1.6585) KL: tensor(0.4196)
The last decorrelation: tensor(0.8519)
Local adapation with distilling: 0.0007660000000000001 alphas: 1 1 1.7 1
MCE_DeC_KL Total: tensor(4.3713) local CE: tensor(0.8511) Feature CE: tensor(1.5836) KL: tensor(0.3908)
The last decorrelation: tensor(0.9101)
Local adapation with distilling: 0.0007660000000000001 alphas: 1 1 1.7 1
MCE_DeC_KL Total: tensor(4.7055) local CE: tensor(0.5484) Feature CE: tensor(1.7975) KL: tensor(0.7356)
The last decorrelation: tensor(0.9571)
Local adapation with distilling: 0.0007660000000000001 alphas: 1 1 1.7 1
MCE_DeC_KL Total: tensor(3.9062) local CE: tensor(0.5435) Feature CE: tensor(1.3124) KL: tensor(0.3881)
The last decorrelation: tensor(0.9774)
Local adapation with distilling: 0.0007660000000000001 alphas: 1 1 1.7 1
MCE_DeC_KL Total: tensor(4.5805) local CE: tensor(0.9740) Feature CE: tensor(1.5691) KL: tensor(0.3896)
The last decorrelation: tensor(0.9700)
Local adapation with distilling: 0.0007660000000000001 alphas: 1 1 1.7 1
MCE_DeC_KL Total: tensor(3.9351) local CE: tensor(0.5885) Feature CE: tensor(1.1417) KL: tensor(0.5468)
The last decorrelation: tensor(0.9770)
Local adapation with distilling: 0.0007660000000000001 alphas: 1 1 1.7 1
MCE_DeC_KL Total: tensor(3.7216) local CE: tensor(0.4743) Feature CE: tensor(1.1155) KL: tensor(0.4447)
The last decorrelation: tensor(0.9934)
Local adapation with distilling: 0.0007660000000000001 alphas: 1 1 1.7 1
MCE_DeC_KL Total: tensor(4.8922) local CE: tensor(0.9503) Feature CE: tensor(1.6527) KL: tensor(0.6595)
The last decorrelation: tensor(0.9579)
Global Model Acc on global data: 0.44350186630471666 length of data: 2947
save a model
size of the global feature buffer: 15
-------------Round number:  14  -------------
selected users: [24, 42, 6, 53, 113, 58, 40, 96, 23, 97, 106, 18, 103, 141, 20]
Current data/feature buff: torch.Size([42, 128, 20, 7]) torch.Size([42]) 42
Buffer classes: Counter({5: 12, 3: 10, 1: 7, 2: 5, 0: 4, 4: 4})
Local adapation with distilling: 0.000748 alphas: 1 1 1.5999999999999999 1
MCE_DeC_KL Total: tensor(3.8712) local CE: tensor(0.5188) Feature CE: tensor(1.4510) KL: tensor(0.4125)
The last decorrelation: tensor(0.9250)
Local adapation with distilling: 0.000748 alphas: 1 1 1.5999999999999999 1
MCE_DeC_KL Total: tensor(4.1707) local CE: tensor(0.6991) Feature CE: tensor(1.6348) KL: tensor(0.5078)
The last decorrelation: tensor(0.8300)
Local adapation with distilling: 0.000748 alphas: 1 1 1.5999999999999999 1
MCE_DeC_KL Total: tensor(3.6208) local CE: tensor(0.4947) Feature CE: tensor(1.2442) KL: tensor(0.3995)
The last decorrelation: tensor(0.9265)
Local adapation with distilling: 0.000748 alphas: 1 1 1.5999999999999999 1
MCE_DeC_KL Total: tensor(4.4477) local CE: tensor(1.1315) Feature CE: tensor(1.5339) KL: tensor(0.2336)
The last decorrelation: tensor(0.9591)
Local adapation with distilling: 0.000748 alphas: 1 1 1.5999999999999999 1
MCE_DeC_KL Total: tensor(3.8581) local CE: tensor(0.5439) Feature CE: tensor(1.3687) KL: tensor(0.3869)
The last decorrelation: tensor(0.9732)
Local adapation with distilling: 0.000748 alphas: 1 1 1.5999999999999999 1
MCE_DeC_KL Total: tensor(4.0953) local CE: tensor(0.9010) Feature CE: tensor(1.4607) KL: tensor(0.2848)
The last decorrelation: tensor(0.9060)
Local adapation with distilling: 0.000748 alphas: 1 1 1.5999999999999999 1
MCE_DeC_KL Total: tensor(4.0655) local CE: tensor(0.6801) Feature CE: tensor(1.7344) KL: tensor(0.1801)
The last decorrelation: tensor(0.9188)
Local adapation with distilling: 0.000748 alphas: 1 1 1.5999999999999999 1
MCE_DeC_KL Total: tensor(3.9892) local CE: tensor(0.6712) Feature CE: tensor(1.5639) KL: tensor(0.3404)
The last decorrelation: tensor(0.8821)
Local adapation with distilling: 0.000748 alphas: 1 1 1.5999999999999999 1
MCE_DeC_KL Total: tensor(4.4117) local CE: tensor(0.5747) Feature CE: tensor(1.8357) KL: tensor(0.4028)
The last decorrelation: tensor(0.9991)
Local adapation with distilling: 0.000748 alphas: 1 1 1.5999999999999999 1
MCE_DeC_KL Total: tensor(3.5639) local CE: tensor(0.4023) Feature CE: tensor(1.5409) KL: tensor(0.2812)
The last decorrelation: tensor(0.8261)
Local adapation with distilling: 0.000748 alphas: 1 1 1.5999999999999999 1
MCE_DeC_KL Total: tensor(3.7261) local CE: tensor(0.3101) Feature CE: tensor(1.3943) KL: tensor(0.4960)
The last decorrelation: tensor(0.9542)
Local adapation with distilling: 0.000748 alphas: 1 1 1.5999999999999999 1
MCE_DeC_KL Total: tensor(3.5079) local CE: tensor(0.3197) Feature CE: tensor(1.3428) KL: tensor(0.3346)
The last decorrelation: tensor(0.9476)
Local adapation with distilling: 0.000748 alphas: 1 1 1.5999999999999999 1
MCE_DeC_KL Total: tensor(3.7229) local CE: tensor(0.5213) Feature CE: tensor(1.5666) KL: tensor(0.3182)
The last decorrelation: tensor(0.8199)
Local adapation with distilling: 0.000748 alphas: 1 1 1.5999999999999999 1
MCE_DeC_KL Total: tensor(4.9242) local CE: tensor(1.2717) Feature CE: tensor(1.8542) KL: tensor(0.3676)
The last decorrelation: tensor(0.8933)
Local adapation with distilling: 0.000748 alphas: 1 1 1.5999999999999999 1
MCE_DeC_KL Total: tensor(4.2737) local CE: tensor(0.7783) Feature CE: tensor(1.5659) KL: tensor(0.4027)
The last decorrelation: tensor(0.9559)
Global Model Acc on global data: 0.48897183576518494 length of data: 2947
save a model
size of the global feature buffer: 15
-------------Round number:  15  -------------
selected users: [6, 61, 90, 30, 31, 55, 109, 98, 59, 103, 126, 97, 74, 67, 115]
Current data/feature buff: torch.Size([68, 128, 20, 7]) torch.Size([68]) 68
Buffer classes: Counter({2: 23, 3: 15, 4: 13, 0: 12, 1: 4, 5: 1})
Local adapation with distilling: 0.00073 alphas: 1 1 1.5 1
MCE_DeC_KL Total: tensor(3.2154) local CE: tensor(0.3831) Feature CE: tensor(1.1643) KL: tensor(0.2788)
The last decorrelation: tensor(0.9256)
Local adapation with distilling: 0.00073 alphas: 1 1 1.5 1
MCE_DeC_KL Total: tensor(3.1087) local CE: tensor(0.3515) Feature CE: tensor(1.1570) KL: tensor(0.3521)
The last decorrelation: tensor(0.8303)
Local adapation with distilling: 0.00073 alphas: 1 1 1.5 1
MCE_DeC_KL Total: tensor(4.1022) local CE: tensor(0.5407) Feature CE: tensor(1.4808) KL: tensor(0.6527)
The last decorrelation: tensor(0.9526)
Local adapation with distilling: 0.00073 alphas: 1 1 1.5 1
MCE_DeC_KL Total: tensor(3.8526) local CE: tensor(0.6289) Feature CE: tensor(1.6101) KL: tensor(0.3103)
The last decorrelation: tensor(0.8893)
Local adapation with distilling: 0.00073 alphas: 1 1 1.5 1
MCE_DeC_KL Total: tensor(3.4172) local CE: tensor(0.4464) Feature CE: tensor(1.3040) KL: tensor(0.3576)
The last decorrelation: tensor(0.8777)
Local adapation with distilling: 0.00073 alphas: 1 1 1.5 1
MCE_DeC_KL Total: tensor(3.9370) local CE: tensor(0.7174) Feature CE: tensor(1.5623) KL: tensor(0.2577)
The last decorrelation: tensor(0.9255)
Local adapation with distilling: 0.00073 alphas: 1 1 1.5 1
MCE_DeC_KL Total: tensor(3.4624) local CE: tensor(0.3782) Feature CE: tensor(1.4979) KL: tensor(0.2874)
The last decorrelation: tensor(0.8672)
Local adapation with distilling: 0.00073 alphas: 1 1 1.5 1
MCE_DeC_KL Total: tensor(3.9768) local CE: tensor(0.7189) Feature CE: tensor(1.5713) KL: tensor(0.3753)
The last decorrelation: tensor(0.8797)
Local adapation with distilling: 0.00073 alphas: 1 1 1.5 1
MCE_DeC_KL Total: tensor(4.1112) local CE: tensor(0.8451) Feature CE: tensor(1.5608) KL: tensor(0.2307)
The last decorrelation: tensor(0.9646)
Local adapation with distilling: 0.00073 alphas: 1 1 1.5 1
MCE_DeC_KL Total: tensor(3.0157) local CE: tensor(0.2898) Feature CE: tensor(1.1904) KL: tensor(0.3069)
The last decorrelation: tensor(0.8149)
Local adapation with distilling: 0.00073 alphas: 1 1 1.5 1
MCE_DeC_KL Total: tensor(4.6747) local CE: tensor(0.6986) Feature CE: tensor(1.6581) KL: tensor(0.8878)
The last decorrelation: tensor(0.9539)
Local adapation with distilling: 0.00073 alphas: 1 1 1.5 1
MCE_DeC_KL Total: tensor(3.6188) local CE: tensor(0.5040) Feature CE: tensor(1.4024) KL: tensor(0.4473)
The last decorrelation: tensor(0.8389)
Local adapation with distilling: 0.00073 alphas: 1 1 1.5 1
MCE_DeC_KL Total: tensor(3.3692) local CE: tensor(0.4358) Feature CE: tensor(1.2603) KL: tensor(0.3967)
The last decorrelation: tensor(0.8460)
Local adapation with distilling: 0.00073 alphas: 1 1 1.5 1
MCE_DeC_KL Total: tensor(3.5865) local CE: tensor(0.5842) Feature CE: tensor(1.3752) KL: tensor(0.3346)
The last decorrelation: tensor(0.8593)
Local adapation with distilling: 0.00073 alphas: 1 1 1.5 1
MCE_DeC_KL Total: tensor(3.4042) local CE: tensor(0.2101) Feature CE: tensor(1.3710) KL: tensor(0.4115)
The last decorrelation: tensor(0.9397)
Global Model Acc on global data: 0.4696301323379708 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  16  -------------
selected users: [56, 32, 50, 77, 63, 45, 75, 29, 47, 94, 60, 148, 134, 9, 137]
Current data/feature buff: torch.Size([111, 128, 20, 7]) torch.Size([111]) 111
Buffer classes: Counter({2: 31, 0: 28, 1: 23, 4: 14, 5: 9, 3: 6})
Local adapation with distilling: 0.000712 alphas: 1 1 1.4 1
MCE_DeC_KL Total: tensor(3.8306) local CE: tensor(0.6414) Feature CE: tensor(1.4459) KL: tensor(0.4543)
The last decorrelation: tensor(0.9480)
Local adapation with distilling: 0.000712 alphas: 1 1 1.4 1
MCE_DeC_KL Total: tensor(3.1855) local CE: tensor(0.2121) Feature CE: tensor(1.3517) KL: tensor(0.3032)
The last decorrelation: tensor(0.9396)
Local adapation with distilling: 0.000712 alphas: 1 1 1.4 1
MCE_DeC_KL Total: tensor(3.5394) local CE: tensor(0.6540) Feature CE: tensor(1.1881) KL: tensor(0.3614)
The last decorrelation: tensor(0.9557)
Local adapation with distilling: 0.000712 alphas: 1 1 1.4 1
MCE_DeC_KL Total: tensor(3.8759) local CE: tensor(0.7126) Feature CE: tensor(1.4509) KL: tensor(0.4334)
The last decorrelation: tensor(0.9163)
Local adapation with distilling: 0.000712 alphas: 1 1 1.4 1
MCE_DeC_KL Total: tensor(3.2628) local CE: tensor(0.5064) Feature CE: tensor(1.2002) KL: tensor(0.3125)
The last decorrelation: tensor(0.8852)
Local adapation with distilling: 0.000712 alphas: 1 1 1.4 1
MCE_DeC_KL Total: tensor(3.3805) local CE: tensor(0.4800) Feature CE: tensor(1.3524) KL: tensor(0.3500)
The last decorrelation: tensor(0.8635)
Local adapation with distilling: 0.000712 alphas: 1 1 1.4 1
MCE_DeC_KL Total: tensor(3.3037) local CE: tensor(0.5124) Feature CE: tensor(1.1053) KL: tensor(0.3354)
The last decorrelation: tensor(0.9640)
Local adapation with distilling: 0.000712 alphas: 1 1 1.4 1
MCE_DeC_KL Total: tensor(3.1729) local CE: tensor(0.2867) Feature CE: tensor(1.3200) KL: tensor(0.3126)
The last decorrelation: tensor(0.8947)
Local adapation with distilling: 0.000712 alphas: 1 1 1.4 1
MCE_DeC_KL Total: tensor(3.6299) local CE: tensor(0.4991) Feature CE: tensor(1.3714) KL: tensor(0.3861)
The last decorrelation: tensor(0.9838)
Local adapation with distilling: 0.000712 alphas: 1 1 1.4 1
MCE_DeC_KL Total: tensor(3.6512) local CE: tensor(0.5120) Feature CE: tensor(1.4111) KL: tensor(0.4350)
The last decorrelation: tensor(0.9258)
Local adapation with distilling: 0.000712 alphas: 1 1 1.4 1
MCE_DeC_KL Total: tensor(3.4462) local CE: tensor(0.3725) Feature CE: tensor(1.4912) KL: tensor(0.2669)
The last decorrelation: tensor(0.9475)
Local adapation with distilling: 0.000712 alphas: 1 1 1.4 1
MCE_DeC_KL Total: tensor(3.2221) local CE: tensor(0.3441) Feature CE: tensor(1.3528) KL: tensor(0.2641)
The last decorrelation: tensor(0.8874)
Local adapation with distilling: 0.000712 alphas: 1 1 1.4 1
MCE_DeC_KL Total: tensor(3.5439) local CE: tensor(0.5499) Feature CE: tensor(1.3287) KL: tensor(0.4088)
The last decorrelation: tensor(0.8959)
Local adapation with distilling: 0.000712 alphas: 1 1 1.4 1
MCE_DeC_KL Total: tensor(3.4668) local CE: tensor(0.5445) Feature CE: tensor(1.4458) KL: tensor(0.2359)
The last decorrelation: tensor(0.8864)
Local adapation with distilling: 0.000712 alphas: 1 1 1.4 1
MCE_DeC_KL Total: tensor(5.1418) local CE: tensor(0.8082) Feature CE: tensor(2.3150) KL: tensor(0.6986)
The last decorrelation: tensor(0.9441)
Global Model Acc on global data: 0.45673566338649474 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  17  -------------
selected users: [16, 78, 145, 99, 126, 127, 84, 117, 80, 113, 144, 9, 55, 11, 110]
Current data/feature buff: torch.Size([59, 128, 20, 7]) torch.Size([59]) 59
Buffer classes: Counter({4: 28, 5: 17, 2: 8, 1: 3, 0: 2, 3: 1})
Local adapation with distilling: 0.000694 alphas: 1 1 1.2999999999999998 1
MCE_DeC_KL Total: tensor(3.0670) local CE: tensor(0.4506) Feature CE: tensor(1.0087) KL: tensor(0.3496)
The last decorrelation: tensor(0.9615)
Local adapation with distilling: 0.000694 alphas: 1 1 1.2999999999999998 1
MCE_DeC_KL Total: tensor(3.2653) local CE: tensor(0.5513) Feature CE: tensor(1.0864) KL: tensor(0.3282)
The last decorrelation: tensor(0.9996)
Local adapation with distilling: 0.000694 alphas: 1 1 1.2999999999999998 1
MCE_DeC_KL Total: tensor(3.0756) local CE: tensor(0.4119) Feature CE: tensor(1.3515) KL: tensor(0.1796)
The last decorrelation: tensor(0.8575)
Local adapation with distilling: 0.000694 alphas: 1 1 1.2999999999999998 1
MCE_DeC_KL Total: tensor(3.5798) local CE: tensor(0.7388) Feature CE: tensor(1.4075) KL: tensor(0.2833)
The last decorrelation: tensor(0.8848)
Local adapation with distilling: 0.000694 alphas: 1 1 1.2999999999999998 1
MCE_DeC_KL Total: tensor(3.8871) local CE: tensor(0.6658) Feature CE: tensor(1.8078) KL: tensor(0.1694)
The last decorrelation: tensor(0.9538)
Local adapation with distilling: 0.000694 alphas: 1 1 1.2999999999999998 1
MCE_DeC_KL Total: tensor(4.0783) local CE: tensor(1.0771) Feature CE: tensor(1.4687) KL: tensor(0.2976)
The last decorrelation: tensor(0.9302)
Local adapation with distilling: 0.000694 alphas: 1 1 1.2999999999999998 1
MCE_DeC_KL Total: tensor(3.7047) local CE: tensor(0.7109) Feature CE: tensor(1.7019) KL: tensor(0.1440)
The last decorrelation: tensor(0.8806)
Local adapation with distilling: 0.000694 alphas: 1 1 1.2999999999999998 1
MCE_DeC_KL Total: tensor(3.3064) local CE: tensor(0.7717) Feature CE: tensor(1.1818) KL: tensor(0.1357)
The last decorrelation: tensor(0.9479)
Local adapation with distilling: 0.000694 alphas: 1 1 1.2999999999999998 1
MCE_DeC_KL Total: tensor(3.4751) local CE: tensor(0.6894) Feature CE: tensor(1.2880) KL: tensor(0.3392)
The last decorrelation: tensor(0.8905)
Local adapation with distilling: 0.000694 alphas: 1 1 1.2999999999999998 1
MCE_DeC_KL Total: tensor(3.4882) local CE: tensor(0.5249) Feature CE: tensor(1.4494) KL: tensor(0.2598)
The last decorrelation: tensor(0.9703)
Local adapation with distilling: 0.000694 alphas: 1 1 1.2999999999999998 1
MCE_DeC_KL Total: tensor(3.6152) local CE: tensor(0.2811) Feature CE: tensor(1.2898) KL: tensor(0.7732)
The last decorrelation: tensor(0.9749)
Local adapation with distilling: 0.000694 alphas: 1 1 1.2999999999999998 1
MCE_DeC_KL Total: tensor(3.7388) local CE: tensor(0.7615) Feature CE: tensor(1.5373) KL: tensor(0.2851)
The last decorrelation: tensor(0.8868)
Local adapation with distilling: 0.000694 alphas: 1 1 1.2999999999999998 1
MCE_DeC_KL Total: tensor(3.6414) local CE: tensor(0.8613) Feature CE: tensor(1.3184) KL: tensor(0.2571)
The last decorrelation: tensor(0.9398)
Local adapation with distilling: 0.000694 alphas: 1 1 1.2999999999999998 1
MCE_DeC_KL Total: tensor(3.5439) local CE: tensor(0.8639) Feature CE: tensor(1.2905) KL: tensor(0.1653)
The last decorrelation: tensor(0.9425)
Local adapation with distilling: 0.000694 alphas: 1 1 1.2999999999999998 1
MCE_DeC_KL Total: tensor(3.8532) local CE: tensor(0.5924) Feature CE: tensor(1.6183) KL: tensor(0.4532)
The last decorrelation: tensor(0.9309)
Global Model Acc on global data: 0.44044791313199866 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  18  -------------
selected users: [81, 92, 80, 4, 30, 24, 129, 41, 102, 87, 144, 54, 18, 109, 33]
Current data/feature buff: torch.Size([62, 128, 20, 7]) torch.Size([62]) 62
Buffer classes: Counter({3: 22, 5: 18, 4: 13, 2: 4, 1: 3, 0: 2})
Local adapation with distilling: 0.0006760000000000001 alphas: 1 1 1.2 1
MCE_DeC_KL Total: tensor(3.8209) local CE: tensor(0.8872) Feature CE: tensor(1.7602) KL: tensor(0.1346)
The last decorrelation: tensor(0.8579)
Local adapation with distilling: 0.0006760000000000001 alphas: 1 1 1.2 1
MCE_DeC_KL Total: tensor(2.9391) local CE: tensor(0.4022) Feature CE: tensor(1.4424) KL: tensor(0.0865)
The last decorrelation: tensor(0.8305)
Local adapation with distilling: 0.0006760000000000001 alphas: 1 1 1.2 1
MCE_DeC_KL Total: tensor(3.1851) local CE: tensor(0.5969) Feature CE: tensor(1.3487) KL: tensor(0.1650)
The last decorrelation: tensor(0.8954)
Local adapation with distilling: 0.0006760000000000001 alphas: 1 1 1.2 1
MCE_DeC_KL Total: tensor(3.2508) local CE: tensor(0.3502) Feature CE: tensor(1.5446) KL: tensor(0.3010)
The last decorrelation: tensor(0.8661)
Local adapation with distilling: 0.0006760000000000001 alphas: 1 1 1.2 1
MCE_DeC_KL Total: tensor(3.4214) local CE: tensor(0.5726) Feature CE: tensor(1.7056) KL: tensor(0.1071)
The last decorrelation: tensor(0.8593)
Local adapation with distilling: 0.0006760000000000001 alphas: 1 1 1.2 1
MCE_DeC_KL Total: tensor(3.0694) local CE: tensor(0.5098) Feature CE: tensor(1.1436) KL: tensor(0.2839)
The last decorrelation: tensor(0.9573)
Local adapation with distilling: 0.0006760000000000001 alphas: 1 1 1.2 1
MCE_DeC_KL Total: tensor(2.7421) local CE: tensor(0.2805) Feature CE: tensor(1.2484) KL: tensor(0.1509)
The last decorrelation: tensor(0.8872)
Local adapation with distilling: 0.0006760000000000001 alphas: 1 1 1.2 1
MCE_DeC_KL Total: tensor(2.9634) local CE: tensor(0.3810) Feature CE: tensor(1.4442) KL: tensor(0.1057)
The last decorrelation: tensor(0.8541)
Local adapation with distilling: 0.0006760000000000001 alphas: 1 1 1.2 1
MCE_DeC_KL Total: tensor(2.6927) local CE: tensor(0.3155) Feature CE: tensor(1.0815) KL: tensor(0.1346)
The last decorrelation: tensor(0.9713)
Local adapation with distilling: 0.0006760000000000001 alphas: 1 1 1.2 1
MCE_DeC_KL Total: tensor(3.0018) local CE: tensor(0.4984) Feature CE: tensor(1.1675) KL: tensor(0.1696)
The last decorrelation: tensor(0.9687)
Local adapation with distilling: 0.0006760000000000001 alphas: 1 1 1.2 1
MCE_DeC_KL Total: tensor(3.5842) local CE: tensor(0.4958) Feature CE: tensor(1.6382) KL: tensor(0.2768)
The last decorrelation: tensor(0.9786)
Local adapation with distilling: 0.0006760000000000001 alphas: 1 1 1.2 1
MCE_DeC_KL Total: tensor(3.2515) local CE: tensor(0.5147) Feature CE: tensor(1.4164) KL: tensor(0.2119)
The last decorrelation: tensor(0.9245)
Local adapation with distilling: 0.0006760000000000001 alphas: 1 1 1.2 1
MCE_DeC_KL Total: tensor(2.7498) local CE: tensor(0.3152) Feature CE: tensor(1.1799) KL: tensor(0.1241)
The last decorrelation: tensor(0.9429)
Local adapation with distilling: 0.0006760000000000001 alphas: 1 1 1.2 1
MCE_DeC_KL Total: tensor(2.8901) local CE: tensor(0.2867) Feature CE: tensor(1.4941) KL: tensor(0.0638)
The last decorrelation: tensor(0.8713)
Local adapation with distilling: 0.0006760000000000001 alphas: 1 1 1.2 1
MCE_DeC_KL Total: tensor(3.1585) local CE: tensor(0.3263) Feature CE: tensor(1.0809) KL: tensor(0.5996)
The last decorrelation: tensor(0.9650)
Global Model Acc on global data: 0.43942992874109266 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  19  -------------
selected users: [2, 112, 90, 88, 27, 7, 8, 37, 94, 105, 59, 23, 56, 30, 137]
Current data/feature buff: torch.Size([107, 128, 20, 7]) torch.Size([107]) 107
Buffer classes: Counter({0: 24, 1: 24, 3: 19, 2: 15, 5: 14, 4: 11})
Local adapation with distilling: 0.0006580000000000001 alphas: 1 1 1.0999999999999999 1
MCE_DeC_KL Total: tensor(3.2987) local CE: tensor(0.6154) Feature CE: tensor(1.4628) KL: tensor(0.2364)
The last decorrelation: tensor(0.8927)
Local adapation with distilling: 0.0006580000000000001 alphas: 1 1 1.0999999999999999 1
MCE_DeC_KL Total: tensor(3.5879) local CE: tensor(0.6293) Feature CE: tensor(1.6508) KL: tensor(0.2910)
The last decorrelation: tensor(0.9249)
Local adapation with distilling: 0.0006580000000000001 alphas: 1 1 1.0999999999999999 1
MCE_DeC_KL Total: tensor(3.3019) local CE: tensor(0.4015) Feature CE: tensor(1.3818) KL: tensor(0.4687)
The last decorrelation: tensor(0.9568)
Local adapation with distilling: 0.0006580000000000001 alphas: 1 1 1.0999999999999999 1
MCE_DeC_KL Total: tensor(3.8154) local CE: tensor(0.5195) Feature CE: tensor(1.3076) KL: tensor(0.9210)
The last decorrelation: tensor(0.9713)
Local adapation with distilling: 0.0006580000000000001 alphas: 1 1 1.0999999999999999 1
MCE_DeC_KL Total: tensor(3.2053) local CE: tensor(0.4758) Feature CE: tensor(1.4923) KL: tensor(0.3394)
The last decorrelation: tensor(0.8084)
Local adapation with distilling: 0.0006580000000000001 alphas: 1 1 1.0999999999999999 1
MCE_DeC_KL Total: tensor(3.4189) local CE: tensor(0.6804) Feature CE: tensor(1.3984) KL: tensor(0.2490)
The last decorrelation: tensor(0.9922)
Local adapation with distilling: 0.0006580000000000001 alphas: 1 1 1.0999999999999999 1
MCE_DeC_KL Total: tensor(3.3085) local CE: tensor(0.3882) Feature CE: tensor(1.4623) KL: tensor(0.3955)
The last decorrelation: tensor(0.9785)
Local adapation with distilling: 0.0006580000000000001 alphas: 1 1 1.0999999999999999 1
MCE_DeC_KL Total: tensor(3.3297) local CE: tensor(0.5624) Feature CE: tensor(1.4383) KL: tensor(0.3519)
The last decorrelation: tensor(0.8909)
Local adapation with distilling: 0.0006580000000000001 alphas: 1 1 1.0999999999999999 1
MCE_DeC_KL Total: tensor(3.7478) local CE: tensor(0.7537) Feature CE: tensor(1.5531) KL: tensor(0.4237)
The last decorrelation: tensor(0.9280)
Local adapation with distilling: 0.0006580000000000001 alphas: 1 1 1.0999999999999999 1
MCE_DeC_KL Total: tensor(3.1078) local CE: tensor(0.4642) Feature CE: tensor(1.2731) KL: tensor(0.2895)
The last decorrelation: tensor(0.9834)
Local adapation with distilling: 0.0006580000000000001 alphas: 1 1 1.0999999999999999 1
MCE_DeC_KL Total: tensor(3.6594) local CE: tensor(0.8051) Feature CE: tensor(1.5378) KL: tensor(0.2314)
The last decorrelation: tensor(0.9866)
Local adapation with distilling: 0.0006580000000000001 alphas: 1 1 1.0999999999999999 1
MCE_DeC_KL Total: tensor(3.4050) local CE: tensor(0.5224) Feature CE: tensor(1.4773) KL: tensor(0.3063)
The last decorrelation: tensor(0.9993)
Local adapation with distilling: 0.0006580000000000001 alphas: 1 1 1.0999999999999999 1
MCE_DeC_KL Total: tensor(3.9828) local CE: tensor(0.8652) Feature CE: tensor(1.6497) KL: tensor(0.4627)
The last decorrelation: tensor(0.9224)
Local adapation with distilling: 0.0006580000000000001 alphas: 1 1 1.0999999999999999 1
MCE_DeC_KL Total: tensor(3.3345) local CE: tensor(0.6563) Feature CE: tensor(1.4402) KL: tensor(0.2778)
The last decorrelation: tensor(0.8696)
Local adapation with distilling: 0.0006580000000000001 alphas: 1 1 1.0999999999999999 1
MCE_DeC_KL Total: tensor(3.5783) local CE: tensor(0.4427) Feature CE: tensor(1.6834) KL: tensor(0.4149)
The last decorrelation: tensor(0.9439)
Global Model Acc on global data: 0.45503902273498475 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  20  -------------
selected users: [47, 73, 74, 129, 67, 89, 143, 21, 108, 12, 147, 76, 119, 35, 28]
Current data/feature buff: torch.Size([48, 128, 20, 7]) torch.Size([48]) 48
Buffer classes: Counter({3: 17, 1: 9, 0: 8, 2: 6, 5: 6, 4: 2})
Local adapation with distilling: 0.00064 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8042) local CE: tensor(0.4111) Feature CE: tensor(1.1793) KL: tensor(0.2382)
The last decorrelation: tensor(0.9755)
Local adapation with distilling: 0.00064 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0012) local CE: tensor(0.5914) Feature CE: tensor(1.4099) KL: tensor(0.1624)
The last decorrelation: tensor(0.8492)
Local adapation with distilling: 0.00064 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7291) local CE: tensor(0.3847) Feature CE: tensor(1.3073) KL: tensor(0.1769)
The last decorrelation: tensor(0.8595)
Local adapation with distilling: 0.00064 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7296) local CE: tensor(0.3597) Feature CE: tensor(1.2722) KL: tensor(0.2139)
The last decorrelation: tensor(0.8869)
Local adapation with distilling: 0.00064 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1756) local CE: tensor(0.5544) Feature CE: tensor(1.5189) KL: tensor(0.2384)
The last decorrelation: tensor(0.8637)
Local adapation with distilling: 0.00064 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4434) local CE: tensor(0.9398) Feature CE: tensor(1.3755) KL: tensor(0.1948)
The last decorrelation: tensor(0.9338)
Local adapation with distilling: 0.00064 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8206) local CE: tensor(0.4322) Feature CE: tensor(1.3035) KL: tensor(0.2109)
The last decorrelation: tensor(0.8787)
Local adapation with distilling: 0.00064 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5380) local CE: tensor(0.9168) Feature CE: tensor(1.4664) KL: tensor(0.1717)
The last decorrelation: tensor(0.9832)
Local adapation with distilling: 0.00064 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9092) local CE: tensor(0.5446) Feature CE: tensor(1.1602) KL: tensor(0.2558)
The last decorrelation: tensor(0.9504)
Local adapation with distilling: 0.00064 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7879) local CE: tensor(0.3246) Feature CE: tensor(1.4242) KL: tensor(0.1627)
The last decorrelation: tensor(0.8729)
Local adapation with distilling: 0.00064 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0828) local CE: tensor(0.5701) Feature CE: tensor(1.4406) KL: tensor(0.1137)
The last decorrelation: tensor(0.9588)
Local adapation with distilling: 0.00064 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5174) local CE: tensor(0.1426) Feature CE: tensor(1.2121) KL: tensor(0.1968)
The last decorrelation: tensor(0.9681)
Local adapation with distilling: 0.00064 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6227) local CE: tensor(0.1837) Feature CE: tensor(1.2761) KL: tensor(0.2089)
The last decorrelation: tensor(0.9561)
Local adapation with distilling: 0.00064 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4140) local CE: tensor(0.8507) Feature CE: tensor(1.5033) KL: tensor(0.2156)
The last decorrelation: tensor(0.8432)
Local adapation with distilling: 0.00064 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3570) local CE: tensor(0.8671) Feature CE: tensor(1.3002) KL: tensor(0.2309)
The last decorrelation: tensor(0.9578)
Global Model Acc on global data: 0.44655581947743467 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  21  -------------
selected users: [92, 44, 7, 21, 95, 75, 20, 121, 26, 19, 81, 88, 143, 117, 23]
Current data/feature buff: torch.Size([121, 128, 20, 7]) torch.Size([121]) 121
Buffer classes: Counter({5: 43, 4: 34, 2: 17, 1: 16, 3: 7, 0: 4})
Local adapation with distilling: 0.0006220000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5727) local CE: tensor(0.2699) Feature CE: tensor(1.3414) KL: tensor(0.1115)
The last decorrelation: tensor(0.8454)
Local adapation with distilling: 0.0006220000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5486) local CE: tensor(0.3477) Feature CE: tensor(1.0681) KL: tensor(0.1393)
The last decorrelation: tensor(0.9928)
Local adapation with distilling: 0.0006220000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.8070) local CE: tensor(0.8188) Feature CE: tensor(1.6228) KL: tensor(0.3736)
The last decorrelation: tensor(0.9922)
Local adapation with distilling: 0.0006220000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4678) local CE: tensor(0.8765) Feature CE: tensor(1.4674) KL: tensor(0.1400)
The last decorrelation: tensor(0.9844)
Local adapation with distilling: 0.0006220000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0461) local CE: tensor(0.3808) Feature CE: tensor(1.6171) KL: tensor(0.1797)
The last decorrelation: tensor(0.8661)
Local adapation with distilling: 0.0006220000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3451) local CE: tensor(0.4858) Feature CE: tensor(1.7647) KL: tensor(0.1256)
The last decorrelation: tensor(0.9689)
Local adapation with distilling: 0.0006220000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2166) local CE: tensor(0.7102) Feature CE: tensor(1.3262) KL: tensor(0.2258)
The last decorrelation: tensor(0.9553)
Local adapation with distilling: 0.0006220000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5802) local CE: tensor(0.7175) Feature CE: tensor(1.5794) KL: tensor(0.3362)
The last decorrelation: tensor(0.9479)
Local adapation with distilling: 0.0006220000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9090) local CE: tensor(0.5096) Feature CE: tensor(1.4715) KL: tensor(0.1188)
The last decorrelation: tensor(0.8045)
Local adapation with distilling: 0.0006220000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6388) local CE: tensor(0.2705) Feature CE: tensor(1.2950) KL: tensor(0.1109)
The last decorrelation: tensor(0.9468)
Local adapation with distilling: 0.0006220000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2334) local CE: tensor(0.6685) Feature CE: tensor(1.5656) KL: tensor(0.1291)
The last decorrelation: tensor(0.8741)
Local adapation with distilling: 0.0006220000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4972) local CE: tensor(0.6309) Feature CE: tensor(1.4964) KL: tensor(0.3967)
The last decorrelation: tensor(0.9764)
Local adapation with distilling: 0.0006220000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6253) local CE: tensor(0.3531) Feature CE: tensor(1.2598) KL: tensor(0.1350)
The last decorrelation: tensor(0.8760)
Local adapation with distilling: 0.0006220000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2752) local CE: tensor(0.8547) Feature CE: tensor(1.3320) KL: tensor(0.1435)
The last decorrelation: tensor(0.9489)
Local adapation with distilling: 0.0006220000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.7857) local CE: tensor(0.5434) Feature CE: tensor(1.4064) KL: tensor(0.8366)
The last decorrelation: tensor(0.9995)
Global Model Acc on global data: 0.3983712249745504 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  22  -------------
selected users: [10, 115, 54, 146, 63, 76, 86, 138, 64, 35, 120, 95, 130, 109, 43]
Current data/feature buff: torch.Size([59, 128, 20, 7]) torch.Size([59]) 59
Buffer classes: Counter({3: 18, 2: 12, 4: 11, 1: 9, 5: 6, 0: 3})
Local adapation with distilling: 0.0006040000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1059) local CE: tensor(0.5836) Feature CE: tensor(1.3820) KL: tensor(0.1522)
The last decorrelation: tensor(0.9832)
Local adapation with distilling: 0.0006040000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5332) local CE: tensor(0.2055) Feature CE: tensor(1.2401) KL: tensor(0.1435)
The last decorrelation: tensor(0.9367)
Local adapation with distilling: 0.0006040000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1186) local CE: tensor(0.5257) Feature CE: tensor(1.5355) KL: tensor(0.1261)
The last decorrelation: tensor(0.9329)
Local adapation with distilling: 0.0006040000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5201) local CE: tensor(0.8761) Feature CE: tensor(1.4139) KL: tensor(0.3079)
The last decorrelation: tensor(0.9231)
Local adapation with distilling: 0.0006040000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2598) local CE: tensor(0.3673) Feature CE: tensor(1.7445) KL: tensor(0.2427)
The last decorrelation: tensor(0.8997)
Local adapation with distilling: 0.0006040000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4695) local CE: tensor(0.1765) Feature CE: tensor(1.1954) KL: tensor(0.1362)
The last decorrelation: tensor(0.9585)
Local adapation with distilling: 0.0006040000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0285) local CE: tensor(0.4588) Feature CE: tensor(1.1944) KL: tensor(0.4100)
The last decorrelation: tensor(0.9660)
Local adapation with distilling: 0.0006040000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0515) local CE: tensor(0.6354) Feature CE: tensor(1.3019) KL: tensor(0.1348)
The last decorrelation: tensor(0.9790)
Local adapation with distilling: 0.0006040000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7535) local CE: tensor(0.3735) Feature CE: tensor(1.3834) KL: tensor(0.1347)
The last decorrelation: tensor(0.8548)
Local adapation with distilling: 0.0006040000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.7175) local CE: tensor(1.0222) Feature CE: tensor(1.6168) KL: tensor(0.2265)
The last decorrelation: tensor(0.8518)
Local adapation with distilling: 0.0006040000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3909) local CE: tensor(0.9228) Feature CE: tensor(1.4032) KL: tensor(0.1349)
The last decorrelation: tensor(0.9306)
Local adapation with distilling: 0.0006040000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6867) local CE: tensor(0.4600) Feature CE: tensor(1.2600) KL: tensor(0.0970)
The last decorrelation: tensor(0.8672)
Local adapation with distilling: 0.0006040000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5997) local CE: tensor(0.7149) Feature CE: tensor(1.4745) KL: tensor(0.4392)
The last decorrelation: tensor(0.9721)
Local adapation with distilling: 0.0006040000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5513) local CE: tensor(0.2500) Feature CE: tensor(1.3085) KL: tensor(0.1094)
The last decorrelation: tensor(0.8691)
Local adapation with distilling: 0.0006040000000000002 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9370) local CE: tensor(0.5248) Feature CE: tensor(1.3540) KL: tensor(0.1594)
The last decorrelation: tensor(0.8989)
Global Model Acc on global data: 0.3878520529351883 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  23  -------------
selected users: [139, 125, 67, 3, 113, 52, 18, 137, 20, 64, 73, 30, 102, 19, 10]
Current data/feature buff: torch.Size([85, 128, 20, 7]) torch.Size([85]) 85
Buffer classes: Counter({5: 41, 1: 21, 4: 15, 2: 5, 0: 2, 3: 1})
Local adapation with distilling: 0.000586 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1351) local CE: tensor(0.7166) Feature CE: tensor(1.3053) KL: tensor(0.1559)
The last decorrelation: tensor(0.9578)
Local adapation with distilling: 0.000586 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4101) local CE: tensor(0.3774) Feature CE: tensor(0.8869) KL: tensor(0.1808)
The last decorrelation: tensor(0.9653)
Local adapation with distilling: 0.000586 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8067) local CE: tensor(0.4448) Feature CE: tensor(1.2720) KL: tensor(0.2129)
The last decorrelation: tensor(0.8737)
Local adapation with distilling: 0.000586 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4493) local CE: tensor(0.7097) Feature CE: tensor(1.4200) KL: tensor(0.3353)
The last decorrelation: tensor(0.9844)
Local adapation with distilling: 0.000586 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0480) local CE: tensor(0.5351) Feature CE: tensor(1.3271) KL: tensor(0.2176)
The last decorrelation: tensor(0.9501)
Local adapation with distilling: 0.000586 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3844) local CE: tensor(0.2020) Feature CE: tensor(1.1262) KL: tensor(0.1849)
The last decorrelation: tensor(0.8655)
Local adapation with distilling: 0.000586 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5891) local CE: tensor(0.3049) Feature CE: tensor(1.0912) KL: tensor(0.2453)
The last decorrelation: tensor(0.9434)
Local adapation with distilling: 0.000586 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9673) local CE: tensor(0.6492) Feature CE: tensor(1.0065) KL: tensor(0.3654)
The last decorrelation: tensor(0.9469)
Local adapation with distilling: 0.000586 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0190) local CE: tensor(0.6434) Feature CE: tensor(1.2093) KL: tensor(0.2091)
The last decorrelation: tensor(0.9573)
Local adapation with distilling: 0.000586 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4937) local CE: tensor(0.2556) Feature CE: tensor(1.2051) KL: tensor(0.1701)
The last decorrelation: tensor(0.8592)
Local adapation with distilling: 0.000586 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1648) local CE: tensor(0.6390) Feature CE: tensor(1.5326) KL: tensor(0.1426)
The last decorrelation: tensor(0.8398)
Local adapation with distilling: 0.000586 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9294) local CE: tensor(0.5390) Feature CE: tensor(1.2794) KL: tensor(0.2372)
The last decorrelation: tensor(0.8738)
Local adapation with distilling: 0.000586 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6937) local CE: tensor(0.3241) Feature CE: tensor(1.2473) KL: tensor(0.1466)
The last decorrelation: tensor(0.9759)
Local adapation with distilling: 0.000586 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5041) local CE: tensor(0.2388) Feature CE: tensor(1.1700) KL: tensor(0.1356)
The last decorrelation: tensor(0.9509)
Local adapation with distilling: 0.000586 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1255) local CE: tensor(0.6931) Feature CE: tensor(1.2084) KL: tensor(0.2397)
The last decorrelation: tensor(0.9833)
Global Model Acc on global data: 0.4177129284017645 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  24  -------------
selected users: [107, 114, 57, 59, 105, 11, 48, 72, 29, 148, 30, 19, 26, 111, 144]
Current data/feature buff: torch.Size([93, 128, 20, 7]) torch.Size([93]) 93
Buffer classes: Counter({3: 42, 1: 24, 4: 11, 2: 9, 5: 6, 0: 1})
Local adapation with distilling: 0.000568 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7709) local CE: tensor(0.4852) Feature CE: tensor(1.3153) KL: tensor(0.0980)
The last decorrelation: tensor(0.8707)
Local adapation with distilling: 0.000568 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4560) local CE: tensor(0.6650) Feature CE: tensor(1.3019) KL: tensor(0.5275)
The last decorrelation: tensor(0.9602)
Local adapation with distilling: 0.000568 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.7171) local CE: tensor(0.9263) Feature CE: tensor(1.6764) KL: tensor(0.2103)
The last decorrelation: tensor(0.9068)
Local adapation with distilling: 0.000568 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1270) local CE: tensor(0.7405) Feature CE: tensor(1.2672) KL: tensor(0.1325)
The last decorrelation: tensor(0.9849)
Local adapation with distilling: 0.000568 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3199) local CE: tensor(0.4043) Feature CE: tensor(1.5837) KL: tensor(0.3465)
The last decorrelation: tensor(0.9859)
Local adapation with distilling: 0.000568 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4626) local CE: tensor(0.9923) Feature CE: tensor(1.3647) KL: tensor(0.1594)
The last decorrelation: tensor(0.9483)
Local adapation with distilling: 0.000568 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(4.4765) local CE: tensor(1.3956) Feature CE: tensor(1.8184) KL: tensor(0.3213)
The last decorrelation: tensor(0.9404)
Local adapation with distilling: 0.000568 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.6372) local CE: tensor(0.9325) Feature CE: tensor(1.4243) KL: tensor(0.3636)
The last decorrelation: tensor(0.9180)
Local adapation with distilling: 0.000568 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5879) local CE: tensor(0.2847) Feature CE: tensor(1.2206) KL: tensor(0.1742)
The last decorrelation: tensor(0.8972)
Local adapation with distilling: 0.000568 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9002) local CE: tensor(0.5337) Feature CE: tensor(1.2671) KL: tensor(0.1892)
The last decorrelation: tensor(0.8974)
Local adapation with distilling: 0.000568 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9726) local CE: tensor(0.5127) Feature CE: tensor(1.3810) KL: tensor(0.2101)
The last decorrelation: tensor(0.8615)
Local adapation with distilling: 0.000568 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2678) local CE: tensor(0.1345) Feature CE: tensor(0.9554) KL: tensor(0.2137)
The last decorrelation: tensor(0.9630)
Local adapation with distilling: 0.000568 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3152) local CE: tensor(0.7357) Feature CE: tensor(1.6325) KL: tensor(0.1311)
The last decorrelation: tensor(0.8068)
Local adapation with distilling: 0.000568 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2956) local CE: tensor(0.7636) Feature CE: tensor(1.2463) KL: tensor(0.2910)
The last decorrelation: tensor(0.9948)
Local adapation with distilling: 0.000568 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4236) local CE: tensor(0.8496) Feature CE: tensor(1.4482) KL: tensor(0.1444)
The last decorrelation: tensor(0.9804)
Global Model Acc on global data: 0.4387512724804886 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  25  -------------
selected users: [28, 72, 70, 85, 128, 65, 127, 42, 81, 93, 21, 31, 26, 133, 6]
Current data/feature buff: torch.Size([55, 128, 20, 7]) torch.Size([55]) 55
Buffer classes: Counter({3: 21, 4: 15, 1: 6, 5: 5, 0: 5, 2: 3})
Local adapation with distilling: 0.00055 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2705) local CE: tensor(0.8176) Feature CE: tensor(1.2702) KL: tensor(0.2117)
The last decorrelation: tensor(0.9480)
Local adapation with distilling: 0.00055 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4057) local CE: tensor(0.8854) Feature CE: tensor(1.3877) KL: tensor(0.2149)
The last decorrelation: tensor(0.9168)
Local adapation with distilling: 0.00055 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8941) local CE: tensor(0.4304) Feature CE: tensor(1.1209) KL: tensor(0.3766)
The last decorrelation: tensor(0.9690)
Local adapation with distilling: 0.00055 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2975) local CE: tensor(0.6518) Feature CE: tensor(1.4050) KL: tensor(0.2878)
The last decorrelation: tensor(0.9536)
Local adapation with distilling: 0.00055 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0905) local CE: tensor(0.4281) Feature CE: tensor(1.6110) KL: tensor(0.1495)
The last decorrelation: tensor(0.9012)
Local adapation with distilling: 0.00055 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9797) local CE: tensor(0.6424) Feature CE: tensor(1.2482) KL: tensor(0.1437)
The last decorrelation: tensor(0.9466)
Local adapation with distilling: 0.00055 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2147) local CE: tensor(0.8643) Feature CE: tensor(1.2394) KL: tensor(0.1537)
The last decorrelation: tensor(0.9607)
Local adapation with distilling: 0.00055 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0995) local CE: tensor(0.5298) Feature CE: tensor(1.6158) KL: tensor(0.0987)
The last decorrelation: tensor(0.8466)
Local adapation with distilling: 0.00055 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.7145) local CE: tensor(1.0678) Feature CE: tensor(1.6472) KL: tensor(0.1219)
The last decorrelation: tensor(0.8758)
Local adapation with distilling: 0.00055 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6521) local CE: tensor(0.3504) Feature CE: tensor(1.1013) KL: tensor(0.2022)
The last decorrelation: tensor(0.9981)
Local adapation with distilling: 0.00055 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1182) local CE: tensor(0.6835) Feature CE: tensor(1.2779) KL: tensor(0.1726)
The last decorrelation: tensor(0.9844)
Local adapation with distilling: 0.00055 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9002) local CE: tensor(0.3556) Feature CE: tensor(1.4401) KL: tensor(0.2140)
The last decorrelation: tensor(0.8834)
Local adapation with distilling: 0.00055 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1394) local CE: tensor(0.6557) Feature CE: tensor(1.5668) KL: tensor(0.0927)
The last decorrelation: tensor(0.8152)
Local adapation with distilling: 0.00055 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2716) local CE: tensor(0.8720) Feature CE: tensor(1.2509) KL: tensor(0.1772)
The last decorrelation: tensor(0.9717)
Local adapation with distilling: 0.00055 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5941) local CE: tensor(0.3456) Feature CE: tensor(1.1683) KL: tensor(0.1479)
The last decorrelation: tensor(0.9317)
Global Model Acc on global data: 0.5151001017984391 length of data: 2947
save a model
size of the global feature buffer: 15
-------------Round number:  26  -------------
selected users: [86, 89, 31, 21, 137, 60, 20, 131, 135, 103, 43, 75, 80, 30, 67]
Current data/feature buff: torch.Size([65, 128, 20, 7]) torch.Size([65]) 65
Buffer classes: Counter({0: 17, 5: 15, 3: 14, 1: 12, 2: 5, 4: 2})
Local adapation with distilling: 0.000532 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9992) local CE: tensor(0.3990) Feature CE: tensor(1.2675) KL: tensor(0.3661)
The last decorrelation: tensor(0.9661)
Local adapation with distilling: 0.000532 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.7819) local CE: tensor(0.8712) Feature CE: tensor(1.6579) KL: tensor(0.3129)
The last decorrelation: tensor(0.9407)
Local adapation with distilling: 0.000532 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2030) local CE: tensor(0.3115) Feature CE: tensor(1.4094) KL: tensor(0.5951)
The last decorrelation: tensor(0.8751)
Local adapation with distilling: 0.000532 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4548) local CE: tensor(0.7702) Feature CE: tensor(1.4589) KL: tensor(0.2420)
The last decorrelation: tensor(0.9838)
Local adapation with distilling: 0.000532 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.7068) local CE: tensor(0.6009) Feature CE: tensor(1.6495) KL: tensor(0.5085)
The last decorrelation: tensor(0.9494)
Local adapation with distilling: 0.000532 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8412) local CE: tensor(0.1937) Feature CE: tensor(1.3342) KL: tensor(0.3713)
The last decorrelation: tensor(0.9536)
Local adapation with distilling: 0.000532 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4202) local CE: tensor(0.7475) Feature CE: tensor(1.3921) KL: tensor(0.3222)
The last decorrelation: tensor(0.9594)
Local adapation with distilling: 0.000532 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5067) local CE: tensor(0.6423) Feature CE: tensor(1.4718) KL: tensor(0.4402)
The last decorrelation: tensor(0.9529)
Local adapation with distilling: 0.000532 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3707) local CE: tensor(0.5122) Feature CE: tensor(1.4970) KL: tensor(0.4339)
The last decorrelation: tensor(0.9274)
Local adapation with distilling: 0.000532 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2423) local CE: tensor(0.3444) Feature CE: tensor(1.6520) KL: tensor(0.3981)
The last decorrelation: tensor(0.8449)
Local adapation with distilling: 0.000532 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.6596) local CE: tensor(0.6920) Feature CE: tensor(1.1023) KL: tensor(0.9626)
The last decorrelation: tensor(0.9027)
Local adapation with distilling: 0.000532 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4952) local CE: tensor(0.6217) Feature CE: tensor(1.7083) KL: tensor(0.1949)
The last decorrelation: tensor(0.9701)
Local adapation with distilling: 0.000532 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4797) local CE: tensor(0.6691) Feature CE: tensor(1.3339) KL: tensor(0.5768)
The last decorrelation: tensor(0.9049)
Local adapation with distilling: 0.000532 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5102) local CE: tensor(0.5635) Feature CE: tensor(1.7276) KL: tensor(0.3504)
The last decorrelation: tensor(0.8851)
Local adapation with distilling: 0.000532 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3756) local CE: tensor(0.5369) Feature CE: tensor(1.6111) KL: tensor(0.3531)
The last decorrelation: tensor(0.8722)
Global Model Acc on global data: 0.4781133355955209 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  27  -------------
selected users: [116, 36, 128, 117, 88, 74, 91, 115, 77, 21, 94, 133, 47, 90, 58]
Current data/feature buff: torch.Size([62, 128, 20, 7]) torch.Size([62]) 62
Buffer classes: Counter({5: 23, 2: 19, 0: 13, 1: 5, 4: 1, 3: 1})
Local adapation with distilling: 0.000514 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8765) local CE: tensor(0.5073) Feature CE: tensor(1.2737) KL: tensor(0.1718)
The last decorrelation: tensor(0.9263)
Local adapation with distilling: 0.000514 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9997) local CE: tensor(0.5720) Feature CE: tensor(1.3384) KL: tensor(0.1892)
The last decorrelation: tensor(0.9011)
Local adapation with distilling: 0.000514 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8991) local CE: tensor(0.5298) Feature CE: tensor(1.2395) KL: tensor(0.2282)
The last decorrelation: tensor(0.8953)
Local adapation with distilling: 0.000514 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3607) local CE: tensor(0.8122) Feature CE: tensor(1.4846) KL: tensor(0.1217)
The last decorrelation: tensor(0.9391)
Local adapation with distilling: 0.000514 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.8059) local CE: tensor(0.9447) Feature CE: tensor(1.6837) KL: tensor(0.2054)
The last decorrelation: tensor(0.9713)
Local adapation with distilling: 0.000514 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4724) local CE: tensor(0.3698) Feature CE: tensor(1.0693) KL: tensor(0.1611)
The last decorrelation: tensor(0.8832)
Local adapation with distilling: 0.000514 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1277) local CE: tensor(0.7138) Feature CE: tensor(1.3294) KL: tensor(0.1299)
The last decorrelation: tensor(0.9545)
Local adapation with distilling: 0.000514 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5360) local CE: tensor(0.1860) Feature CE: tensor(1.2432) KL: tensor(0.1564)
The last decorrelation: tensor(0.9522)
Local adapation with distilling: 0.000514 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0025) local CE: tensor(0.5514) Feature CE: tensor(1.3576) KL: tensor(0.1670)
The last decorrelation: tensor(0.9259)
Local adapation with distilling: 0.000514 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5305) local CE: tensor(0.8818) Feature CE: tensor(1.5326) KL: tensor(0.1324)
The last decorrelation: tensor(0.9837)
Local adapation with distilling: 0.000514 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6224) local CE: tensor(0.3535) Feature CE: tensor(1.1702) KL: tensor(0.1633)
The last decorrelation: tensor(0.9365)
Local adapation with distilling: 0.000514 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1840) local CE: tensor(0.7961) Feature CE: tensor(1.2765) KL: tensor(0.1401)
The last decorrelation: tensor(0.9715)
Local adapation with distilling: 0.000514 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3669) local CE: tensor(0.2581) Feature CE: tensor(0.8930) KL: tensor(0.2341)
The last decorrelation: tensor(0.9752)
Local adapation with distilling: 0.000514 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9816) local CE: tensor(0.4549) Feature CE: tensor(1.3407) KL: tensor(0.2294)
The last decorrelation: tensor(0.9577)
Local adapation with distilling: 0.000514 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1417) local CE: tensor(0.8354) Feature CE: tensor(1.2388) KL: tensor(0.1562)
The last decorrelation: tensor(0.9119)
Global Model Acc on global data: 0.42483881913810656 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  28  -------------
selected users: [24, 134, 81, 14, 114, 93, 128, 66, 59, 35, 101, 15, 50, 51, 130]
Current data/feature buff: torch.Size([61, 128, 20, 7]) torch.Size([61]) 61
Buffer classes: Counter({4: 23, 1: 11, 3: 11, 2: 9, 5: 6, 0: 1})
Local adapation with distilling: 0.000496 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6846) local CE: tensor(0.4606) Feature CE: tensor(1.1707) KL: tensor(0.1172)
The last decorrelation: tensor(0.9423)
Local adapation with distilling: 0.000496 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8924) local CE: tensor(0.5378) Feature CE: tensor(1.2052) KL: tensor(0.2411)
The last decorrelation: tensor(0.9089)
Local adapation with distilling: 0.000496 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0572) local CE: tensor(0.5568) Feature CE: tensor(1.5369) KL: tensor(0.0896)
The last decorrelation: tensor(0.8850)
Local adapation with distilling: 0.000496 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9544) local CE: tensor(0.4072) Feature CE: tensor(1.4966) KL: tensor(0.1402)
The last decorrelation: tensor(0.9090)
Local adapation with distilling: 0.000496 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5014) local CE: tensor(0.9736) Feature CE: tensor(1.3956) KL: tensor(0.1688)
The last decorrelation: tensor(0.9590)
Local adapation with distilling: 0.000496 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6042) local CE: tensor(0.3308) Feature CE: tensor(1.0210) KL: tensor(0.2543)
The last decorrelation: tensor(0.9981)
Local adapation with distilling: 0.000496 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8806) local CE: tensor(0.3604) Feature CE: tensor(1.4481) KL: tensor(0.1754)
The last decorrelation: tensor(0.8939)
Local adapation with distilling: 0.000496 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7871) local CE: tensor(0.4912) Feature CE: tensor(1.3409) KL: tensor(0.1008)
The last decorrelation: tensor(0.8499)
Local adapation with distilling: 0.000496 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2633) local CE: tensor(0.9061) Feature CE: tensor(1.3070) KL: tensor(0.0624)
The last decorrelation: tensor(0.9886)
Local adapation with distilling: 0.000496 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1943) local CE: tensor(0.6627) Feature CE: tensor(1.5505) KL: tensor(0.1265)
The last decorrelation: tensor(0.8528)
Local adapation with distilling: 0.000496 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8759) local CE: tensor(0.4949) Feature CE: tensor(1.4146) KL: tensor(0.0767)
The last decorrelation: tensor(0.8926)
Local adapation with distilling: 0.000496 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5111) local CE: tensor(0.3571) Feature CE: tensor(1.0748) KL: tensor(0.1327)
The last decorrelation: tensor(0.9311)
Local adapation with distilling: 0.000496 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2988) local CE: tensor(0.6542) Feature CE: tensor(1.3215) KL: tensor(0.3646)
The last decorrelation: tensor(0.9586)
Local adapation with distilling: 0.000496 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8653) local CE: tensor(0.4665) Feature CE: tensor(1.3287) KL: tensor(0.1830)
The last decorrelation: tensor(0.8874)
Local adapation with distilling: 0.000496 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3867) local CE: tensor(0.8901) Feature CE: tensor(1.2757) KL: tensor(0.2501)
The last decorrelation: tensor(0.9712)
Global Model Acc on global data: 0.500848320325755 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  29  -------------
selected users: [147, 111, 121, 137, 2, 91, 107, 106, 70, 87, 100, 10, 53, 125, 71]
Current data/feature buff: torch.Size([56, 128, 20, 7]) torch.Size([56]) 56
Buffer classes: Counter({0: 13, 1: 11, 3: 11, 5: 9, 2: 7, 4: 5})
Local adapation with distilling: 0.0004780000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0939) local CE: tensor(0.6581) Feature CE: tensor(1.3303) KL: tensor(0.1430)
The last decorrelation: tensor(0.9636)
Local adapation with distilling: 0.0004780000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5961) local CE: tensor(1.0111) Feature CE: tensor(1.3964) KL: tensor(0.1934)
The last decorrelation: tensor(0.9951)
Local adapation with distilling: 0.0004780000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2111) local CE: tensor(0.5935) Feature CE: tensor(1.4911) KL: tensor(0.1782)
The last decorrelation: tensor(0.9488)
Local adapation with distilling: 0.0004780000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0327) local CE: tensor(0.4352) Feature CE: tensor(1.2810) KL: tensor(0.3703)
The last decorrelation: tensor(0.9464)
Local adapation with distilling: 0.0004780000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8839) local CE: tensor(0.3744) Feature CE: tensor(1.3690) KL: tensor(0.2388)
The last decorrelation: tensor(0.9059)
Local adapation with distilling: 0.0004780000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3601) local CE: tensor(0.8439) Feature CE: tensor(1.3409) KL: tensor(0.2211)
The last decorrelation: tensor(0.9546)
Local adapation with distilling: 0.0004780000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0523) local CE: tensor(0.6116) Feature CE: tensor(1.3702) KL: tensor(0.1972)
The last decorrelation: tensor(0.8728)
Local adapation with distilling: 0.0004780000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1044) local CE: tensor(0.5208) Feature CE: tensor(1.4294) KL: tensor(0.2051)
The last decorrelation: tensor(0.9487)
Local adapation with distilling: 0.0004780000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0201) local CE: tensor(0.4709) Feature CE: tensor(1.3383) KL: tensor(0.2450)
The last decorrelation: tensor(0.9647)
Local adapation with distilling: 0.0004780000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7189) local CE: tensor(0.3628) Feature CE: tensor(1.2006) KL: tensor(0.1843)
The last decorrelation: tensor(0.9685)
Local adapation with distilling: 0.0004780000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0766) local CE: tensor(0.5893) Feature CE: tensor(1.2878) KL: tensor(0.2704)
The last decorrelation: tensor(0.9209)
Local adapation with distilling: 0.0004780000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1053) local CE: tensor(0.5999) Feature CE: tensor(1.3166) KL: tensor(0.2051)
The last decorrelation: tensor(0.9754)
Local adapation with distilling: 0.0004780000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.6581) local CE: tensor(1.1185) Feature CE: tensor(1.4641) KL: tensor(0.1062)
The last decorrelation: tensor(0.9868)
Local adapation with distilling: 0.0004780000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1744) local CE: tensor(0.7072) Feature CE: tensor(1.2900) KL: tensor(0.2121)
The last decorrelation: tensor(0.9658)
Local adapation with distilling: 0.0004780000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8317) local CE: tensor(0.3638) Feature CE: tensor(1.3581) KL: tensor(0.1832)
The last decorrelation: tensor(0.9286)
Global Model Acc on global data: 0.5446216491347132 length of data: 2947
save a model
size of the global feature buffer: 15
-------------Round number:  30  -------------
selected users: [20, 5, 3, 101, 82, 80, 123, 145, 74, 107, 38, 103, 93, 99, 8]
Current data/feature buff: torch.Size([40, 128, 20, 7]) torch.Size([40]) 40
Buffer classes: Counter({5: 16, 1: 10, 3: 8, 2: 4, 0: 1, 4: 1})
Local adapation with distilling: 0.00046000000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9393) local CE: tensor(0.6101) Feature CE: tensor(1.2115) KL: tensor(0.1609)
The last decorrelation: tensor(0.9573)
Local adapation with distilling: 0.00046000000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4063) local CE: tensor(0.9268) Feature CE: tensor(1.3042) KL: tensor(0.2554)
The last decorrelation: tensor(0.9197)
Local adapation with distilling: 0.00046000000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9482) local CE: tensor(0.5648) Feature CE: tensor(1.1510) KL: tensor(0.2487)
The last decorrelation: tensor(0.9830)
Local adapation with distilling: 0.00046000000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1149) local CE: tensor(0.6353) Feature CE: tensor(1.4517) KL: tensor(0.1345)
The last decorrelation: tensor(0.9021)
Local adapation with distilling: 0.00046000000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5261) local CE: tensor(0.7699) Feature CE: tensor(1.6882) KL: tensor(0.1340)
The last decorrelation: tensor(0.9350)
Local adapation with distilling: 0.00046000000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7079) local CE: tensor(0.4680) Feature CE: tensor(1.1349) KL: tensor(0.2104)
The last decorrelation: tensor(0.9013)
Local adapation with distilling: 0.00046000000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8784) local CE: tensor(0.4969) Feature CE: tensor(1.3750) KL: tensor(0.1404)
The last decorrelation: tensor(0.8652)
Local adapation with distilling: 0.00046000000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9460) local CE: tensor(0.4662) Feature CE: tensor(1.4676) KL: tensor(0.1461)
The last decorrelation: tensor(0.8612)
Local adapation with distilling: 0.00046000000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6002) local CE: tensor(0.3810) Feature CE: tensor(1.2386) KL: tensor(0.1130)
The last decorrelation: tensor(0.8568)
Local adapation with distilling: 0.00046000000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2133) local CE: tensor(0.2293) Feature CE: tensor(0.9949) KL: tensor(0.1145)
The last decorrelation: tensor(0.8732)
Local adapation with distilling: 0.00046000000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7126) local CE: tensor(0.3605) Feature CE: tensor(1.3862) KL: tensor(0.0972)
The last decorrelation: tensor(0.8635)
Local adapation with distilling: 0.00046000000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4632) local CE: tensor(0.2885) Feature CE: tensor(1.1953) KL: tensor(0.1330)
The last decorrelation: tensor(0.8429)
Local adapation with distilling: 0.00046000000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9818) local CE: tensor(0.5426) Feature CE: tensor(1.2909) KL: tensor(0.1502)
The last decorrelation: tensor(0.9981)
Local adapation with distilling: 0.00046000000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6926) local CE: tensor(0.4960) Feature CE: tensor(1.1549) KL: tensor(0.1513)
The last decorrelation: tensor(0.8902)
Local adapation with distilling: 0.00046000000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7576) local CE: tensor(0.4017) Feature CE: tensor(1.1698) KL: tensor(0.2111)
The last decorrelation: tensor(0.9687)
Global Model Acc on global data: 0.39056667797760436 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  31  -------------
selected users: [66, 132, 47, 96, 112, 45, 123, 95, 15, 21, 134, 85, 138, 13, 117]
Current data/feature buff: torch.Size([63, 128, 20, 7]) torch.Size([63]) 63
Buffer classes: Counter({2: 27, 3: 12, 0: 12, 5: 7, 4: 5})
Local adapation with distilling: 0.00044200000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5966) local CE: tensor(0.4339) Feature CE: tensor(1.1468) KL: tensor(0.1581)
The last decorrelation: tensor(0.8677)
Local adapation with distilling: 0.00044200000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6533) local CE: tensor(0.2643) Feature CE: tensor(1.2089) KL: tensor(0.1832)
The last decorrelation: tensor(0.9969)
Local adapation with distilling: 0.00044200000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6739) local CE: tensor(0.2953) Feature CE: tensor(1.2374) KL: tensor(0.1635)
The last decorrelation: tensor(0.9873)
Local adapation with distilling: 0.00044200000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1571) local CE: tensor(0.5263) Feature CE: tensor(1.5209) KL: tensor(0.2211)
The last decorrelation: tensor(0.8838)
Local adapation with distilling: 0.00044200000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4316) local CE: tensor(0.3140) Feature CE: tensor(1.0528) KL: tensor(0.1328)
The last decorrelation: tensor(0.9327)
Local adapation with distilling: 0.00044200000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6972) local CE: tensor(0.3863) Feature CE: tensor(1.1029) KL: tensor(0.3172)
The last decorrelation: tensor(0.8865)
Local adapation with distilling: 0.00044200000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7177) local CE: tensor(0.4804) Feature CE: tensor(1.2293) KL: tensor(0.1441)
The last decorrelation: tensor(0.8631)
Local adapation with distilling: 0.00044200000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6890) local CE: tensor(0.4250) Feature CE: tensor(1.2175) KL: tensor(0.1756)
The last decorrelation: tensor(0.8685)
Local adapation with distilling: 0.00044200000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5873) local CE: tensor(0.3154) Feature CE: tensor(1.1487) KL: tensor(0.1773)
The last decorrelation: tensor(0.9391)
Local adapation with distilling: 0.00044200000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.7607) local CE: tensor(1.0363) Feature CE: tensor(1.5845) KL: tensor(0.1565)
The last decorrelation: tensor(0.9836)
Local adapation with distilling: 0.00044200000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(4.0494) local CE: tensor(1.0576) Feature CE: tensor(1.7645) KL: tensor(0.3205)
The last decorrelation: tensor(0.9070)
Local adapation with distilling: 0.00044200000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5182) local CE: tensor(0.4034) Feature CE: tensor(1.0736) KL: tensor(0.0907)
The last decorrelation: tensor(0.9506)
Local adapation with distilling: 0.00044200000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.7687) local CE: tensor(1.0481) Feature CE: tensor(1.5758) KL: tensor(0.1647)
The last decorrelation: tensor(0.9801)
Local adapation with distilling: 0.00044200000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3082) local CE: tensor(0.6670) Feature CE: tensor(1.4939) KL: tensor(0.1587)
The last decorrelation: tensor(0.9884)
Local adapation with distilling: 0.00044200000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2615) local CE: tensor(0.7772) Feature CE: tensor(1.4035) KL: tensor(0.1405)
The last decorrelation: tensor(0.9511)
Global Model Acc on global data: 0.41737360027146253 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  32  -------------
selected users: [55, 22, 26, 56, 134, 131, 23, 34, 85, 21, 76, 115, 60, 67, 147]
Current data/feature buff: torch.Size([37, 128, 20, 7]) torch.Size([37]) 37
Buffer classes: Counter({4: 11, 2: 8, 5: 8, 3: 6, 1: 4})
Local adapation with distilling: 0.00042400000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1790) local CE: tensor(0.7018) Feature CE: tensor(1.2975) KL: tensor(0.2503)
The last decorrelation: tensor(0.9284)
Local adapation with distilling: 0.00042400000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8398) local CE: tensor(0.5350) Feature CE: tensor(1.3384) KL: tensor(0.1225)
The last decorrelation: tensor(0.8429)
Local adapation with distilling: 0.00042400000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3157) local CE: tensor(0.2254) Feature CE: tensor(1.2039) KL: tensor(0.0719)
The last decorrelation: tensor(0.8122)
Local adapation with distilling: 0.00042400000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1514) local CE: tensor(0.6243) Feature CE: tensor(1.4363) KL: tensor(0.1776)
The last decorrelation: tensor(0.9087)
Local adapation with distilling: 0.00042400000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2103) local CE: tensor(0.6736) Feature CE: tensor(1.3846) KL: tensor(0.2446)
The last decorrelation: tensor(0.9072)
Local adapation with distilling: 0.00042400000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6618) local CE: tensor(0.4212) Feature CE: tensor(1.1652) KL: tensor(0.1264)
The last decorrelation: tensor(0.9489)
Local adapation with distilling: 0.00042400000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2306) local CE: tensor(0.5456) Feature CE: tensor(1.4684) KL: tensor(0.2174)
The last decorrelation: tensor(0.9992)
Local adapation with distilling: 0.00042400000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1315) local CE: tensor(0.5653) Feature CE: tensor(1.3427) KL: tensor(0.2284)
The last decorrelation: tensor(0.9949)
Local adapation with distilling: 0.00042400000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9146) local CE: tensor(0.5308) Feature CE: tensor(1.3000) KL: tensor(0.1333)
The last decorrelation: tensor(0.9503)
Local adapation with distilling: 0.00042400000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8205) local CE: tensor(0.6752) Feature CE: tensor(1.0598) KL: tensor(0.1019)
The last decorrelation: tensor(0.9836)
Local adapation with distilling: 0.00042400000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2819) local CE: tensor(0.1525) Feature CE: tensor(1.0597) KL: tensor(0.1088)
The last decorrelation: tensor(0.9554)
Local adapation with distilling: 0.00042400000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4503) local CE: tensor(0.2098) Feature CE: tensor(1.1877) KL: tensor(0.1069)
The last decorrelation: tensor(0.9516)
Local adapation with distilling: 0.00042400000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4058) local CE: tensor(0.2210) Feature CE: tensor(1.1003) KL: tensor(0.1315)
The last decorrelation: tensor(0.9460)
Local adapation with distilling: 0.00042400000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1571) local CE: tensor(0.6201) Feature CE: tensor(1.5065) KL: tensor(0.1553)
The last decorrelation: tensor(0.8769)
Local adapation with distilling: 0.00042400000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3623) local CE: tensor(0.7223) Feature CE: tensor(1.4744) KL: tensor(0.2025)
The last decorrelation: tensor(0.9642)
Global Model Acc on global data: 0.3983712249745504 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  33  -------------
selected users: [96, 65, 29, 54, 134, 100, 24, 17, 137, 120, 143, 38, 136, 63, 141]
Current data/feature buff: torch.Size([71, 128, 20, 7]) torch.Size([71]) 71
Buffer classes: Counter({5: 45, 4: 16, 1: 4, 0: 3, 2: 2, 3: 1})
Local adapation with distilling: 0.00040600000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6835) local CE: tensor(0.4073) Feature CE: tensor(1.2337) KL: tensor(0.1495)
The last decorrelation: tensor(0.8835)
Local adapation with distilling: 0.00040600000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1529) local CE: tensor(0.3778) Feature CE: tensor(0.7228) KL: tensor(0.1167)
The last decorrelation: tensor(0.9287)
Local adapation with distilling: 0.00040600000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4457) local CE: tensor(0.2998) Feature CE: tensor(1.0632) KL: tensor(0.1814)
The last decorrelation: tensor(0.9020)
Local adapation with distilling: 0.00040600000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2640) local CE: tensor(0.5166) Feature CE: tensor(1.6843) KL: tensor(0.1269)
The last decorrelation: tensor(0.9377)
Local adapation with distilling: 0.00040600000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8755) local CE: tensor(0.4263) Feature CE: tensor(1.3162) KL: tensor(0.2227)
The last decorrelation: tensor(0.9107)
Local adapation with distilling: 0.00040600000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2787) local CE: tensor(0.3706) Feature CE: tensor(0.8378) KL: tensor(0.1429)
The last decorrelation: tensor(0.9373)
Local adapation with distilling: 0.00040600000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8803) local CE: tensor(0.5180) Feature CE: tensor(1.2241) KL: tensor(0.2027)
The last decorrelation: tensor(0.9402)
Local adapation with distilling: 0.00040600000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2500) local CE: tensor(0.9495) Feature CE: tensor(1.2344) KL: tensor(0.1092)
The last decorrelation: tensor(0.9564)
Local adapation with distilling: 0.00040600000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2894) local CE: tensor(0.8474) Feature CE: tensor(1.1790) KL: tensor(0.3163)
The last decorrelation: tensor(0.9465)
Local adapation with distilling: 0.00040600000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4225) local CE: tensor(1.1021) Feature CE: tensor(1.2743) KL: tensor(0.1161)
The last decorrelation: tensor(0.9297)
Local adapation with distilling: 0.00040600000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3226) local CE: tensor(0.2431) Feature CE: tensor(1.0820) KL: tensor(0.1147)
The last decorrelation: tensor(0.8794)
Local adapation with distilling: 0.00040600000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3033) local CE: tensor(0.7699) Feature CE: tensor(1.5005) KL: tensor(0.1530)
The last decorrelation: tensor(0.8728)
Local adapation with distilling: 0.00040600000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0368) local CE: tensor(0.7739) Feature CE: tensor(1.0424) KL: tensor(0.2754)
The last decorrelation: tensor(0.9491)
Local adapation with distilling: 0.00040600000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1430) local CE: tensor(0.5386) Feature CE: tensor(1.4910) KL: tensor(0.2026)
The last decorrelation: tensor(0.9043)
Local adapation with distilling: 0.00040600000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2545) local CE: tensor(0.7981) Feature CE: tensor(1.4673) KL: tensor(0.0804)
The last decorrelation: tensor(0.9095)
Global Model Acc on global data: 0.5629453681710214 length of data: 2947
save a model
size of the global feature buffer: 15
-------------Round number:  34  -------------
selected users: [97, 149, 27, 60, 138, 55, 10, 32, 86, 67, 12, 78, 7, 82, 33]
Current data/feature buff: torch.Size([71, 128, 20, 7]) torch.Size([71]) 71
Buffer classes: Counter({5: 25, 1: 14, 4: 11, 2: 11, 0: 6, 3: 4})
Local adapation with distilling: 0.000388 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7985) local CE: tensor(0.3979) Feature CE: tensor(1.3881) KL: tensor(0.1538)
The last decorrelation: tensor(0.8504)
Local adapation with distilling: 0.000388 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1222) local CE: tensor(0.8107) Feature CE: tensor(1.2776) KL: tensor(0.1392)
The last decorrelation: tensor(0.8953)
Local adapation with distilling: 0.000388 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9649) local CE: tensor(0.6115) Feature CE: tensor(1.3518) KL: tensor(0.1572)
The last decorrelation: tensor(0.8350)
Local adapation with distilling: 0.000388 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0374) local CE: tensor(0.0768) Feature CE: tensor(0.8823) KL: tensor(0.1337)
The last decorrelation: tensor(0.9481)
Local adapation with distilling: 0.000388 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1748) local CE: tensor(0.7316) Feature CE: tensor(1.3083) KL: tensor(0.1552)
The last decorrelation: tensor(0.9799)
Local adapation with distilling: 0.000388 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9373) local CE: tensor(0.6740) Feature CE: tensor(1.1810) KL: tensor(0.1548)
The last decorrelation: tensor(0.9263)
Local adapation with distilling: 0.000388 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9929) local CE: tensor(0.7283) Feature CE: tensor(1.1657) KL: tensor(0.1173)
The last decorrelation: tensor(0.9848)
Local adapation with distilling: 0.000388 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4374) local CE: tensor(0.2384) Feature CE: tensor(1.1286) KL: tensor(0.1241)
The last decorrelation: tensor(0.9531)
Local adapation with distilling: 0.000388 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1262) local CE: tensor(0.8013) Feature CE: tensor(1.1432) KL: tensor(0.2133)
The last decorrelation: tensor(0.9609)
Local adapation with distilling: 0.000388 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5707) local CE: tensor(0.2586) Feature CE: tensor(1.3075) KL: tensor(0.1302)
The last decorrelation: tensor(0.8741)
Local adapation with distilling: 0.000388 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2851) local CE: tensor(0.1821) Feature CE: tensor(1.1308) KL: tensor(0.0841)
The last decorrelation: tensor(0.8894)
Local adapation with distilling: 0.000388 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1016) local CE: tensor(0.1828) Feature CE: tensor(0.8403) KL: tensor(0.0788)
The last decorrelation: tensor(0.9997)
Local adapation with distilling: 0.000388 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.8281) local CE: tensor(1.1006) Feature CE: tensor(1.5380) KL: tensor(0.1986)
The last decorrelation: tensor(0.9906)
Local adapation with distilling: 0.000388 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(4.1398) local CE: tensor(1.3833) Feature CE: tensor(1.6569) KL: tensor(0.1646)
The last decorrelation: tensor(0.9365)
Local adapation with distilling: 0.000388 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5099) local CE: tensor(0.7852) Feature CE: tensor(1.4963) KL: tensor(0.2830)
The last decorrelation: tensor(0.9378)
Global Model Acc on global data: 0.5259586019681032 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  35  -------------
selected users: [95, 61, 128, 72, 40, 104, 146, 64, 78, 49, 84, 144, 17, 120, 25]
Current data/feature buff: torch.Size([69, 128, 20, 7]) torch.Size([69]) 69
Buffer classes: Counter({5: 23, 4: 13, 0: 12, 1: 12, 2: 6, 3: 3})
Local adapation with distilling: 0.00037 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8855) local CE: tensor(0.4893) Feature CE: tensor(1.3925) KL: tensor(0.1262)
The last decorrelation: tensor(0.8780)
Local adapation with distilling: 0.00037 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5472) local CE: tensor(0.2844) Feature CE: tensor(1.2856) KL: tensor(0.1161)
The last decorrelation: tensor(0.8560)
Local adapation with distilling: 0.00037 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6510) local CE: tensor(0.3570) Feature CE: tensor(1.2521) KL: tensor(0.1378)
The last decorrelation: tensor(0.9007)
Local adapation with distilling: 0.00037 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4972) local CE: tensor(0.9076) Feature CE: tensor(1.3655) KL: tensor(0.3095)
The last decorrelation: tensor(0.9145)
Local adapation with distilling: 0.00037 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7845) local CE: tensor(0.5304) Feature CE: tensor(1.2060) KL: tensor(0.1226)
The last decorrelation: tensor(0.9252)
Local adapation with distilling: 0.00037 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.7157) local CE: tensor(0.8211) Feature CE: tensor(1.7390) KL: tensor(0.1555)
The last decorrelation: tensor(1.0000)
Local adapation with distilling: 0.00037 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3674) local CE: tensor(0.7851) Feature CE: tensor(1.4020) KL: tensor(0.2565)
The last decorrelation: tensor(0.9236)
Local adapation with distilling: 0.00037 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3517) local CE: tensor(0.1782) Feature CE: tensor(1.2178) KL: tensor(0.0917)
The last decorrelation: tensor(0.8644)
Local adapation with distilling: 0.00037 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2181) local CE: tensor(0.2049) Feature CE: tensor(0.9082) KL: tensor(0.1054)
The last decorrelation: tensor(0.9996)
Local adapation with distilling: 0.00037 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9675) local CE: tensor(0.4656) Feature CE: tensor(1.4198) KL: tensor(0.1128)
The last decorrelation: tensor(0.9695)
Local adapation with distilling: 0.00037 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7874) local CE: tensor(0.5148) Feature CE: tensor(1.2849) KL: tensor(0.0892)
The last decorrelation: tensor(0.9008)
Local adapation with distilling: 0.00037 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2152) local CE: tensor(0.7521) Feature CE: tensor(1.3727) KL: tensor(0.1059)
The last decorrelation: tensor(0.9847)
Local adapation with distilling: 0.00037 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.6805) local CE: tensor(1.0253) Feature CE: tensor(1.5799) KL: tensor(0.1139)
The last decorrelation: tensor(0.9612)
Local adapation with distilling: 0.00037 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.9010) local CE: tensor(1.2212) Feature CE: tensor(1.6261) KL: tensor(0.1252)
The last decorrelation: tensor(0.9288)
Local adapation with distilling: 0.00037 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.6810) local CE: tensor(0.9534) Feature CE: tensor(1.5757) KL: tensor(0.1522)
The last decorrelation: tensor(0.9997)
Global Model Acc on global data: 0.496097726501527 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  36  -------------
selected users: [50, 145, 86, 118, 122, 57, 56, 51, 69, 66, 59, 4, 110, 94, 29]
Current data/feature buff: torch.Size([33, 128, 20, 7]) torch.Size([33]) 33
Buffer classes: Counter({1: 15, 2: 11, 3: 4, 0: 2, 4: 1})
Local adapation with distilling: 0.0003520000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2513) local CE: tensor(0.3918) Feature CE: tensor(1.5926) KL: tensor(0.3080)
The last decorrelation: tensor(0.9588)
Local adapation with distilling: 0.0003520000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1386) local CE: tensor(0.3242) Feature CE: tensor(1.4973) KL: tensor(0.4525)
The last decorrelation: tensor(0.8743)
Local adapation with distilling: 0.0003520000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0697) local CE: tensor(0.2481) Feature CE: tensor(1.5446) KL: tensor(0.3106)
The last decorrelation: tensor(0.9635)
Local adapation with distilling: 0.0003520000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2462) local CE: tensor(0.6018) Feature CE: tensor(1.2838) KL: tensor(0.3966)
The last decorrelation: tensor(0.9828)
Local adapation with distilling: 0.0003520000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3565) local CE: tensor(0.5569) Feature CE: tensor(1.5331) KL: tensor(0.3610)
The last decorrelation: tensor(0.9103)
Local adapation with distilling: 0.0003520000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9567) local CE: tensor(0.4015) Feature CE: tensor(1.2981) KL: tensor(0.3580)
The last decorrelation: tensor(0.8956)
Local adapation with distilling: 0.0003520000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.7088) local CE: tensor(0.5460) Feature CE: tensor(1.9352) KL: tensor(0.3142)
The last decorrelation: tensor(0.9132)
Local adapation with distilling: 0.0003520000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1615) local CE: tensor(0.3069) Feature CE: tensor(1.6730) KL: tensor(0.2902)
The last decorrelation: tensor(0.8923)
Local adapation with distilling: 0.0003520000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6284) local CE: tensor(0.2610) Feature CE: tensor(1.1661) KL: tensor(0.2479)
The last decorrelation: tensor(0.9539)
Local adapation with distilling: 0.0003520000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8235) local CE: tensor(0.4929) Feature CE: tensor(1.1414) KL: tensor(0.3377)
The last decorrelation: tensor(0.8441)
Local adapation with distilling: 0.0003520000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.9268) local CE: tensor(0.8039) Feature CE: tensor(1.9267) KL: tensor(0.2075)
The last decorrelation: tensor(0.9860)
Local adapation with distilling: 0.0003520000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7013) local CE: tensor(0.3382) Feature CE: tensor(1.1725) KL: tensor(0.3036)
The last decorrelation: tensor(0.8843)
Local adapation with distilling: 0.0003520000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0118) local CE: tensor(0.4976) Feature CE: tensor(1.1273) KL: tensor(0.4714)
The last decorrelation: tensor(0.9086)
Local adapation with distilling: 0.0003520000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2048) local CE: tensor(0.6695) Feature CE: tensor(1.2358) KL: tensor(0.3649)
The last decorrelation: tensor(0.9354)
Local adapation with distilling: 0.0003520000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7330) local CE: tensor(0.1711) Feature CE: tensor(1.4339) KL: tensor(0.2298)
The last decorrelation: tensor(0.9011)
Global Model Acc on global data: 0.5459789616559213 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  37  -------------
selected users: [74, 27, 104, 142, 6, 94, 2, 113, 120, 138, 5, 149, 140, 48, 13]
Current data/feature buff: torch.Size([69, 128, 20, 7]) torch.Size([69]) 69
Buffer classes: Counter({4: 18, 3: 16, 5: 14, 0: 12, 1: 7, 2: 2})
Local adapation with distilling: 0.0003340000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7024) local CE: tensor(0.3265) Feature CE: tensor(1.4339) KL: tensor(0.0733)
The last decorrelation: tensor(0.8535)
Local adapation with distilling: 0.0003340000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7340) local CE: tensor(0.3241) Feature CE: tensor(1.4602) KL: tensor(0.1120)
The last decorrelation: tensor(0.8372)
Local adapation with distilling: 0.0003340000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(4.2554) local CE: tensor(0.8812) Feature CE: tensor(2.0646) KL: tensor(0.3096)
The last decorrelation: tensor(1.0000)
Local adapation with distilling: 0.0003340000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6872) local CE: tensor(0.2887) Feature CE: tensor(1.4224) KL: tensor(0.1053)
The last decorrelation: tensor(0.8717)
Local adapation with distilling: 0.0003340000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4330) local CE: tensor(0.2427) Feature CE: tensor(1.1597) KL: tensor(0.0987)
The last decorrelation: tensor(0.9320)
Local adapation with distilling: 0.0003340000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5598) local CE: tensor(0.6626) Feature CE: tensor(1.6723) KL: tensor(0.2909)
The last decorrelation: tensor(0.9340)
Local adapation with distilling: 0.0003340000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6636) local CE: tensor(0.2471) Feature CE: tensor(1.4231) KL: tensor(0.0930)
The last decorrelation: tensor(0.9018)
Local adapation with distilling: 0.0003340000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8309) local CE: tensor(0.5312) Feature CE: tensor(1.1206) KL: tensor(0.2058)
The last decorrelation: tensor(0.9811)
Local adapation with distilling: 0.0003340000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3938) local CE: tensor(1.0244) Feature CE: tensor(1.2595) KL: tensor(0.1818)
The last decorrelation: tensor(0.9279)
Local adapation with distilling: 0.0003340000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1056) local CE: tensor(0.7065) Feature CE: tensor(1.3269) KL: tensor(0.0923)
The last decorrelation: tensor(0.9801)
Local adapation with distilling: 0.0003340000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6818) local CE: tensor(0.4349) Feature CE: tensor(1.1500) KL: tensor(0.1782)
The last decorrelation: tensor(0.9182)
Local adapation with distilling: 0.0003340000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3150) local CE: tensor(0.7871) Feature CE: tensor(1.4515) KL: tensor(0.1839)
The last decorrelation: tensor(0.8931)
Local adapation with distilling: 0.0003340000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2458) local CE: tensor(0.8321) Feature CE: tensor(1.2377) KL: tensor(0.2150)
The last decorrelation: tensor(0.9608)
Local adapation with distilling: 0.0003340000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0544) local CE: tensor(0.3257) Feature CE: tensor(1.5910) KL: tensor(0.2020)
The last decorrelation: tensor(0.9363)
Local adapation with distilling: 0.0003340000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7539) local CE: tensor(0.4890) Feature CE: tensor(1.2146) KL: tensor(0.0619)
The last decorrelation: tensor(0.9883)
Global Model Acc on global data: 0.4750593824228028 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  38  -------------
selected users: [48, 113, 111, 44, 121, 58, 80, 109, 63, 103, 16, 135, 54, 56, 72]
Current data/feature buff: torch.Size([48, 128, 20, 7]) torch.Size([48]) 48
Buffer classes: Counter({2: 12, 3: 11, 0: 10, 1: 8, 4: 7})
Local adapation with distilling: 0.0003160000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4210) local CE: tensor(0.2042) Feature CE: tensor(1.2004) KL: tensor(0.0831)
The last decorrelation: tensor(0.9325)
Local adapation with distilling: 0.0003160000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6220) local CE: tensor(0.3285) Feature CE: tensor(1.1069) KL: tensor(0.2272)
The last decorrelation: tensor(0.9566)
Local adapation with distilling: 0.0003160000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0663) local CE: tensor(0.7110) Feature CE: tensor(1.2199) KL: tensor(0.1399)
The last decorrelation: tensor(0.9955)
Local adapation with distilling: 0.0003160000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7927) local CE: tensor(0.3688) Feature CE: tensor(1.3516) KL: tensor(0.0887)
The last decorrelation: tensor(0.9612)
Local adapation with distilling: 0.0003160000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5866) local CE: tensor(0.3676) Feature CE: tensor(1.1178) KL: tensor(0.1528)
The last decorrelation: tensor(0.9481)
Local adapation with distilling: 0.0003160000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2014) local CE: tensor(0.7897) Feature CE: tensor(1.3433) KL: tensor(0.1591)
The last decorrelation: tensor(0.9093)
Local adapation with distilling: 0.0003160000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8676) local CE: tensor(0.4701) Feature CE: tensor(1.3303) KL: tensor(0.1781)
The last decorrelation: tensor(0.8851)
Local adapation with distilling: 0.0003160000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2986) local CE: tensor(0.1953) Feature CE: tensor(1.1072) KL: tensor(0.1190)
The last decorrelation: tensor(0.8758)
Local adapation with distilling: 0.0003160000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9343) local CE: tensor(0.4043) Feature CE: tensor(1.3024) KL: tensor(0.3254)
The last decorrelation: tensor(0.9006)
Local adapation with distilling: 0.0003160000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2199) local CE: tensor(0.2031) Feature CE: tensor(1.0447) KL: tensor(0.1352)
The last decorrelation: tensor(0.8367)
Local adapation with distilling: 0.0003160000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6027) local CE: tensor(0.3036) Feature CE: tensor(1.2159) KL: tensor(0.1124)
The last decorrelation: tensor(0.9776)
Local adapation with distilling: 0.0003160000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7242) local CE: tensor(0.4041) Feature CE: tensor(1.2325) KL: tensor(0.1637)
The last decorrelation: tensor(0.9238)
Local adapation with distilling: 0.0003160000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0441) local CE: tensor(0.6437) Feature CE: tensor(1.2557) KL: tensor(0.2125)
The last decorrelation: tensor(0.9325)
Local adapation with distilling: 0.0003160000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8430) local CE: tensor(0.4623) Feature CE: tensor(1.3796) KL: tensor(0.0904)
The last decorrelation: tensor(0.9148)
Local adapation with distilling: 0.0003160000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1453) local CE: tensor(0.6813) Feature CE: tensor(1.3453) KL: tensor(0.2056)
The last decorrelation: tensor(0.9130)
Global Model Acc on global data: 0.5585341024770953 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  39  -------------
selected users: [6, 34, 148, 82, 38, 26, 128, 29, 143, 131, 55, 21, 139, 57, 58]
Current data/feature buff: torch.Size([68, 128, 20, 7]) torch.Size([68]) 68
Buffer classes: Counter({2: 21, 1: 15, 5: 14, 3: 13, 4: 3, 0: 2})
Local adapation with distilling: 0.00029800000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7510) local CE: tensor(0.3296) Feature CE: tensor(1.2874) KL: tensor(0.2043)
The last decorrelation: tensor(0.9294)
Local adapation with distilling: 0.00029800000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4748) local CE: tensor(0.5002) Feature CE: tensor(1.4209) KL: tensor(0.5570)
The last decorrelation: tensor(0.9962)
Local adapation with distilling: 0.00029800000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8736) local CE: tensor(0.4811) Feature CE: tensor(1.3326) KL: tensor(0.1579)
The last decorrelation: tensor(0.9236)
Local adapation with distilling: 0.00029800000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1127) local CE: tensor(0.7775) Feature CE: tensor(1.2737) KL: tensor(0.1337)
The last decorrelation: tensor(0.9285)
Local adapation with distilling: 0.00029800000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4987) local CE: tensor(0.2762) Feature CE: tensor(1.2560) KL: tensor(0.1063)
The last decorrelation: tensor(0.8490)
Local adapation with distilling: 0.00029800000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2891) local CE: tensor(0.3255) Feature CE: tensor(1.0644) KL: tensor(0.0917)
The last decorrelation: tensor(0.8042)
Local adapation with distilling: 0.00029800000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6995) local CE: tensor(0.3602) Feature CE: tensor(1.2874) KL: tensor(0.1563)
The last decorrelation: tensor(0.8979)
Local adapation with distilling: 0.00029800000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4887) local CE: tensor(0.2197) Feature CE: tensor(1.2359) KL: tensor(0.1315)
The last decorrelation: tensor(0.9010)
Local adapation with distilling: 0.00029800000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6036) local CE: tensor(0.3677) Feature CE: tensor(1.1450) KL: tensor(0.2127)
The last decorrelation: tensor(0.8768)
Local adapation with distilling: 0.00029800000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6246) local CE: tensor(0.4131) Feature CE: tensor(1.1304) KL: tensor(0.1328)
The last decorrelation: tensor(0.9485)
Local adapation with distilling: 0.00029800000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0640) local CE: tensor(0.6740) Feature CE: tensor(1.2885) KL: tensor(0.1700)
The last decorrelation: tensor(0.9406)
Local adapation with distilling: 0.00029800000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4379) local CE: tensor(0.9038) Feature CE: tensor(1.3683) KL: tensor(0.1831)
The last decorrelation: tensor(0.9827)
Local adapation with distilling: 0.00029800000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8053) local CE: tensor(0.5031) Feature CE: tensor(1.2209) KL: tensor(0.1266)
The last decorrelation: tensor(0.9544)
Local adapation with distilling: 0.00029800000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5673) local CE: tensor(0.2498) Feature CE: tensor(1.3058) KL: tensor(0.1172)
The last decorrelation: tensor(0.8901)
Local adapation with distilling: 0.00029800000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1644) local CE: tensor(0.7279) Feature CE: tensor(1.4197) KL: tensor(0.1081)
The last decorrelation: tensor(0.9090)
Global Model Acc on global data: 0.5673566338649474 length of data: 2947
save a model
size of the global feature buffer: 15
-------------Round number:  40  -------------
selected users: [38, 66, 115, 117, 89, 136, 68, 94, 84, 28, 90, 11, 40, 126, 79]
Current data/feature buff: torch.Size([57, 128, 20, 7]) torch.Size([57]) 57
Buffer classes: Counter({1: 18, 4: 15, 0: 11, 5: 8, 2: 3, 3: 2})
Local adapation with distilling: 0.00028000000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4509) local CE: tensor(0.3357) Feature CE: tensor(1.1144) KL: tensor(0.1462)
The last decorrelation: tensor(0.8562)
Local adapation with distilling: 0.00028000000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6545) local CE: tensor(0.4544) Feature CE: tensor(1.2427) KL: tensor(0.1094)
The last decorrelation: tensor(0.8497)
Local adapation with distilling: 0.00028000000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1945) local CE: tensor(0.1209) Feature CE: tensor(1.0316) KL: tensor(0.0975)
The last decorrelation: tensor(0.9370)
Local adapation with distilling: 0.00028000000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0874) local CE: tensor(0.7755) Feature CE: tensor(1.2626) KL: tensor(0.1100)
The last decorrelation: tensor(0.9467)
Local adapation with distilling: 0.00028000000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2682) local CE: tensor(0.8842) Feature CE: tensor(1.3530) KL: tensor(0.0961)
The last decorrelation: tensor(0.9349)
Local adapation with distilling: 0.00028000000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1648) local CE: tensor(0.7785) Feature CE: tensor(1.2409) KL: tensor(0.2015)
The last decorrelation: tensor(0.9477)
Local adapation with distilling: 0.00028000000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4584) local CE: tensor(0.2372) Feature CE: tensor(1.1503) KL: tensor(0.0720)
The last decorrelation: tensor(0.9990)
Local adapation with distilling: 0.00028000000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1358) local CE: tensor(0.5845) Feature CE: tensor(1.4393) KL: tensor(0.1827)
The last decorrelation: tensor(0.9295)
Local adapation with distilling: 0.00028000000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5282) local CE: tensor(0.4795) Feature CE: tensor(1.0869) KL: tensor(0.0738)
The last decorrelation: tensor(0.8895)
Local adapation with distilling: 0.00028000000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2784) local CE: tensor(0.8292) Feature CE: tensor(1.3465) KL: tensor(0.1360)
The last decorrelation: tensor(0.9852)
Local adapation with distilling: 0.00028000000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1085) local CE: tensor(0.4566) Feature CE: tensor(1.3847) KL: tensor(0.3117)
The last decorrelation: tensor(0.9529)
Local adapation with distilling: 0.00028000000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4729) local CE: tensor(0.9926) Feature CE: tensor(1.4039) KL: tensor(0.1347)
The last decorrelation: tensor(0.9417)
Local adapation with distilling: 0.00028000000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6322) local CE: tensor(0.3607) Feature CE: tensor(1.1691) KL: tensor(0.1826)
The last decorrelation: tensor(0.9198)
Local adapation with distilling: 0.00028000000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9103) local CE: tensor(0.4284) Feature CE: tensor(1.2674) KL: tensor(0.2601)
The last decorrelation: tensor(0.9546)
Local adapation with distilling: 0.00028000000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6776) local CE: tensor(0.4912) Feature CE: tensor(1.2409) KL: tensor(0.1024)
The last decorrelation: tensor(0.8444)
Global Model Acc on global data: 0.5666779776043434 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  41  -------------
selected users: [119, 128, 135, 91, 112, 71, 123, 85, 147, 143, 127, 39, 38, 93, 23]
Current data/feature buff: torch.Size([57, 128, 20, 7]) torch.Size([57]) 57
Buffer classes: Counter({4: 25, 0: 10, 3: 10, 2: 6, 5: 5, 1: 1})
Local adapation with distilling: 0.000262 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9269) local CE: tensor(0.0905) Feature CE: tensor(0.8180) KL: tensor(0.0647)
The last decorrelation: tensor(0.9558)
Local adapation with distilling: 0.000262 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6340) local CE: tensor(0.2630) Feature CE: tensor(1.4230) KL: tensor(0.0559)
The last decorrelation: tensor(0.8945)
Local adapation with distilling: 0.000262 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9634) local CE: tensor(0.4907) Feature CE: tensor(1.4028) KL: tensor(0.1506)
The last decorrelation: tensor(0.9193)
Local adapation with distilling: 0.000262 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1628) local CE: tensor(0.8067) Feature CE: tensor(1.2514) KL: tensor(0.1524)
The last decorrelation: tensor(0.9524)
Local adapation with distilling: 0.000262 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5312) local CE: tensor(0.3215) Feature CE: tensor(1.1794) KL: tensor(0.1012)
The last decorrelation: tensor(0.9290)
Local adapation with distilling: 0.000262 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5498) local CE: tensor(0.2864) Feature CE: tensor(1.2778) KL: tensor(0.0679)
The last decorrelation: tensor(0.9177)
Local adapation with distilling: 0.000262 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3554) local CE: tensor(0.3684) Feature CE: tensor(1.0473) KL: tensor(0.0804)
The last decorrelation: tensor(0.8591)
Local adapation with distilling: 0.000262 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9657) local CE: tensor(0.5849) Feature CE: tensor(1.2888) KL: tensor(0.1436)
The last decorrelation: tensor(0.9485)
Local adapation with distilling: 0.000262 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7296) local CE: tensor(0.3468) Feature CE: tensor(1.3792) KL: tensor(0.0443)
The last decorrelation: tensor(0.9595)
Local adapation with distilling: 0.000262 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7423) local CE: tensor(0.3433) Feature CE: tensor(1.3841) KL: tensor(0.1443)
The last decorrelation: tensor(0.8737)
Local adapation with distilling: 0.000262 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1764) local CE: tensor(0.8616) Feature CE: tensor(1.2369) KL: tensor(0.1173)
The last decorrelation: tensor(0.9322)
Local adapation with distilling: 0.000262 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4073) local CE: tensor(0.1561) Feature CE: tensor(1.2094) KL: tensor(0.0793)
The last decorrelation: tensor(0.9627)
Local adapation with distilling: 0.000262 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3080) local CE: tensor(0.2478) Feature CE: tensor(1.1551) KL: tensor(0.0509)
The last decorrelation: tensor(0.8545)
Local adapation with distilling: 0.000262 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3278) local CE: tensor(0.1856) Feature CE: tensor(1.0474) KL: tensor(0.0968)
The last decorrelation: tensor(0.9980)
Local adapation with distilling: 0.000262 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3564) local CE: tensor(0.7762) Feature CE: tensor(1.3206) KL: tensor(0.2606)
The last decorrelation: tensor(0.9991)
Global Model Acc on global data: 0.4655581947743468 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  42  -------------
selected users: [73, 18, 118, 78, 76, 31, 64, 141, 68, 82, 110, 12, 36, 9, 19]
Current data/feature buff: torch.Size([70, 128, 20, 7]) torch.Size([70]) 70
Buffer classes: Counter({4: 33, 1: 16, 0: 9, 5: 5, 3: 5, 2: 2})
Local adapation with distilling: 0.0002440000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6084) local CE: tensor(0.3841) Feature CE: tensor(1.3363) KL: tensor(0.0396)
The last decorrelation: tensor(0.8494)
Local adapation with distilling: 0.0002440000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9880) local CE: tensor(0.0669) Feature CE: tensor(0.8787) KL: tensor(0.0978)
The last decorrelation: tensor(0.9444)
Local adapation with distilling: 0.0002440000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5758) local CE: tensor(0.3985) Feature CE: tensor(1.1278) KL: tensor(0.1013)
The last decorrelation: tensor(0.9395)
Local adapation with distilling: 0.0002440000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.6078) local CE: tensor(0.9765) Feature CE: tensor(1.4668) KL: tensor(0.1648)
The last decorrelation: tensor(0.9997)
Local adapation with distilling: 0.0002440000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2979) local CE: tensor(0.1425) Feature CE: tensor(1.0847) KL: tensor(0.1091)
The last decorrelation: tensor(0.9667)
Local adapation with distilling: 0.0002440000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1344) local CE: tensor(0.1321) Feature CE: tensor(1.0714) KL: tensor(0.0469)
The last decorrelation: tensor(0.8843)
Local adapation with distilling: 0.0002440000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4116) local CE: tensor(0.3178) Feature CE: tensor(1.1442) KL: tensor(0.0979)
The last decorrelation: tensor(0.8465)
Local adapation with distilling: 0.0002440000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2767) local CE: tensor(0.7283) Feature CE: tensor(1.5832) KL: tensor(0.0653)
The last decorrelation: tensor(0.9002)
Local adapation with distilling: 0.0002440000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8466) local CE: tensor(0.5196) Feature CE: tensor(1.2290) KL: tensor(0.0990)
The last decorrelation: tensor(0.9989)
Local adapation with distilling: 0.0002440000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1835) local CE: tensor(0.8347) Feature CE: tensor(1.3789) KL: tensor(0.0426)
The last decorrelation: tensor(0.9279)
Local adapation with distilling: 0.0002440000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1220) local CE: tensor(0.6706) Feature CE: tensor(1.2926) KL: tensor(0.2414)
The last decorrelation: tensor(0.9259)
Local adapation with distilling: 0.0002440000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3923) local CE: tensor(0.2506) Feature CE: tensor(1.1912) KL: tensor(0.0738)
The last decorrelation: tensor(0.8706)
Local adapation with distilling: 0.0002440000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1101) local CE: tensor(0.6723) Feature CE: tensor(1.4425) KL: tensor(0.0938)
The last decorrelation: tensor(0.8882)
Local adapation with distilling: 0.0002440000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2888) local CE: tensor(0.8429) Feature CE: tensor(1.3207) KL: tensor(0.2342)
The last decorrelation: tensor(0.8904)
Local adapation with distilling: 0.0002440000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3783) local CE: tensor(0.2489) Feature CE: tensor(1.0775) KL: tensor(0.0959)
The last decorrelation: tensor(0.9615)
Global Model Acc on global data: 0.5283338988802172 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  43  -------------
selected users: [30, 0, 138, 67, 105, 39, 113, 71, 81, 57, 38, 76, 122, 11, 78]
Current data/feature buff: torch.Size([107, 128, 20, 7]) torch.Size([107]) 107
Buffer classes: Counter({5: 29, 3: 28, 1: 16, 0: 13, 4: 11, 2: 10})
Local adapation with distilling: 0.0002260000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7859) local CE: tensor(0.3338) Feature CE: tensor(1.4512) KL: tensor(0.1247)
The last decorrelation: tensor(0.8663)
Local adapation with distilling: 0.0002260000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1280) local CE: tensor(0.6924) Feature CE: tensor(1.3286) KL: tensor(0.1280)
The last decorrelation: tensor(0.9790)
Local adapation with distilling: 0.0002260000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8197) local CE: tensor(0.5846) Feature CE: tensor(1.1676) KL: tensor(0.0874)
The last decorrelation: tensor(0.9802)
Local adapation with distilling: 0.0002260000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5120) local CE: tensor(0.1902) Feature CE: tensor(1.3669) KL: tensor(0.0869)
The last decorrelation: tensor(0.8682)
Local adapation with distilling: 0.0002260000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4142) local CE: tensor(0.5753) Feature CE: tensor(1.5915) KL: tensor(0.2635)
The last decorrelation: tensor(0.9841)
Local adapation with distilling: 0.0002260000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7265) local CE: tensor(0.1763) Feature CE: tensor(1.4117) KL: tensor(0.1760)
The last decorrelation: tensor(0.9628)
Local adapation with distilling: 0.0002260000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7585) local CE: tensor(0.4011) Feature CE: tensor(1.2191) KL: tensor(0.1720)
The last decorrelation: tensor(0.9693)
Local adapation with distilling: 0.0002260000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6206) local CE: tensor(0.2017) Feature CE: tensor(1.3598) KL: tensor(0.1394)
The last decorrelation: tensor(0.9189)
Local adapation with distilling: 0.0002260000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8443) local CE: tensor(0.4818) Feature CE: tensor(1.4142) KL: tensor(0.0851)
The last decorrelation: tensor(0.8595)
Local adapation with distilling: 0.0002260000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5590) local CE: tensor(0.2649) Feature CE: tensor(1.3144) KL: tensor(0.0866)
The last decorrelation: tensor(0.8865)
Local adapation with distilling: 0.0002260000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6001) local CE: tensor(0.3241) Feature CE: tensor(1.3088) KL: tensor(0.1108)
The last decorrelation: tensor(0.8575)
Local adapation with distilling: 0.0002260000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1507) local CE: tensor(0.0806) Feature CE: tensor(1.0254) KL: tensor(0.0888)
The last decorrelation: tensor(0.9450)
Local adapation with distilling: 0.0002260000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1885) local CE: tensor(0.4690) Feature CE: tensor(1.5917) KL: tensor(0.2296)
The last decorrelation: tensor(0.8878)
Local adapation with distilling: 0.0002260000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3688) local CE: tensor(0.9018) Feature CE: tensor(1.4088) KL: tensor(0.1158)
The last decorrelation: tensor(0.9423)
Local adapation with distilling: 0.0002260000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7883) local CE: tensor(0.4994) Feature CE: tensor(1.1769) KL: tensor(0.1123)
The last decorrelation: tensor(0.9996)
Global Model Acc on global data: 0.5419070240922973 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  44  -------------
selected users: [144, 9, 79, 95, 104, 47, 118, 107, 102, 90, 17, 52, 46, 101, 28]
Current data/feature buff: torch.Size([67, 128, 20, 7]) torch.Size([67]) 67
Buffer classes: Counter({5: 31, 0: 14, 3: 11, 1: 9, 4: 2})
Local adapation with distilling: 0.00020800000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(4.0895) local CE: tensor(1.4902) Feature CE: tensor(1.5224) KL: tensor(0.0960)
The last decorrelation: tensor(0.9810)
Local adapation with distilling: 0.00020800000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7864) local CE: tensor(0.5525) Feature CE: tensor(1.0081) KL: tensor(0.3328)
The last decorrelation: tensor(0.8934)
Local adapation with distilling: 0.00020800000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9386) local CE: tensor(0.6245) Feature CE: tensor(1.2942) KL: tensor(0.1755)
The last decorrelation: tensor(0.8458)
Local adapation with distilling: 0.00020800000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.8082) local CE: tensor(1.0217) Feature CE: tensor(1.7850) KL: tensor(0.1308)
The last decorrelation: tensor(0.8706)
Local adapation with distilling: 0.00020800000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2110) local CE: tensor(0.7749) Feature CE: tensor(1.2769) KL: tensor(0.1593)
The last decorrelation: tensor(1.0000)
Local adapation with distilling: 0.00020800000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0413) local CE: tensor(0.2095) Feature CE: tensor(0.7420) KL: tensor(0.1059)
The last decorrelation: tensor(0.9856)
Local adapation with distilling: 0.00020800000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6770) local CE: tensor(0.4432) Feature CE: tensor(1.0883) KL: tensor(0.2000)
The last decorrelation: tensor(0.9704)
Local adapation with distilling: 0.00020800000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.8561) local CE: tensor(0.1746) Feature CE: tensor(0.7071) KL: tensor(0.1037)
The last decorrelation: tensor(0.8701)
Local adapation with distilling: 0.00020800000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4147) local CE: tensor(0.2655) Feature CE: tensor(1.0461) KL: tensor(0.1438)
The last decorrelation: tensor(0.9509)
Local adapation with distilling: 0.00020800000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9216) local CE: tensor(0.4361) Feature CE: tensor(1.1773) KL: tensor(0.3530)
The last decorrelation: tensor(0.9536)
Local adapation with distilling: 0.00020800000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9254) local CE: tensor(0.8506) Feature CE: tensor(1.0108) KL: tensor(0.1035)
The last decorrelation: tensor(0.9599)
Local adapation with distilling: 0.00020800000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1387) local CE: tensor(0.1320) Feature CE: tensor(1.0496) KL: tensor(0.0842)
The last decorrelation: tensor(0.8725)
Local adapation with distilling: 0.00020800000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2242) local CE: tensor(0.8658) Feature CE: tensor(1.2988) KL: tensor(0.1514)
The last decorrelation: tensor(0.9082)
Local adapation with distilling: 0.00020800000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9557) local CE: tensor(0.6364) Feature CE: tensor(1.3368) KL: tensor(0.1026)
The last decorrelation: tensor(0.8792)
Local adapation with distilling: 0.00020800000000000007 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0679) local CE: tensor(0.8592) Feature CE: tensor(1.1402) KL: tensor(0.1131)
The last decorrelation: tensor(0.9452)
Global Model Acc on global data: 0.5571767899558874 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  45  -------------
selected users: [0, 43, 129, 3, 34, 44, 38, 105, 123, 140, 28, 125, 113, 103, 133]
Current data/feature buff: torch.Size([67, 128, 20, 7]) torch.Size([67]) 67
Buffer classes: Counter({3: 31, 1: 13, 0: 9, 2: 6, 5: 6, 4: 2})
Local adapation with distilling: 0.00019000000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4781) local CE: tensor(0.4974) Feature CE: tensor(0.9311) KL: tensor(0.0706)
The last decorrelation: tensor(0.9789)
Local adapation with distilling: 0.00019000000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7781) local CE: tensor(0.5459) Feature CE: tensor(1.2109) KL: tensor(0.1223)
The last decorrelation: tensor(0.8991)
Local adapation with distilling: 0.00019000000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7538) local CE: tensor(0.3834) Feature CE: tensor(1.3048) KL: tensor(0.1786)
The last decorrelation: tensor(0.8863)
Local adapation with distilling: 0.00019000000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5064) local CE: tensor(0.3115) Feature CE: tensor(0.9603) KL: tensor(0.2516)
The last decorrelation: tensor(0.9829)
Local adapation with distilling: 0.00019000000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6212) local CE: tensor(0.4399) Feature CE: tensor(1.0238) KL: tensor(0.1605)
The last decorrelation: tensor(0.9970)
Local adapation with distilling: 0.00019000000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6254) local CE: tensor(0.3410) Feature CE: tensor(1.2197) KL: tensor(0.0780)
The last decorrelation: tensor(0.9922)
Local adapation with distilling: 0.00019000000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3660) local CE: tensor(0.2167) Feature CE: tensor(1.2036) KL: tensor(0.0849)
The last decorrelation: tensor(0.8640)
Local adapation with distilling: 0.00019000000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9436) local CE: tensor(0.4538) Feature CE: tensor(1.3543) KL: tensor(0.1514)
The last decorrelation: tensor(0.9843)
Local adapation with distilling: 0.00019000000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0033) local CE: tensor(0.5157) Feature CE: tensor(1.4696) KL: tensor(0.1558)
The last decorrelation: tensor(0.8615)
Local adapation with distilling: 0.00019000000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3112) local CE: tensor(0.6280) Feature CE: tensor(1.5627) KL: tensor(0.1604)
The last decorrelation: tensor(0.9602)
Local adapation with distilling: 0.00019000000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9118) local CE: tensor(0.7662) Feature CE: tensor(1.0562) KL: tensor(0.1284)
The last decorrelation: tensor(0.9867)
Local adapation with distilling: 0.00019000000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6463) local CE: tensor(0.4452) Feature CE: tensor(1.1489) KL: tensor(0.0872)
The last decorrelation: tensor(0.9651)
Local adapation with distilling: 0.00019000000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4887) local CE: tensor(0.3228) Feature CE: tensor(0.9886) KL: tensor(0.2098)
The last decorrelation: tensor(0.9717)
Local adapation with distilling: 0.00019000000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5369) local CE: tensor(0.3542) Feature CE: tensor(1.2161) KL: tensor(0.1278)
The last decorrelation: tensor(0.8345)
Local adapation with distilling: 0.00019000000000000006 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8445) local CE: tensor(0.6981) Feature CE: tensor(1.0159) KL: tensor(0.1600)
The last decorrelation: tensor(0.9705)
Global Model Acc on global data: 0.5958601968103155 length of data: 2947
save a model
size of the global feature buffer: 15
-------------Round number:  46  -------------
selected users: [4, 54, 106, 8, 24, 131, 42, 94, 95, 74, 78, 135, 43, 103, 11]
Current data/feature buff: torch.Size([60, 128, 20, 7]) torch.Size([60]) 60
Buffer classes: Counter({3: 21, 2: 20, 5: 12, 0: 5, 4: 2})
Local adapation with distilling: 0.00017200000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5312) local CE: tensor(0.3254) Feature CE: tensor(1.2666) KL: tensor(0.0552)
The last decorrelation: tensor(0.8783)
Local adapation with distilling: 0.00017200000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7292) local CE: tensor(0.5661) Feature CE: tensor(1.0984) KL: tensor(0.1321)
The last decorrelation: tensor(0.9326)
Local adapation with distilling: 0.00017200000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0192) local CE: tensor(0.1899) Feature CE: tensor(0.8035) KL: tensor(0.0782)
The last decorrelation: tensor(0.9475)
Local adapation with distilling: 0.00017200000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1559) local CE: tensor(0.1960) Feature CE: tensor(0.9109) KL: tensor(0.0807)
The last decorrelation: tensor(0.9720)
Local adapation with distilling: 0.00017200000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1214) local CE: tensor(0.1904) Feature CE: tensor(0.8813) KL: tensor(0.1110)
The last decorrelation: tensor(0.9577)
Local adapation with distilling: 0.00017200000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5805) local CE: tensor(0.3639) Feature CE: tensor(1.1477) KL: tensor(0.1202)
The last decorrelation: tensor(0.9489)
Local adapation with distilling: 0.00017200000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5302) local CE: tensor(0.5096) Feature CE: tensor(1.0700) KL: tensor(0.1028)
The last decorrelation: tensor(0.8459)
Local adapation with distilling: 0.00017200000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5837) local CE: tensor(0.4616) Feature CE: tensor(1.0626) KL: tensor(0.1264)
The last decorrelation: tensor(0.9329)
Local adapation with distilling: 0.00017200000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5140) local CE: tensor(0.4123) Feature CE: tensor(1.1383) KL: tensor(0.0947)
The last decorrelation: tensor(0.8686)
Local adapation with distilling: 0.00017200000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1738) local CE: tensor(0.2849) Feature CE: tensor(0.9546) KL: tensor(0.0654)
The last decorrelation: tensor(0.8594)
Local adapation with distilling: 0.00017200000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6875) local CE: tensor(0.4919) Feature CE: tensor(1.0874) KL: tensor(0.1085)
The last decorrelation: tensor(0.9997)
Local adapation with distilling: 0.00017200000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5468) local CE: tensor(0.3731) Feature CE: tensor(1.1731) KL: tensor(0.0768)
The last decorrelation: tensor(0.9241)
Local adapation with distilling: 0.00017200000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7130) local CE: tensor(0.5314) Feature CE: tensor(1.1900) KL: tensor(0.0922)
The last decorrelation: tensor(0.8998)
Local adapation with distilling: 0.00017200000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9821) local CE: tensor(0.1947) Feature CE: tensor(0.8942) KL: tensor(0.0592)
The last decorrelation: tensor(0.8283)
Local adapation with distilling: 0.00017200000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.9381) local CE: tensor(1.4383) Feature CE: tensor(1.4500) KL: tensor(0.1075)
The last decorrelation: tensor(0.9422)
Global Model Acc on global data: 0.4221241940956905 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  47  -------------
selected users: [10, 0, 96, 5, 15, 105, 88, 120, 94, 47, 116, 3, 99, 131, 127]
Current data/feature buff: torch.Size([47, 128, 20, 7]) torch.Size([47]) 47
Buffer classes: Counter({2: 28, 3: 12, 1: 3, 0: 2, 5: 1, 4: 1})
Local adapation with distilling: 0.00015400000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8467) local CE: tensor(0.5741) Feature CE: tensor(1.2282) KL: tensor(0.0644)
The last decorrelation: tensor(0.9846)
Local adapation with distilling: 0.00015400000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4327) local CE: tensor(0.4211) Feature CE: tensor(1.0002) KL: tensor(0.0325)
The last decorrelation: tensor(0.9788)
Local adapation with distilling: 0.00015400000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8725) local CE: tensor(0.6459) Feature CE: tensor(1.1620) KL: tensor(0.1751)
The last decorrelation: tensor(0.8887)
Local adapation with distilling: 0.00015400000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(4.2759) local CE: tensor(1.3906) Feature CE: tensor(1.8150) KL: tensor(0.1525)
The last decorrelation: tensor(0.9179)
Local adapation with distilling: 0.00015400000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0605) local CE: tensor(0.1443) Feature CE: tensor(0.9048) KL: tensor(0.0650)
The last decorrelation: tensor(0.9414)
Local adapation with distilling: 0.00015400000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1653) local CE: tensor(0.2487) Feature CE: tensor(0.8561) KL: tensor(0.0759)
The last decorrelation: tensor(0.9848)
Local adapation with distilling: 0.00015400000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8821) local CE: tensor(0.6405) Feature CE: tensor(1.1725) KL: tensor(0.0985)
The last decorrelation: tensor(0.9707)
Local adapation with distilling: 0.00015400000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3824) local CE: tensor(1.0258) Feature CE: tensor(1.3216) KL: tensor(0.1058)
The last decorrelation: tensor(0.9292)
Local adapation with distilling: 0.00015400000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5930) local CE: tensor(0.4559) Feature CE: tensor(1.1025) KL: tensor(0.1018)
The last decorrelation: tensor(0.9327)
Local adapation with distilling: 0.00015400000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5615) local CE: tensor(0.3965) Feature CE: tensor(1.1306) KL: tensor(0.0536)
The last decorrelation: tensor(0.9864)
Local adapation with distilling: 0.00015400000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2325) local CE: tensor(0.9041) Feature CE: tensor(1.3041) KL: tensor(0.1025)
The last decorrelation: tensor(0.9220)
Local adapation with distilling: 0.00015400000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3867) local CE: tensor(0.2603) Feature CE: tensor(0.9593) KL: tensor(0.1837)
The last decorrelation: tensor(0.9851)
Local adapation with distilling: 0.00015400000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6611) local CE: tensor(0.4555) Feature CE: tensor(1.2165) KL: tensor(0.1020)
The last decorrelation: tensor(0.8880)
Local adapation with distilling: 0.00015400000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6295) local CE: tensor(0.3806) Feature CE: tensor(1.1950) KL: tensor(0.1056)
The last decorrelation: tensor(0.9484)
Local adapation with distilling: 0.00015400000000000003 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3382) local CE: tensor(0.9776) Feature CE: tensor(1.3132) KL: tensor(0.0994)
The last decorrelation: tensor(0.9379)
Global Model Acc on global data: 0.47234475738038684 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  48  -------------
selected users: [96, 73, 134, 41, 70, 116, 19, 138, 33, 89, 137, 36, 20, 126, 87]
Current data/feature buff: torch.Size([36, 128, 20, 7]) torch.Size([36]) 36
Buffer classes: Counter({3: 16, 5: 9, 1: 5, 4: 4, 0: 1, 2: 1})
Local adapation with distilling: 0.00013600000000000013 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8578) local CE: tensor(0.5165) Feature CE: tensor(1.3638) KL: tensor(0.0967)
The last decorrelation: tensor(0.8913)
Local adapation with distilling: 0.00013600000000000013 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6889) local CE: tensor(0.3550) Feature CE: tensor(1.4043) KL: tensor(0.0816)
The last decorrelation: tensor(0.8433)
Local adapation with distilling: 0.00013600000000000013 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3120) local CE: tensor(0.8289) Feature CE: tensor(1.4167) KL: tensor(0.1615)
The last decorrelation: tensor(0.9046)
Local adapation with distilling: 0.00013600000000000013 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3999) local CE: tensor(0.1628) Feature CE: tensor(1.3057) KL: tensor(0.0584)
The last decorrelation: tensor(0.8755)
Local adapation with distilling: 0.00013600000000000013 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3500) local CE: tensor(0.3220) Feature CE: tensor(0.9262) KL: tensor(0.1449)
The last decorrelation: tensor(0.9552)
Local adapation with distilling: 0.00013600000000000013 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2493) local CE: tensor(0.7332) Feature CE: tensor(1.4762) KL: tensor(0.1176)
The last decorrelation: tensor(0.9221)
Local adapation with distilling: 0.00013600000000000013 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9826) local CE: tensor(0.0946) Feature CE: tensor(0.8528) KL: tensor(0.0763)
The last decorrelation: tensor(0.9521)
Local adapation with distilling: 0.00013600000000000013 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(5.0277) local CE: tensor(2.0896) Feature CE: tensor(1.6928) KL: tensor(0.2655)
The last decorrelation: tensor(0.9798)
Local adapation with distilling: 0.00013600000000000013 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4970) local CE: tensor(0.3302) Feature CE: tensor(1.0967) KL: tensor(0.1122)
The last decorrelation: tensor(0.9494)
Local adapation with distilling: 0.00013600000000000013 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0698) local CE: tensor(0.8853) Feature CE: tensor(1.1683) KL: tensor(0.0798)
The last decorrelation: tensor(0.9364)
Local adapation with distilling: 0.00013600000000000013 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7119) local CE: tensor(0.5783) Feature CE: tensor(1.0624) KL: tensor(0.1264)
The last decorrelation: tensor(0.9442)
Local adapation with distilling: 0.00013600000000000013 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1579) local CE: tensor(0.6026) Feature CE: tensor(1.5628) KL: tensor(0.0979)
The last decorrelation: tensor(0.9111)
Local adapation with distilling: 0.00013600000000000013 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9758) local CE: tensor(0.7510) Feature CE: tensor(1.2056) KL: tensor(0.0640)
The last decorrelation: tensor(0.9555)
Local adapation with distilling: 0.00013600000000000013 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4668) local CE: tensor(0.7467) Feature CE: tensor(1.6550) KL: tensor(0.1090)
The last decorrelation: tensor(0.9561)
Local adapation with distilling: 0.00013600000000000013 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3267) local CE: tensor(0.3374) Feature CE: tensor(0.9180) KL: tensor(0.0995)
The last decorrelation: tensor(0.9588)
Global Model Acc on global data: 0.5877163216830675 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  49  -------------
selected users: [81, 147, 53, 125, 137, 23, 142, 104, 139, 122, 2, 62, 46, 86, 73]
Current data/feature buff: torch.Size([66, 128, 20, 7]) torch.Size([66]) 66
Buffer classes: Counter({0: 20, 3: 19, 2: 11, 1: 8, 5: 6, 4: 2})
Local adapation with distilling: 0.0001180000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3931) local CE: tensor(0.4409) Feature CE: tensor(0.9780) KL: tensor(0.1052)
The last decorrelation: tensor(0.8841)
Local adapation with distilling: 0.0001180000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1278) local CE: tensor(0.6343) Feature CE: tensor(1.3748) KL: tensor(0.1571)
The last decorrelation: tensor(0.9618)
Local adapation with distilling: 0.0001180000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.6391) local CE: tensor(1.1167) Feature CE: tensor(1.5093) KL: tensor(0.0507)
The last decorrelation: tensor(0.9459)
Local adapation with distilling: 0.0001180000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9352) local CE: tensor(0.6653) Feature CE: tensor(1.2479) KL: tensor(0.0568)
The last decorrelation: tensor(0.9654)
Local adapation with distilling: 0.0001180000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1427) local CE: tensor(0.7313) Feature CE: tensor(1.3506) KL: tensor(0.1157)
The last decorrelation: tensor(0.9439)
Local adapation with distilling: 0.0001180000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8066) local CE: tensor(0.4408) Feature CE: tensor(1.2496) KL: tensor(0.1170)
The last decorrelation: tensor(0.9992)
Local adapation with distilling: 0.0001180000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0840) local CE: tensor(0.1790) Feature CE: tensor(0.9266) KL: tensor(0.1089)
The last decorrelation: tensor(0.8695)
Local adapation with distilling: 0.0001180000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2400) local CE: tensor(0.6585) Feature CE: tensor(1.4679) KL: tensor(0.1136)
The last decorrelation: tensor(1.0000)
Local adapation with distilling: 0.0001180000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1929) local CE: tensor(0.1780) Feature CE: tensor(0.9664) KL: tensor(0.0929)
The last decorrelation: tensor(0.9552)
Local adapation with distilling: 0.0001180000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6251) local CE: tensor(0.3684) Feature CE: tensor(1.2571) KL: tensor(0.1023)
The last decorrelation: tensor(0.8884)
Local adapation with distilling: 0.0001180000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5701) local CE: tensor(0.3984) Feature CE: tensor(1.1360) KL: tensor(0.1408)
The last decorrelation: tensor(0.8935)
Local adapation with distilling: 0.0001180000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7723) local CE: tensor(0.3502) Feature CE: tensor(1.3330) KL: tensor(0.1355)
The last decorrelation: tensor(0.9538)
Local adapation with distilling: 0.0001180000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1925) local CE: tensor(0.8841) Feature CE: tensor(1.2678) KL: tensor(0.1322)
The last decorrelation: tensor(0.9083)
Local adapation with distilling: 0.0001180000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8825) local CE: tensor(0.6537) Feature CE: tensor(1.1666) KL: tensor(0.0930)
The last decorrelation: tensor(0.9630)
Local adapation with distilling: 0.0001180000000000001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3715) local CE: tensor(0.3699) Feature CE: tensor(1.0330) KL: tensor(0.1165)
The last decorrelation: tensor(0.8460)
Global Model Acc on global data: 0.6057007125890737 length of data: 2947
save a model
size of the global feature buffer: 15
-------------Round number:  50  -------------
selected users: [88, 72, 20, 16, 147, 140, 113, 23, 12, 68, 39, 130, 34, 112, 55]
Current data/feature buff: torch.Size([69, 128, 20, 7]) torch.Size([69]) 69
Buffer classes: Counter({4: 19, 0: 14, 5: 13, 1: 11, 2: 8, 3: 4})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0415) local CE: tensor(0.6036) Feature CE: tensor(1.3634) KL: tensor(0.1039)
The last decorrelation: tensor(0.9708)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0696) local CE: tensor(0.7446) Feature CE: tensor(1.3160) KL: tensor(0.0964)
The last decorrelation: tensor(0.9127)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9931) local CE: tensor(0.6676) Feature CE: tensor(1.2988) KL: tensor(0.0722)
The last decorrelation: tensor(0.9545)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3491) local CE: tensor(0.3124) Feature CE: tensor(1.0161) KL: tensor(0.0516)
The last decorrelation: tensor(0.9588)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4062) local CE: tensor(0.8934) Feature CE: tensor(1.4525) KL: tensor(0.0992)
The last decorrelation: tensor(0.9615)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0415) local CE: tensor(0.7641) Feature CE: tensor(1.2214) KL: tensor(0.0960)
The last decorrelation: tensor(0.9599)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5704) local CE: tensor(0.3038) Feature CE: tensor(1.2270) KL: tensor(0.0767)
The last decorrelation: tensor(0.9610)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5271) local CE: tensor(0.6276) Feature CE: tensor(1.8105) KL: tensor(0.0898)
The last decorrelation: tensor(0.9992)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5548) local CE: tensor(0.3675) Feature CE: tensor(1.1997) KL: tensor(0.1082)
The last decorrelation: tensor(0.8800)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3695) local CE: tensor(0.1420) Feature CE: tensor(1.1972) KL: tensor(0.0314)
The last decorrelation: tensor(0.9989)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2978) local CE: tensor(0.1965) Feature CE: tensor(1.0841) KL: tensor(0.0545)
The last decorrelation: tensor(0.9626)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8724) local CE: tensor(0.6185) Feature CE: tensor(1.2048) KL: tensor(0.0784)
The last decorrelation: tensor(0.9659)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1792) local CE: tensor(0.6561) Feature CE: tensor(1.3872) KL: tensor(0.1388)
The last decorrelation: tensor(0.9970)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6778) local CE: tensor(0.3646) Feature CE: tensor(1.3128) KL: tensor(0.0702)
The last decorrelation: tensor(0.9304)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8519) local CE: tensor(0.6397) Feature CE: tensor(1.2235) KL: tensor(0.0681)
The last decorrelation: tensor(0.9125)
Global Model Acc on global data: 0.5717678995588734 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  51  -------------
selected users: [78, 121, 99, 36, 92, 107, 131, 144, 10, 126, 127, 4, 73, 123, 136]
Current data/feature buff: torch.Size([43, 128, 20, 7]) torch.Size([43]) 43
Buffer classes: Counter({3: 16, 5: 15, 1: 9, 2: 2, 4: 1})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8143) local CE: tensor(0.6012) Feature CE: tensor(1.1337) KL: tensor(0.0797)
The last decorrelation: tensor(0.9996)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4106) local CE: tensor(0.2980) Feature CE: tensor(1.1258) KL: tensor(0.0382)
The last decorrelation: tensor(0.9485)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3543) local CE: tensor(0.3679) Feature CE: tensor(1.0426) KL: tensor(0.0561)
The last decorrelation: tensor(0.8879)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7657) local CE: tensor(0.5005) Feature CE: tensor(1.2881) KL: tensor(0.0921)
The last decorrelation: tensor(0.8963)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5193) local CE: tensor(0.3589) Feature CE: tensor(1.2515) KL: tensor(0.0497)
The last decorrelation: tensor(0.8553)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0242) local CE: tensor(0.2768) Feature CE: tensor(0.8440) KL: tensor(0.0311)
The last decorrelation: tensor(0.8727)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3532) local CE: tensor(0.3017) Feature CE: tensor(1.0186) KL: tensor(0.0843)
The last decorrelation: tensor(0.9488)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.6297) local CE: tensor(0.8962) Feature CE: tensor(1.7082) KL: tensor(0.0437)
The last decorrelation: tensor(0.9814)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4548) local CE: tensor(0.4675) Feature CE: tensor(0.9524) KL: tensor(0.0589)
The last decorrelation: tensor(0.9780)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8670) local CE: tensor(0.3864) Feature CE: tensor(1.4642) KL: tensor(0.0604)
The last decorrelation: tensor(0.9557)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0665) local CE: tensor(0.8565) Feature CE: tensor(1.1641) KL: tensor(0.0882)
The last decorrelation: tensor(0.9634)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4049) local CE: tensor(0.3791) Feature CE: tensor(1.0833) KL: tensor(0.0593)
The last decorrelation: tensor(0.9020)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5992) local CE: tensor(0.4093) Feature CE: tensor(1.2978) KL: tensor(0.0405)
The last decorrelation: tensor(0.8486)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6825) local CE: tensor(0.4243) Feature CE: tensor(1.3464) KL: tensor(0.0489)
The last decorrelation: tensor(0.8629)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6394) local CE: tensor(0.5540) Feature CE: tensor(1.0921) KL: tensor(0.0578)
The last decorrelation: tensor(0.9354)
Global Model Acc on global data: 0.49440108585001696 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  52  -------------
selected users: [43, 37, 143, 145, 107, 52, 60, 41, 122, 131, 124, 104, 83, 3, 130]
Current data/feature buff: torch.Size([36, 128, 20, 7]) torch.Size([36]) 36
Buffer classes: Counter({2: 18, 5: 8, 1: 5, 3: 4, 0: 1})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1637) local CE: tensor(0.3549) Feature CE: tensor(0.8634) KL: tensor(0.0456)
The last decorrelation: tensor(0.8998)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3875) local CE: tensor(0.3088) Feature CE: tensor(1.1004) KL: tensor(0.0782)
The last decorrelation: tensor(0.8996)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2846) local CE: tensor(0.2897) Feature CE: tensor(1.0128) KL: tensor(0.1034)
The last decorrelation: tensor(0.8820)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5925) local CE: tensor(0.4040) Feature CE: tensor(1.1835) KL: tensor(0.1363)
The last decorrelation: tensor(0.8644)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1183) local CE: tensor(0.2333) Feature CE: tensor(0.9321) KL: tensor(0.0797)
The last decorrelation: tensor(0.8735)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0961) local CE: tensor(0.2028) Feature CE: tensor(0.8893) KL: tensor(0.1253)
The last decorrelation: tensor(0.8763)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9395) local CE: tensor(0.0622) Feature CE: tensor(0.8710) KL: tensor(0.0559)
The last decorrelation: tensor(0.9589)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1286) local CE: tensor(0.1386) Feature CE: tensor(1.0363) KL: tensor(0.0826)
The last decorrelation: tensor(0.8679)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6576) local CE: tensor(0.4352) Feature CE: tensor(1.2348) KL: tensor(0.0875)
The last decorrelation: tensor(0.8901)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1286) local CE: tensor(0.2302) Feature CE: tensor(0.8876) KL: tensor(0.0623)
The last decorrelation: tensor(0.9485)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5980) local CE: tensor(0.4404) Feature CE: tensor(1.1210) KL: tensor(0.0682)
The last decorrelation: tensor(0.9509)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7157) local CE: tensor(0.6407) Feature CE: tensor(0.9815) KL: tensor(0.0935)
The last decorrelation: tensor(1.0000)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8961) local CE: tensor(0.5288) Feature CE: tensor(1.3944) KL: tensor(0.1219)
The last decorrelation: tensor(0.8673)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6746) local CE: tensor(0.5529) Feature CE: tensor(0.9790) KL: tensor(0.1593)
The last decorrelation: tensor(0.9840)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6072) local CE: tensor(0.5217) Feature CE: tensor(1.0249) KL: tensor(0.0863)
The last decorrelation: tensor(0.9779)
Global Model Acc on global data: 0.5490329148286393 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  53  -------------
selected users: [8, 23, 118, 53, 86, 135, 123, 41, 66, 108, 31, 74, 83, 24, 109]
Current data/feature buff: torch.Size([81, 128, 20, 7]) torch.Size([81]) 81
Buffer classes: Counter({0: 30, 5: 20, 1: 19, 3: 8, 4: 3, 2: 1})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6202) local CE: tensor(0.3969) Feature CE: tensor(1.1335) KL: tensor(0.1181)
The last decorrelation: tensor(0.9752)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6272) local CE: tensor(0.2763) Feature CE: tensor(1.2782) KL: tensor(0.0736)
The last decorrelation: tensor(0.9992)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7144) local CE: tensor(0.4744) Feature CE: tensor(1.1956) KL: tensor(0.0803)
The last decorrelation: tensor(0.9703)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.6572) local CE: tensor(1.1405) Feature CE: tensor(1.4755) KL: tensor(0.0743)
The last decorrelation: tensor(0.9791)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2213) local CE: tensor(0.3411) Feature CE: tensor(0.8480) KL: tensor(0.0647)
The last decorrelation: tensor(0.9728)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7150) local CE: tensor(0.6526) Feature CE: tensor(1.0274) KL: tensor(0.1121)
The last decorrelation: tensor(0.9229)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6294) local CE: tensor(0.4051) Feature CE: tensor(1.2625) KL: tensor(0.0994)
The last decorrelation: tensor(0.8622)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9026) local CE: tensor(0.1061) Feature CE: tensor(0.8506) KL: tensor(0.0786)
The last decorrelation: tensor(0.8668)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5355) local CE: tensor(0.3939) Feature CE: tensor(1.2264) KL: tensor(0.0592)
The last decorrelation: tensor(0.8738)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0556) local CE: tensor(0.6791) Feature CE: tensor(1.3201) KL: tensor(0.1060)
The last decorrelation: tensor(0.9503)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0149) local CE: tensor(0.1414) Feature CE: tensor(0.9059) KL: tensor(0.0824)
The last decorrelation: tensor(0.8842)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3530) local CE: tensor(0.2446) Feature CE: tensor(1.1621) KL: tensor(0.0795)
The last decorrelation: tensor(0.8664)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4137) local CE: tensor(0.4416) Feature CE: tensor(1.0001) KL: tensor(0.1282)
The last decorrelation: tensor(0.8355)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5658) local CE: tensor(0.3629) Feature CE: tensor(1.1432) KL: tensor(0.1244)
The last decorrelation: tensor(0.9276)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1160) local CE: tensor(0.1841) Feature CE: tensor(0.9564) KL: tensor(0.0954)
The last decorrelation: tensor(0.8755)
Global Model Acc on global data: 0.5327451645741432 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  54  -------------
selected users: [0, 45, 91, 103, 94, 96, 42, 79, 116, 4, 40, 141, 146, 124, 81]
Current data/feature buff: torch.Size([98, 128, 20, 7]) torch.Size([98]) 98
Buffer classes: Counter({0: 37, 3: 23, 1: 15, 2: 12, 5: 9, 4: 2})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8667) local CE: tensor(0.5860) Feature CE: tensor(1.2479) KL: tensor(0.0536)
The last decorrelation: tensor(0.9792)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5082) local CE: tensor(0.3724) Feature CE: tensor(1.1419) KL: tensor(0.1048)
The last decorrelation: tensor(0.8903)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2377) local CE: tensor(0.9077) Feature CE: tensor(1.1781) KL: tensor(0.1985)
The last decorrelation: tensor(0.9535)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1870) local CE: tensor(0.2137) Feature CE: tensor(1.0351) KL: tensor(0.0981)
The last decorrelation: tensor(0.8333)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4211) local CE: tensor(0.6184) Feature CE: tensor(0.7832) KL: tensor(0.0885)
The last decorrelation: tensor(0.9307)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6389) local CE: tensor(0.4895) Feature CE: tensor(1.1267) KL: tensor(0.1470)
The last decorrelation: tensor(0.8671)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8435) local CE: tensor(0.6582) Feature CE: tensor(1.2036) KL: tensor(0.1353)
The last decorrelation: tensor(0.8464)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2151) local CE: tensor(0.3507) Feature CE: tensor(0.9543) KL: tensor(0.0685)
The last decorrelation: tensor(0.8400)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9027) local CE: tensor(0.5627) Feature CE: tensor(1.1728) KL: tensor(0.2499)
The last decorrelation: tensor(0.9175)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5520) local CE: tensor(0.4711) Feature CE: tensor(1.0932) KL: tensor(0.1139)
The last decorrelation: tensor(0.8810)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1071) local CE: tensor(0.1855) Feature CE: tensor(0.9263) KL: tensor(0.0753)
The last decorrelation: tensor(0.9196)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6643) local CE: tensor(0.5988) Feature CE: tensor(1.0864) KL: tensor(0.0793)
The last decorrelation: tensor(0.9003)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6120) local CE: tensor(0.5934) Feature CE: tensor(0.9556) KL: tensor(0.1418)
The last decorrelation: tensor(0.9209)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6169) local CE: tensor(0.4560) Feature CE: tensor(1.1017) KL: tensor(0.0891)
The last decorrelation: tensor(0.9530)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2481) local CE: tensor(0.3049) Feature CE: tensor(1.0264) KL: tensor(0.0565)
The last decorrelation: tensor(0.8621)
Global Model Acc on global data: 0.5449609772650152 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  55  -------------
selected users: [9, 36, 8, 137, 136, 12, 104, 149, 15, 28, 22, 66, 100, 34, 143]
Current data/feature buff: torch.Size([54, 128, 20, 7]) torch.Size([54]) 54
Buffer classes: Counter({2: 26, 1: 11, 3: 8, 0: 8, 5: 1})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4286) local CE: tensor(0.4117) Feature CE: tensor(1.0074) KL: tensor(0.1178)
The last decorrelation: tensor(0.8917)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8349) local CE: tensor(0.6290) Feature CE: tensor(1.1976) KL: tensor(0.1039)
The last decorrelation: tensor(0.8793)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3067) local CE: tensor(0.2551) Feature CE: tensor(0.9871) KL: tensor(0.0946)
The last decorrelation: tensor(0.9736)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6920) local CE: tensor(0.3825) Feature CE: tensor(1.2669) KL: tensor(0.0975)
The last decorrelation: tensor(0.9471)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7611) local CE: tensor(0.5083) Feature CE: tensor(1.2818) KL: tensor(0.0474)
The last decorrelation: tensor(0.9255)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2760) local CE: tensor(0.3735) Feature CE: tensor(0.8852) KL: tensor(0.1360)
The last decorrelation: tensor(0.8866)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6353) local CE: tensor(0.6043) Feature CE: tensor(0.9729) KL: tensor(0.0581)
The last decorrelation: tensor(1.0000)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0940) local CE: tensor(0.9181) Feature CE: tensor(1.1888) KL: tensor(0.0962)
The last decorrelation: tensor(0.8912)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4742) local CE: tensor(0.3060) Feature CE: tensor(1.1143) KL: tensor(0.0932)
The last decorrelation: tensor(0.9703)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1514) local CE: tensor(0.8028) Feature CE: tensor(1.3257) KL: tensor(0.0444)
The last decorrelation: tensor(0.9855)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4644) local CE: tensor(0.3251) Feature CE: tensor(1.2399) KL: tensor(0.0591)
The last decorrelation: tensor(0.8398)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3654) local CE: tensor(0.3458) Feature CE: tensor(1.1202) KL: tensor(0.0486)
The last decorrelation: tensor(0.8553)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5645) local CE: tensor(0.3680) Feature CE: tensor(1.2073) KL: tensor(0.0609)
The last decorrelation: tensor(0.9347)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8632) local CE: tensor(0.5123) Feature CE: tensor(1.1985) KL: tensor(0.1551)
The last decorrelation: tensor(0.9973)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3682) local CE: tensor(0.3013) Feature CE: tensor(1.1189) KL: tensor(0.0738)
The last decorrelation: tensor(0.8750)
Global Model Acc on global data: 0.5676959619952494 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  56  -------------
selected users: [137, 98, 77, 141, 120, 145, 146, 35, 12, 127, 71, 4, 0, 18, 83]
Current data/feature buff: torch.Size([61, 128, 20, 7]) torch.Size([61]) 61
Buffer classes: Counter({3: 20, 1: 18, 5: 13, 2: 7, 0: 2, 4: 1})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4454) local CE: tensor(0.3205) Feature CE: tensor(1.0300) KL: tensor(0.1488)
The last decorrelation: tensor(0.9442)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4834) local CE: tensor(0.4371) Feature CE: tensor(1.1372) KL: tensor(0.0282)
The last decorrelation: tensor(0.8948)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4983) local CE: tensor(0.4036) Feature CE: tensor(1.0861) KL: tensor(0.0858)
The last decorrelation: tensor(0.9228)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3416) local CE: tensor(0.3546) Feature CE: tensor(1.0485) KL: tensor(0.0379)
The last decorrelation: tensor(0.9009)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.7059) local CE: tensor(1.3041) Feature CE: tensor(1.3991) KL: tensor(0.0732)
The last decorrelation: tensor(0.9293)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6983) local CE: tensor(0.3436) Feature CE: tensor(1.3500) KL: tensor(0.1375)
The last decorrelation: tensor(0.8768)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8848) local CE: tensor(0.5858) Feature CE: tensor(1.2522) KL: tensor(0.1243)
The last decorrelation: tensor(0.9222)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6851) local CE: tensor(0.5370) Feature CE: tensor(1.2405) KL: tensor(0.0543)
The last decorrelation: tensor(0.8526)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1093) local CE: tensor(0.2060) Feature CE: tensor(0.9682) KL: tensor(0.0542)
The last decorrelation: tensor(0.8808)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5023) local CE: tensor(1.0265) Feature CE: tensor(1.4074) KL: tensor(0.1124)
The last decorrelation: tensor(0.9630)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3846) local CE: tensor(0.3786) Feature CE: tensor(1.0040) KL: tensor(0.0803)
The last decorrelation: tensor(0.9212)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3269) local CE: tensor(0.3296) Feature CE: tensor(1.0262) KL: tensor(0.0891)
The last decorrelation: tensor(0.8819)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6032) local CE: tensor(0.4503) Feature CE: tensor(1.1283) KL: tensor(0.0453)
The last decorrelation: tensor(0.9792)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8856) local CE: tensor(0.4688) Feature CE: tensor(1.3505) KL: tensor(0.1265)
The last decorrelation: tensor(0.9365)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6206) local CE: tensor(0.4093) Feature CE: tensor(1.2735) KL: tensor(0.0869)
The last decorrelation: tensor(0.8605)
Global Model Acc on global data: 0.5833050559891415 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  57  -------------
selected users: [143, 134, 87, 67, 48, 51, 3, 101, 84, 42, 75, 17, 19, 31, 71]
Current data/feature buff: torch.Size([49, 128, 20, 7]) torch.Size([49]) 49
Buffer classes: Counter({4: 15, 1: 13, 0: 8, 3: 7, 2: 4, 5: 2})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3366) local CE: tensor(0.2343) Feature CE: tensor(1.1513) KL: tensor(0.0750)
The last decorrelation: tensor(0.8795)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9369) local CE: tensor(0.4948) Feature CE: tensor(1.3808) KL: tensor(0.1589)
The last decorrelation: tensor(0.9022)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5602) local CE: tensor(0.2884) Feature CE: tensor(1.2379) KL: tensor(0.0669)
The last decorrelation: tensor(0.9729)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6754) local CE: tensor(0.4722) Feature CE: tensor(1.2047) KL: tensor(0.1300)
The last decorrelation: tensor(0.8686)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2718) local CE: tensor(0.1540) Feature CE: tensor(1.1145) KL: tensor(0.0714)
The last decorrelation: tensor(0.9318)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4778) local CE: tensor(0.3308) Feature CE: tensor(1.1433) KL: tensor(0.1170)
The last decorrelation: tensor(0.8955)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2800) local CE: tensor(0.5163) Feature CE: tensor(1.6078) KL: tensor(0.1719)
The last decorrelation: tensor(0.9841)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5348) local CE: tensor(0.3830) Feature CE: tensor(1.2096) KL: tensor(0.0707)
The last decorrelation: tensor(0.8687)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7007) local CE: tensor(0.4850) Feature CE: tensor(1.2611) KL: tensor(0.0650)
The last decorrelation: tensor(0.8899)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8604) local CE: tensor(0.5449) Feature CE: tensor(1.3747) KL: tensor(0.0945)
The last decorrelation: tensor(0.8466)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9357) local CE: tensor(0.4929) Feature CE: tensor(1.2663) KL: tensor(0.2093)
The last decorrelation: tensor(0.9672)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4028) local CE: tensor(0.8692) Feature CE: tensor(1.4951) KL: tensor(0.0768)
The last decorrelation: tensor(0.9617)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1994) local CE: tensor(0.1012) Feature CE: tensor(1.0891) KL: tensor(0.0510)
The last decorrelation: tensor(0.9577)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0464) local CE: tensor(0.1171) Feature CE: tensor(1.0041) KL: tensor(0.0414)
The last decorrelation: tensor(0.8815)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5810) local CE: tensor(0.3153) Feature CE: tensor(1.2661) KL: tensor(0.0791)
The last decorrelation: tensor(0.9197)
Global Model Acc on global data: 0.6599932134373939 length of data: 2947
save a model
size of the global feature buffer: 15
-------------Round number:  58  -------------
selected users: [50, 78, 100, 81, 30, 93, 47, 70, 92, 137, 48, 122, 13, 119, 118]
Current data/feature buff: torch.Size([64, 128, 20, 7]) torch.Size([64]) 64
Buffer classes: Counter({0: 19, 3: 18, 1: 10, 5: 7, 4: 5, 2: 5})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9427) local CE: tensor(0.5794) Feature CE: tensor(1.2488) KL: tensor(0.1572)
The last decorrelation: tensor(0.9572)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4965) local CE: tensor(0.9610) Feature CE: tensor(1.4550) KL: tensor(0.0808)
The last decorrelation: tensor(0.9996)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5868) local CE: tensor(0.3695) Feature CE: tensor(1.2122) KL: tensor(0.0725)
The last decorrelation: tensor(0.9281)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2424) local CE: tensor(0.3072) Feature CE: tensor(1.0338) KL: tensor(0.0408)
The last decorrelation: tensor(0.8629)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6742) local CE: tensor(0.4434) Feature CE: tensor(1.2428) KL: tensor(0.1226)
The last decorrelation: tensor(0.8606)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4083) local CE: tensor(0.3079) Feature CE: tensor(1.0397) KL: tensor(0.0626)
The last decorrelation: tensor(0.9981)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7103) local CE: tensor(0.4203) Feature CE: tensor(1.2604) KL: tensor(0.0693)
The last decorrelation: tensor(0.9771)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7953) local CE: tensor(0.4316) Feature CE: tensor(1.2643) KL: tensor(0.1398)
The last decorrelation: tensor(0.9422)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3579) local CE: tensor(0.2697) Feature CE: tensor(1.1530) KL: tensor(0.0717)
The last decorrelation: tensor(0.8730)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3910) local CE: tensor(0.8024) Feature CE: tensor(1.5036) KL: tensor(0.1407)
The last decorrelation: tensor(0.9439)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9926) local CE: tensor(0.1077) Feature CE: tensor(0.9038) KL: tensor(0.0494)
The last decorrelation: tensor(0.9315)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5261) local CE: tensor(0.2973) Feature CE: tensor(1.2428) KL: tensor(0.0860)
The last decorrelation: tensor(0.9123)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3357) local CE: tensor(0.8081) Feature CE: tensor(1.4598) KL: tensor(0.0790)
The last decorrelation: tensor(0.9888)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1694) local CE: tensor(0.1050) Feature CE: tensor(1.0525) KL: tensor(0.0584)
The last decorrelation: tensor(0.9601)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1917) local CE: tensor(0.1697) Feature CE: tensor(0.9941) KL: tensor(0.0554)
The last decorrelation: tensor(0.9831)
Global Model Acc on global data: 0.6416694944010859 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  59  -------------
selected users: [91, 31, 131, 125, 119, 115, 89, 48, 143, 147, 124, 58, 79, 49, 43]
Current data/feature buff: torch.Size([81, 128, 20, 7]) torch.Size([81]) 81
Buffer classes: Counter({4: 33, 2: 12, 5: 12, 3: 9, 1: 8, 0: 7})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5123) local CE: tensor(1.1026) Feature CE: tensor(1.3222) KL: tensor(0.1343)
The last decorrelation: tensor(0.9533)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0623) local CE: tensor(0.0665) Feature CE: tensor(1.0929) KL: tensor(0.0220)
The last decorrelation: tensor(0.8783)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7231) local CE: tensor(0.5224) Feature CE: tensor(1.1833) KL: tensor(0.0696)
The last decorrelation: tensor(0.9478)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3110) local CE: tensor(0.9541) Feature CE: tensor(1.2716) KL: tensor(0.1200)
The last decorrelation: tensor(0.9653)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.8361) local CE: tensor(0.0568) Feature CE: tensor(0.7808) KL: tensor(0.0456)
The last decorrelation: tensor(0.9623)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9689) local CE: tensor(0.0827) Feature CE: tensor(0.8632) KL: tensor(0.0789)
The last decorrelation: tensor(0.9426)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2868) local CE: tensor(1.0156) Feature CE: tensor(1.2327) KL: tensor(0.1031)
The last decorrelation: tensor(0.9356)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1645) local CE: tensor(0.0755) Feature CE: tensor(1.1166) KL: tensor(0.0413)
The last decorrelation: tensor(0.9309)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3788) local CE: tensor(0.2946) Feature CE: tensor(1.1267) KL: tensor(0.0816)
The last decorrelation: tensor(0.8737)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0423) local CE: tensor(0.6949) Feature CE: tensor(1.3173) KL: tensor(0.0698)
The last decorrelation: tensor(0.9604)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4687) local CE: tensor(0.3218) Feature CE: tensor(1.1194) KL: tensor(0.0493)
The last decorrelation: tensor(0.9799)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2606) local CE: tensor(0.9735) Feature CE: tensor(1.2818) KL: tensor(0.0961)
The last decorrelation: tensor(0.9092)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3886) local CE: tensor(0.3313) Feature CE: tensor(1.1922) KL: tensor(0.0267)
The last decorrelation: tensor(0.8468)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0140) local CE: tensor(0.6570) Feature CE: tensor(1.3274) KL: tensor(0.0633)
The last decorrelation: tensor(0.9664)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0099) local CE: tensor(0.7505) Feature CE: tensor(1.2727) KL: tensor(0.0882)
The last decorrelation: tensor(0.8987)
Global Model Acc on global data: 0.5500508992195453 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  60  -------------
selected users: [69, 71, 97, 42, 73, 35, 67, 33, 23, 133, 4, 15, 137, 68, 142]
Current data/feature buff: torch.Size([94, 128, 20, 7]) torch.Size([94]) 94
Buffer classes: Counter({4: 47, 0: 21, 5: 7, 3: 7, 1: 7, 2: 5})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1994) local CE: tensor(0.6889) Feature CE: tensor(1.4684) KL: tensor(0.0904)
The last decorrelation: tensor(0.9518)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0026) local CE: tensor(0.7735) Feature CE: tensor(1.2329) KL: tensor(0.0759)
The last decorrelation: tensor(0.9200)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9336) local CE: tensor(0.1063) Feature CE: tensor(0.9443) KL: tensor(0.0381)
The last decorrelation: tensor(0.8371)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0479) local CE: tensor(0.7902) Feature CE: tensor(1.3640) KL: tensor(0.0479)
The last decorrelation: tensor(0.8463)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4140) local CE: tensor(0.3927) Feature CE: tensor(1.1283) KL: tensor(0.0447)
The last decorrelation: tensor(0.8472)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4861) local CE: tensor(0.4871) Feature CE: tensor(1.0916) KL: tensor(0.0568)
The last decorrelation: tensor(0.8502)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8791) local CE: tensor(0.6852) Feature CE: tensor(1.2261) KL: tensor(0.1002)
The last decorrelation: tensor(0.8677)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0390) local CE: tensor(0.6379) Feature CE: tensor(1.2053) KL: tensor(0.2522)
The last decorrelation: tensor(0.9312)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4074) local CE: tensor(0.8503) Feature CE: tensor(1.3233) KL: tensor(0.2347)
The last decorrelation: tensor(0.9991)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5691) local CE: tensor(1.1529) Feature CE: tensor(1.3083) KL: tensor(0.1378)
The last decorrelation: tensor(0.9702)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6315) local CE: tensor(0.4813) Feature CE: tensor(1.1901) KL: tensor(0.0797)
The last decorrelation: tensor(0.8865)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4722) local CE: tensor(0.3928) Feature CE: tensor(1.0805) KL: tensor(0.0546)
The last decorrelation: tensor(0.9418)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2295) local CE: tensor(0.6279) Feature CE: tensor(1.4594) KL: tensor(0.1974)
The last decorrelation: tensor(0.9471)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4015) local CE: tensor(0.2672) Feature CE: tensor(1.0668) KL: tensor(0.0685)
The last decorrelation: tensor(0.9990)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9801) local CE: tensor(0.1019) Feature CE: tensor(0.9773) KL: tensor(0.0373)
The last decorrelation: tensor(0.8623)
Global Model Acc on global data: 0.496097726501527 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  61  -------------
selected users: [97, 95, 68, 74, 19, 102, 49, 138, 62, 29, 106, 44, 121, 58, 17]
Current data/feature buff: torch.Size([51, 128, 20, 7]) torch.Size([51]) 51
Buffer classes: Counter({0: 22, 2: 11, 3: 10, 1: 6, 5: 2})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.7775) local CE: tensor(0.0872) Feature CE: tensor(0.7499) KL: tensor(0.0939)
The last decorrelation: tensor(0.8484)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5563) local CE: tensor(0.4053) Feature CE: tensor(1.0935) KL: tensor(0.1903)
The last decorrelation: tensor(0.8676)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4341) local CE: tensor(0.1951) Feature CE: tensor(1.1360) KL: tensor(0.1041)
The last decorrelation: tensor(0.9990)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3275) local CE: tensor(0.3004) Feature CE: tensor(0.9583) KL: tensor(0.2004)
The last decorrelation: tensor(0.8639)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1383) local CE: tensor(0.1021) Feature CE: tensor(0.9983) KL: tensor(0.0702)
The last decorrelation: tensor(0.9662)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2111) local CE: tensor(0.1409) Feature CE: tensor(1.0281) KL: tensor(0.0788)
The last decorrelation: tensor(0.9637)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8071) local CE: tensor(0.5383) Feature CE: tensor(1.0856) KL: tensor(0.2169)
The last decorrelation: tensor(0.9665)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9135) local CE: tensor(0.5412) Feature CE: tensor(1.3537) KL: tensor(0.0382)
The last decorrelation: tensor(0.9804)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3289) local CE: tensor(0.2010) Feature CE: tensor(1.1132) KL: tensor(0.0610)
The last decorrelation: tensor(0.9600)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2251) local CE: tensor(0.1611) Feature CE: tensor(1.0824) KL: tensor(0.0800)
The last decorrelation: tensor(0.8947)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6262) local CE: tensor(0.3959) Feature CE: tensor(1.1617) KL: tensor(0.1208)
The last decorrelation: tensor(0.9480)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7534) local CE: tensor(0.4353) Feature CE: tensor(1.2603) KL: tensor(0.0686)
The last decorrelation: tensor(0.9957)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0497) local CE: tensor(0.1723) Feature CE: tensor(0.7883) KL: tensor(0.1422)
The last decorrelation: tensor(0.9469)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3624) local CE: tensor(0.9723) Feature CE: tensor(1.3370) KL: tensor(0.1442)
The last decorrelation: tensor(0.9090)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2575) local CE: tensor(0.7832) Feature CE: tensor(1.4352) KL: tensor(0.0772)
The last decorrelation: tensor(0.9619)
Global Model Acc on global data: 0.6576179165252799 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  62  -------------
selected users: [144, 132, 32, 37, 109, 77, 123, 39, 98, 96, 130, 119, 46, 54, 62]
Current data/feature buff: torch.Size([83, 128, 20, 7]) torch.Size([83]) 83
Buffer classes: Counter({3: 29, 4: 27, 0: 11, 2: 9, 1: 4, 5: 3})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2433) local CE: tensor(0.6369) Feature CE: tensor(1.4388) KL: tensor(0.1877)
The last decorrelation: tensor(0.9800)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3788) local CE: tensor(0.1099) Feature CE: tensor(1.2032) KL: tensor(0.0689)
The last decorrelation: tensor(0.9968)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0157) local CE: tensor(0.1695) Feature CE: tensor(0.8442) KL: tensor(0.0672)
The last decorrelation: tensor(0.9216)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0157) local CE: tensor(0.0593) Feature CE: tensor(1.0373) KL: tensor(0.0282)
The last decorrelation: tensor(0.8879)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3174) local CE: tensor(0.2403) Feature CE: tensor(1.1475) KL: tensor(0.0553)
The last decorrelation: tensor(0.8748)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9116) local CE: tensor(0.6617) Feature CE: tensor(1.2178) KL: tensor(0.1123)
The last decorrelation: tensor(0.9200)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6188) local CE: tensor(0.3861) Feature CE: tensor(1.2973) KL: tensor(0.0746)
The last decorrelation: tensor(0.8609)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1842) local CE: tensor(0.1969) Feature CE: tensor(0.9239) KL: tensor(0.1012)
The last decorrelation: tensor(0.9622)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4245) local CE: tensor(0.3663) Feature CE: tensor(1.1441) KL: tensor(0.0456)
The last decorrelation: tensor(0.8578)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7894) local CE: tensor(0.5456) Feature CE: tensor(1.2750) KL: tensor(0.0928)
The last decorrelation: tensor(0.8861)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.6966) local CE: tensor(1.0443) Feature CE: tensor(1.4483) KL: tensor(0.2314)
The last decorrelation: tensor(0.9774)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9028) local CE: tensor(0.0816) Feature CE: tensor(0.8265) KL: tensor(0.0463)
The last decorrelation: tensor(0.9493)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9075) local CE: tensor(0.7837) Feature CE: tensor(1.1330) KL: tensor(0.0838)
The last decorrelation: tensor(0.9069)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1253) local CE: tensor(0.6106) Feature CE: tensor(1.2823) KL: tensor(0.3031)
The last decorrelation: tensor(0.9296)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0928) local CE: tensor(0.1960) Feature CE: tensor(0.8800) KL: tensor(0.0662)
The last decorrelation: tensor(0.9578)
Global Model Acc on global data: 0.5327451645741432 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  63  -------------
selected users: [111, 40, 69, 68, 117, 27, 127, 92, 118, 76, 28, 57, 137, 133, 93]
Current data/feature buff: torch.Size([100, 128, 20, 7]) torch.Size([100]) 100
Buffer classes: Counter({4: 63, 1: 22, 0: 11, 5: 3, 2: 1})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(4.0781) local CE: tensor(1.5153) Feature CE: tensor(1.3695) KL: tensor(0.1975)
The last decorrelation: tensor(0.9957)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4616) local CE: tensor(0.2959) Feature CE: tensor(1.0257) KL: tensor(0.2206)
The last decorrelation: tensor(0.9195)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1809) local CE: tensor(0.8799) Feature CE: tensor(1.2659) KL: tensor(0.0841)
The last decorrelation: tensor(0.9511)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5462) local CE: tensor(0.2855) Feature CE: tensor(1.0120) KL: tensor(0.2497)
The last decorrelation: tensor(0.9990)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5592) local CE: tensor(0.7038) Feature CE: tensor(0.8549) KL: tensor(0.0570)
The last decorrelation: tensor(0.9406)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7540) local CE: tensor(0.5747) Feature CE: tensor(1.2185) KL: tensor(0.1203)
The last decorrelation: tensor(0.8353)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9747) local CE: tensor(0.8780) Feature CE: tensor(1.0647) KL: tensor(0.0749)
The last decorrelation: tensor(0.9658)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4746) local CE: tensor(0.4083) Feature CE: tensor(1.1425) KL: tensor(0.0666)
The last decorrelation: tensor(0.8564)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5004) local CE: tensor(0.3791) Feature CE: tensor(0.9945) KL: tensor(0.1667)
The last decorrelation: tensor(0.9536)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2135) local CE: tensor(0.2173) Feature CE: tensor(0.9369) KL: tensor(0.0975)
The last decorrelation: tensor(0.9706)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.9381) local CE: tensor(1.3688) Feature CE: tensor(1.3760) KL: tensor(0.2083)
The last decorrelation: tensor(0.9832)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1057) local CE: tensor(0.1559) Feature CE: tensor(0.9588) KL: tensor(0.1035)
The last decorrelation: tensor(0.8928)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5094) local CE: tensor(0.9413) Feature CE: tensor(1.3601) KL: tensor(0.2636)
The last decorrelation: tensor(0.9470)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(4.0183) local CE: tensor(1.5034) Feature CE: tensor(1.3512) KL: tensor(0.1938)
The last decorrelation: tensor(0.9700)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.7327) local CE: tensor(0.0611) Feature CE: tensor(0.6094) KL: tensor(0.0643)
The last decorrelation: tensor(0.9980)
Global Model Acc on global data: 0.6562606040040719 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  64  -------------
selected users: [94, 67, 88, 13, 29, 28, 7, 90, 100, 83, 105, 58, 17, 23, 69]
Current data/feature buff: torch.Size([80, 128, 20, 7]) torch.Size([80]) 80
Buffer classes: Counter({5: 31, 3: 19, 2: 15, 4: 10, 0: 5})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7864) local CE: tensor(0.4073) Feature CE: tensor(1.3548) KL: tensor(0.0942)
The last decorrelation: tensor(0.9302)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6210) local CE: tensor(0.4095) Feature CE: tensor(1.2972) KL: tensor(0.0471)
The last decorrelation: tensor(0.8671)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9098) local CE: tensor(0.5990) Feature CE: tensor(1.1557) KL: tensor(0.1850)
The last decorrelation: tensor(0.9701)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8876) local CE: tensor(0.6775) Feature CE: tensor(1.1124) KL: tensor(0.1088)
The last decorrelation: tensor(0.9888)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2752) local CE: tensor(0.2006) Feature CE: tensor(1.1123) KL: tensor(0.0691)
The last decorrelation: tensor(0.8946)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1146) local CE: tensor(0.8312) Feature CE: tensor(1.1930) KL: tensor(0.1313)
The last decorrelation: tensor(0.9867)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3687) local CE: tensor(0.8749) Feature CE: tensor(1.4371) KL: tensor(0.0652)
The last decorrelation: tensor(0.9915)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7514) local CE: tensor(0.3680) Feature CE: tensor(1.1736) KL: tensor(0.2540)
The last decorrelation: tensor(0.9559)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4238) local CE: tensor(0.3324) Feature CE: tensor(1.0692) KL: tensor(0.0959)
The last decorrelation: tensor(0.9201)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5107) local CE: tensor(0.3101) Feature CE: tensor(1.2914) KL: tensor(0.0667)
The last decorrelation: tensor(0.8400)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4384) local CE: tensor(0.3059) Feature CE: tensor(0.9421) KL: tensor(0.2068)
The last decorrelation: tensor(0.9838)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1051) local CE: tensor(0.8538) Feature CE: tensor(1.2389) KL: tensor(0.1035)
The last decorrelation: tensor(0.9090)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0677) local CE: tensor(0.7852) Feature CE: tensor(1.2316) KL: tensor(0.0894)
The last decorrelation: tensor(0.9613)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3276) local CE: tensor(0.6541) Feature CE: tensor(1.5228) KL: tensor(0.1516)
The last decorrelation: tensor(0.9991)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0271) local CE: tensor(0.4129) Feature CE: tensor(1.5018) KL: tensor(0.1608)
The last decorrelation: tensor(0.9519)
Global Model Acc on global data: 0.6168985408890397 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  65  -------------
selected users: [127, 68, 9, 54, 31, 103, 43, 20, 125, 99, 28, 62, 77, 3, 24]
Current data/feature buff: torch.Size([38, 128, 20, 7]) torch.Size([38]) 38
Buffer classes: Counter({3: 13, 4: 10, 1: 6, 2: 4, 5: 3, 0: 2})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9254) local CE: tensor(0.7352) Feature CE: tensor(1.1453) KL: tensor(0.0910)
The last decorrelation: tensor(0.9256)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1407) local CE: tensor(0.1783) Feature CE: tensor(0.9060) KL: tensor(0.0573)
The last decorrelation: tensor(0.9990)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4956) local CE: tensor(0.3931) Feature CE: tensor(1.0742) KL: tensor(0.1374)
The last decorrelation: tensor(0.8909)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1509) local CE: tensor(0.5860) Feature CE: tensor(1.3873) KL: tensor(0.2470)
The last decorrelation: tensor(0.9305)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2981) local CE: tensor(0.1419) Feature CE: tensor(1.2272) KL: tensor(0.0443)
The last decorrelation: tensor(0.8815)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2122) local CE: tensor(0.2221) Feature CE: tensor(1.1131) KL: tensor(0.0384)
The last decorrelation: tensor(0.8381)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7615) local CE: tensor(0.5254) Feature CE: tensor(1.2342) KL: tensor(0.1035)
The last decorrelation: tensor(0.8987)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8918) local CE: tensor(0.6339) Feature CE: tensor(1.2208) KL: tensor(0.0832)
The last decorrelation: tensor(0.9539)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5941) local CE: tensor(0.3973) Feature CE: tensor(1.1341) KL: tensor(0.0975)
The last decorrelation: tensor(0.9654)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7403) local CE: tensor(0.3592) Feature CE: tensor(1.3680) KL: tensor(0.1271)
The last decorrelation: tensor(0.8860)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0533) local CE: tensor(0.7404) Feature CE: tensor(1.1859) KL: tensor(0.1558)
The last decorrelation: tensor(0.9525)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1843) local CE: tensor(0.2171) Feature CE: tensor(0.9222) KL: tensor(0.0863)
The last decorrelation: tensor(0.9585)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5329) local CE: tensor(0.3223) Feature CE: tensor(1.2336) KL: tensor(0.0560)
The last decorrelation: tensor(0.9211)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8313) local CE: tensor(0.3807) Feature CE: tensor(1.2026) KL: tensor(0.2641)
The last decorrelation: tensor(0.9871)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3032) local CE: tensor(0.3293) Feature CE: tensor(0.9413) KL: tensor(0.0934)
The last decorrelation: tensor(0.9331)
Global Model Acc on global data: 0.5225653206650831 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  66  -------------
selected users: [97, 76, 54, 18, 58, 95, 0, 33, 13, 129, 116, 141, 49, 138, 142]
Current data/feature buff: torch.Size([70, 128, 20, 7]) torch.Size([70]) 70
Buffer classes: Counter({2: 20, 4: 16, 3: 14, 0: 14, 5: 5, 1: 1})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1053) local CE: tensor(0.1156) Feature CE: tensor(1.0382) KL: tensor(0.1006)
The last decorrelation: tensor(0.8519)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3072) local CE: tensor(0.1171) Feature CE: tensor(1.1592) KL: tensor(0.0728)
The last decorrelation: tensor(0.9727)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7998) local CE: tensor(0.4939) Feature CE: tensor(1.2364) KL: tensor(0.1393)
The last decorrelation: tensor(0.9305)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0581) local CE: tensor(0.1245) Feature CE: tensor(0.9413) KL: tensor(0.0545)
The last decorrelation: tensor(0.9508)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0999) local CE: tensor(0.8102) Feature CE: tensor(1.2585) KL: tensor(0.1223)
The last decorrelation: tensor(0.9090)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3674) local CE: tensor(0.3046) Feature CE: tensor(1.1200) KL: tensor(0.0753)
The last decorrelation: tensor(0.8680)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6782) local CE: tensor(0.4902) Feature CE: tensor(1.1586) KL: tensor(0.0501)
The last decorrelation: tensor(0.9793)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8618) local CE: tensor(0.3151) Feature CE: tensor(1.3151) KL: tensor(0.2678)
The last decorrelation: tensor(0.9485)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9949) local CE: tensor(0.7311) Feature CE: tensor(1.2013) KL: tensor(0.0736)
The last decorrelation: tensor(0.9888)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3947) local CE: tensor(0.2584) Feature CE: tensor(1.1541) KL: tensor(0.0961)
The last decorrelation: tensor(0.8786)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9452) local CE: tensor(0.6064) Feature CE: tensor(1.3132) KL: tensor(0.1082)
The last decorrelation: tensor(0.9180)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7150) local CE: tensor(0.4879) Feature CE: tensor(1.2547) KL: tensor(0.0736)
The last decorrelation: tensor(0.8991)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6348) local CE: tensor(0.3943) Feature CE: tensor(1.1505) KL: tensor(0.1233)
The last decorrelation: tensor(0.9666)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9029) local CE: tensor(0.5983) Feature CE: tensor(1.2558) KL: tensor(0.0683)
The last decorrelation: tensor(0.9805)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0946) local CE: tensor(0.1352) Feature CE: tensor(0.9927) KL: tensor(0.0997)
The last decorrelation: tensor(0.8690)
Global Model Acc on global data: 0.5286732270105192 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  67  -------------
selected users: [43, 38, 97, 32, 93, 6, 2, 63, 51, 73, 74, 139, 131, 54, 83]
Current data/feature buff: torch.Size([80, 128, 20, 7]) torch.Size([80]) 80
Buffer classes: Counter({5: 35, 0: 21, 4: 12, 2: 8, 3: 3, 1: 1})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6314) local CE: tensor(0.5959) Feature CE: tensor(1.0338) KL: tensor(0.1033)
The last decorrelation: tensor(0.8986)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9681) local CE: tensor(0.1098) Feature CE: tensor(0.9345) KL: tensor(0.0584)
The last decorrelation: tensor(0.8647)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.8721) local CE: tensor(0.0675) Feature CE: tensor(0.8936) KL: tensor(0.0601)
The last decorrelation: tensor(0.8495)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1701) local CE: tensor(0.2157) Feature CE: tensor(0.9358) KL: tensor(0.0659)
The last decorrelation: tensor(0.9482)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3139) local CE: tensor(0.2282) Feature CE: tensor(0.9568) KL: tensor(0.1308)
The last decorrelation: tensor(0.9980)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2181) local CE: tensor(0.2006) Feature CE: tensor(1.0274) KL: tensor(0.0598)
The last decorrelation: tensor(0.9301)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9495) local CE: tensor(0.5641) Feature CE: tensor(1.3347) KL: tensor(0.1579)
The last decorrelation: tensor(0.8973)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3113) local CE: tensor(0.2624) Feature CE: tensor(1.0159) KL: tensor(0.1285)
The last decorrelation: tensor(0.9047)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1404) local CE: tensor(0.2448) Feature CE: tensor(0.9402) KL: tensor(0.0683)
The last decorrelation: tensor(0.8979)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3509) local CE: tensor(0.2650) Feature CE: tensor(1.1471) KL: tensor(0.0860)
The last decorrelation: tensor(0.8547)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2603) local CE: tensor(0.2324) Feature CE: tensor(1.0737) KL: tensor(0.0834)
The last decorrelation: tensor(0.8716)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2829) local CE: tensor(0.9504) Feature CE: tensor(1.2933) KL: tensor(0.0822)
The last decorrelation: tensor(0.9567)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2932) local CE: tensor(0.3413) Feature CE: tensor(0.9197) KL: tensor(0.0844)
The last decorrelation: tensor(0.9479)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9176) local CE: tensor(0.6590) Feature CE: tensor(1.2522) KL: tensor(0.0763)
The last decorrelation: tensor(0.9302)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2204) local CE: tensor(0.2591) Feature CE: tensor(1.0413) KL: tensor(0.0759)
The last decorrelation: tensor(0.8338)
Global Model Acc on global data: 0.5208686800135731 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  68  -------------
selected users: [147, 35, 13, 73, 91, 82, 93, 40, 99, 21, 18, 16, 111, 142, 69]
Current data/feature buff: torch.Size([66, 128, 20, 7]) torch.Size([66]) 66
Buffer classes: Counter({0: 20, 4: 19, 2: 18, 1: 6, 3: 2, 5: 1})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(4.6170) local CE: tensor(1.8662) Feature CE: tensor(1.6089) KL: tensor(0.1820)
The last decorrelation: tensor(0.9602)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4390) local CE: tensor(0.4081) Feature CE: tensor(1.0355) KL: tensor(0.1443)
The last decorrelation: tensor(0.8511)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7443) local CE: tensor(0.5951) Feature CE: tensor(1.0866) KL: tensor(0.0737)
The last decorrelation: tensor(0.9887)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2252) local CE: tensor(0.2170) Feature CE: tensor(1.0552) KL: tensor(0.0979)
The last decorrelation: tensor(0.8527)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(4.3881) local CE: tensor(1.4171) Feature CE: tensor(1.7234) KL: tensor(0.2947)
The last decorrelation: tensor(0.9530)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2953) local CE: tensor(0.2599) Feature CE: tensor(1.0169) KL: tensor(0.0931)
The last decorrelation: tensor(0.9256)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9605) local CE: tensor(0.1202) Feature CE: tensor(0.8096) KL: tensor(0.0327)
The last decorrelation: tensor(0.9980)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9431) local CE: tensor(0.1282) Feature CE: tensor(0.8157) KL: tensor(0.0798)
The last decorrelation: tensor(0.9193)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4480) local CE: tensor(0.4623) Feature CE: tensor(1.0295) KL: tensor(0.0707)
The last decorrelation: tensor(0.8859)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2298) local CE: tensor(0.9062) Feature CE: tensor(1.1831) KL: tensor(0.1578)
The last decorrelation: tensor(0.9827)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9544) local CE: tensor(0.0598) Feature CE: tensor(0.8729) KL: tensor(0.0825)
The last decorrelation: tensor(0.9516)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3983) local CE: tensor(0.2316) Feature CE: tensor(1.1193) KL: tensor(0.0770)
The last decorrelation: tensor(0.9744)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(4.2093) local CE: tensor(1.3811) Feature CE: tensor(1.7486) KL: tensor(0.0840)
The last decorrelation: tensor(0.9957)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.8870) local CE: tensor(0.0720) Feature CE: tensor(0.8556) KL: tensor(0.0985)
The last decorrelation: tensor(0.8567)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(4.2104) local CE: tensor(1.6618) Feature CE: tensor(1.4380) KL: tensor(0.1586)
The last decorrelation: tensor(0.9522)
Global Model Acc on global data: 0.5459789616559213 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  69  -------------
selected users: [4, 58, 20, 114, 31, 33, 94, 102, 129, 32, 119, 105, 8, 85, 145]
Current data/feature buff: torch.Size([44, 128, 20, 7]) torch.Size([44]) 44
Buffer classes: Counter({0: 11, 4: 11, 5: 10, 2: 8, 3: 3, 1: 1})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1399) local CE: tensor(0.8205) Feature CE: tensor(1.3081) KL: tensor(0.1290)
The last decorrelation: tensor(0.8966)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2538) local CE: tensor(1.0074) Feature CE: tensor(1.2492) KL: tensor(0.0885)
The last decorrelation: tensor(0.9088)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8699) local CE: tensor(0.6520) Feature CE: tensor(1.1887) KL: tensor(0.0756)
The last decorrelation: tensor(0.9536)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4173) local CE: tensor(0.7643) Feature CE: tensor(1.5170) KL: tensor(0.1777)
The last decorrelation: tensor(0.9577)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9786) local CE: tensor(0.0648) Feature CE: tensor(0.9756) KL: tensor(0.0553)
The last decorrelation: tensor(0.8754)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7821) local CE: tensor(0.4889) Feature CE: tensor(1.1663) KL: tensor(0.1697)
The last decorrelation: tensor(0.9662)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3571) local CE: tensor(0.3808) Feature CE: tensor(0.9846) KL: tensor(0.0621)
The last decorrelation: tensor(0.9299)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6527) local CE: tensor(0.4139) Feature CE: tensor(1.2214) KL: tensor(0.0464)
The last decorrelation: tensor(0.9694)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1931) local CE: tensor(0.2208) Feature CE: tensor(1.0338) KL: tensor(0.0550)
The last decorrelation: tensor(0.8827)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0340) local CE: tensor(0.1293) Feature CE: tensor(0.9151) KL: tensor(0.0446)
The last decorrelation: tensor(0.9539)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.8835) local CE: tensor(0.0555) Feature CE: tensor(0.8330) KL: tensor(0.0457)
The last decorrelation: tensor(0.9446)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5854) local CE: tensor(0.3147) Feature CE: tensor(1.2156) KL: tensor(0.0716)
The last decorrelation: tensor(0.9836)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9199) local CE: tensor(0.5448) Feature CE: tensor(1.2547) KL: tensor(0.1504)
The last decorrelation: tensor(0.9724)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4730) local CE: tensor(0.4438) Feature CE: tensor(0.9926) KL: tensor(0.0879)
The last decorrelation: tensor(0.9488)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0864) local CE: tensor(0.1475) Feature CE: tensor(1.0145) KL: tensor(0.0512)
The last decorrelation: tensor(0.8698)
Global Model Acc on global data: 0.48829317950458095 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  70  -------------
selected users: [18, 107, 91, 69, 104, 54, 14, 7, 20, 94, 96, 88, 136, 97, 16]
Current data/feature buff: torch.Size([111, 128, 20, 7]) torch.Size([111]) 111
Buffer classes: Counter({4: 47, 3: 28, 0: 19, 2: 7, 5: 7, 1: 3})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.8985) local CE: tensor(0.0773) Feature CE: tensor(0.8149) KL: tensor(0.0650)
The last decorrelation: tensor(0.9390)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6458) local CE: tensor(0.5624) Feature CE: tensor(1.1202) KL: tensor(0.0908)
The last decorrelation: tensor(0.8723)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.7863) local CE: tensor(1.2707) Feature CE: tensor(1.4108) KL: tensor(0.1522)
The last decorrelation: tensor(0.9526)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(4.5845) local CE: tensor(1.8116) Feature CE: tensor(1.7292) KL: tensor(0.0922)
The last decorrelation: tensor(0.9517)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1628) local CE: tensor(0.8798) Feature CE: tensor(1.1558) KL: tensor(0.1272)
The last decorrelation: tensor(1.0000)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5430) local CE: tensor(0.8954) Feature CE: tensor(1.5924) KL: tensor(0.1261)
The last decorrelation: tensor(0.9294)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1098) local CE: tensor(0.0933) Feature CE: tensor(1.0806) KL: tensor(0.0330)
The last decorrelation: tensor(0.9028)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4401) local CE: tensor(1.0297) Feature CE: tensor(1.3488) KL: tensor(0.0701)
The last decorrelation: tensor(0.9915)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9507) local CE: tensor(0.7067) Feature CE: tensor(1.1625) KL: tensor(0.1283)
The last decorrelation: tensor(0.9532)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7383) local CE: tensor(0.4090) Feature CE: tensor(1.1522) KL: tensor(0.2481)
The last decorrelation: tensor(0.9290)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5417) local CE: tensor(1.0451) Feature CE: tensor(1.5111) KL: tensor(0.1107)
The last decorrelation: tensor(0.8671)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5022) local CE: tensor(1.1225) Feature CE: tensor(1.1064) KL: tensor(0.3025)
The last decorrelation: tensor(0.9701)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6943) local CE: tensor(0.4744) Feature CE: tensor(1.1936) KL: tensor(0.0842)
The last decorrelation: tensor(0.9477)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9671) local CE: tensor(0.0508) Feature CE: tensor(1.0455) KL: tensor(0.0277)
The last decorrelation: tensor(0.8367)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5193) local CE: tensor(0.3411) Feature CE: tensor(1.1089) KL: tensor(0.1059)
The last decorrelation: tensor(0.9553)
Global Model Acc on global data: 0.5449609772650152 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  71  -------------
selected users: [132, 46, 53, 126, 59, 71, 4, 117, 135, 77, 147, 34, 47, 56, 38]
Current data/feature buff: torch.Size([46, 128, 20, 7]) torch.Size([46]) 46
Buffer classes: Counter({5: 12, 0: 12, 4: 11, 3: 5, 1: 4, 2: 2})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6001) local CE: tensor(0.3138) Feature CE: tensor(1.2273) KL: tensor(0.0623)
The last decorrelation: tensor(0.9967)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0845) local CE: tensor(0.8311) Feature CE: tensor(1.2915) KL: tensor(0.0549)
The last decorrelation: tensor(0.9069)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2654) local CE: tensor(0.9930) Feature CE: tensor(1.2427) KL: tensor(0.0541)
The last decorrelation: tensor(0.9530)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0917) local CE: tensor(0.0979) Feature CE: tensor(0.9650) KL: tensor(0.0757)
The last decorrelation: tensor(0.9531)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3676) local CE: tensor(0.7813) Feature CE: tensor(1.5620) KL: tensor(0.0340)
The last decorrelation: tensor(0.9881)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(4.7947) local CE: tensor(1.9028) Feature CE: tensor(1.8454) KL: tensor(0.1266)
The last decorrelation: tensor(0.9202)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4488) local CE: tensor(0.8910) Feature CE: tensor(1.5084) KL: tensor(0.1713)
The last decorrelation: tensor(0.8745)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9985) local CE: tensor(0.7894) Feature CE: tensor(1.2306) KL: tensor(0.0398)
The last decorrelation: tensor(0.9506)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3237) local CE: tensor(0.2169) Feature CE: tensor(1.1197) KL: tensor(0.0678)
The last decorrelation: tensor(0.9191)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.7472) local CE: tensor(1.2327) Feature CE: tensor(1.4729) KL: tensor(0.1226)
The last decorrelation: tensor(0.9197)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(4.5218) local CE: tensor(1.8124) Feature CE: tensor(1.6358) KL: tensor(0.1138)
The last decorrelation: tensor(0.9602)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5444) local CE: tensor(0.9070) Feature CE: tensor(1.3437) KL: tensor(0.2962)
The last decorrelation: tensor(0.9975)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4928) local CE: tensor(0.3895) Feature CE: tensor(1.0038) KL: tensor(0.1228)
The last decorrelation: tensor(0.9852)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4319) local CE: tensor(0.4115) Feature CE: tensor(1.0315) KL: tensor(0.0800)
The last decorrelation: tensor(0.8941)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0257) local CE: tensor(0.0843) Feature CE: tensor(1.0322) KL: tensor(0.0561)
The last decorrelation: tensor(0.8474)
Global Model Acc on global data: 0.6352222599253479 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  72  -------------
selected users: [20, 88, 125, 116, 141, 79, 89, 144, 4, 11, 34, 1, 84, 14, 30]
Current data/feature buff: torch.Size([44, 128, 20, 7]) torch.Size([44]) 44
Buffer classes: Counter({4: 15, 5: 10, 3: 7, 0: 7, 1: 5})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8602) local CE: tensor(0.6622) Feature CE: tensor(1.1723) KL: tensor(0.0723)
The last decorrelation: tensor(0.9535)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9395) local CE: tensor(0.7724) Feature CE: tensor(1.0672) KL: tensor(0.1263)
The last decorrelation: tensor(0.9703)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5414) local CE: tensor(0.5170) Feature CE: tensor(0.9963) KL: tensor(0.0628)
The last decorrelation: tensor(0.9654)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.6146) local CE: tensor(1.0193) Feature CE: tensor(1.5847) KL: tensor(0.0945)
The last decorrelation: tensor(0.9167)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5183) local CE: tensor(0.8822) Feature CE: tensor(1.6817) KL: tensor(0.0559)
The last decorrelation: tensor(0.8990)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5330) local CE: tensor(0.3377) Feature CE: tensor(1.3101) KL: tensor(0.0428)
The last decorrelation: tensor(0.8370)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1601) local CE: tensor(0.8785) Feature CE: tensor(1.2692) KL: tensor(0.0777)
The last decorrelation: tensor(0.9347)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.6611) local CE: tensor(0.9084) Feature CE: tensor(1.6715) KL: tensor(0.1011)
The last decorrelation: tensor(0.9802)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1434) local CE: tensor(0.6376) Feature CE: tensor(1.5297) KL: tensor(0.0921)
The last decorrelation: tensor(0.8825)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0226) local CE: tensor(0.8400) Feature CE: tensor(1.1436) KL: tensor(0.0965)
The last decorrelation: tensor(0.9424)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3687) local CE: tensor(0.7449) Feature CE: tensor(1.1602) KL: tensor(0.4661)
The last decorrelation: tensor(0.9975)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9276) local CE: tensor(0.7408) Feature CE: tensor(1.1205) KL: tensor(0.0776)
The last decorrelation: tensor(0.9888)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.7315) local CE: tensor(1.1576) Feature CE: tensor(1.6214) KL: tensor(0.0651)
The last decorrelation: tensor(0.8887)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2464) local CE: tensor(0.1222) Feature CE: tensor(1.1825) KL: tensor(0.0385)
The last decorrelation: tensor(0.9031)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9759) local CE: tensor(0.6266) Feature CE: tensor(1.3630) KL: tensor(0.1199)
The last decorrelation: tensor(0.8779)
Global Model Acc on global data: 0.7020699015948422 length of data: 2947
save a model
size of the global feature buffer: 15
-------------Round number:  73  -------------
selected users: [98, 40, 76, 29, 68, 134, 14, 142, 79, 52, 148, 107, 25, 21, 17]
Current data/feature buff: torch.Size([31, 128, 20, 7]) torch.Size([31]) 31
Buffer classes: Counter({1: 8, 2: 7, 3: 6, 0: 6, 5: 2, 4: 2})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3402) local CE: tensor(0.3618) Feature CE: tensor(1.0421) KL: tensor(0.0616)
The last decorrelation: tensor(0.8827)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2879) local CE: tensor(0.2187) Feature CE: tensor(1.0790) KL: tensor(0.0712)
The last decorrelation: tensor(0.9187)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1596) local CE: tensor(0.0660) Feature CE: tensor(1.0825) KL: tensor(0.0435)
The last decorrelation: tensor(0.9630)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1920) local CE: tensor(0.1516) Feature CE: tensor(1.0865) KL: tensor(0.0537)
The last decorrelation: tensor(0.8981)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3397) local CE: tensor(0.2488) Feature CE: tensor(1.0142) KL: tensor(0.0777)
The last decorrelation: tensor(0.9990)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6517) local CE: tensor(0.4878) Feature CE: tensor(1.1526) KL: tensor(0.1095)
The last decorrelation: tensor(0.9021)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1556) local CE: tensor(0.1996) Feature CE: tensor(0.9883) KL: tensor(0.0639)
The last decorrelation: tensor(0.9034)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0474) local CE: tensor(0.0986) Feature CE: tensor(1.0179) KL: tensor(0.0704)
The last decorrelation: tensor(0.8588)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2814) local CE: tensor(0.3418) Feature CE: tensor(1.0107) KL: tensor(0.0905)
The last decorrelation: tensor(0.8441)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1341) local CE: tensor(0.2403) Feature CE: tensor(0.9411) KL: tensor(0.0820)
The last decorrelation: tensor(0.8708)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4308) local CE: tensor(0.2589) Feature CE: tensor(1.2190) KL: tensor(0.0687)
The last decorrelation: tensor(0.8784)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3987) local CE: tensor(0.3417) Feature CE: tensor(1.1311) KL: tensor(0.0521)
The last decorrelation: tensor(0.8741)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2182) local CE: tensor(0.7746) Feature CE: tensor(1.3307) KL: tensor(0.1132)
The last decorrelation: tensor(0.9997)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2291) local CE: tensor(0.7635) Feature CE: tensor(1.4158) KL: tensor(0.0670)
The last decorrelation: tensor(0.9828)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0799) local CE: tensor(0.7431) Feature CE: tensor(1.3118) KL: tensor(0.0625)
The last decorrelation: tensor(0.9626)
Global Model Acc on global data: 0.5704105870376655 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  74  -------------
selected users: [149, 93, 123, 78, 17, 65, 108, 14, 141, 26, 105, 72, 96, 48, 44]
Current data/feature buff: torch.Size([85, 128, 20, 7]) torch.Size([85]) 85
Buffer classes: Counter({5: 30, 0: 19, 1: 18, 4: 14, 2: 3, 3: 1})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9294) local CE: tensor(0.7563) Feature CE: tensor(1.2046) KL: tensor(0.0786)
The last decorrelation: tensor(0.8899)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5741) local CE: tensor(0.4620) Feature CE: tensor(1.0061) KL: tensor(0.1079)
The last decorrelation: tensor(0.9980)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4714) local CE: tensor(0.3816) Feature CE: tensor(1.1152) KL: tensor(0.1122)
The last decorrelation: tensor(0.8623)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9613) local CE: tensor(0.1004) Feature CE: tensor(0.8174) KL: tensor(0.0440)
The last decorrelation: tensor(0.9996)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3894) local CE: tensor(0.9644) Feature CE: tensor(1.3696) KL: tensor(0.0922)
The last decorrelation: tensor(0.9633)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3000) local CE: tensor(0.3927) Feature CE: tensor(0.9123) KL: tensor(0.0577)
The last decorrelation: tensor(0.9282)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6046) local CE: tensor(0.4401) Feature CE: tensor(1.1120) KL: tensor(0.1024)
The last decorrelation: tensor(0.9501)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2393) local CE: tensor(0.2134) Feature CE: tensor(1.0299) KL: tensor(0.0910)
The last decorrelation: tensor(0.9045)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7946) local CE: tensor(0.5163) Feature CE: tensor(1.3014) KL: tensor(0.0770)
The last decorrelation: tensor(0.8999)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5490) local CE: tensor(0.4233) Feature CE: tensor(1.2425) KL: tensor(0.0666)
The last decorrelation: tensor(0.8158)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5093) local CE: tensor(0.2924) Feature CE: tensor(1.1587) KL: tensor(0.0747)
The last decorrelation: tensor(0.9837)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7878) local CE: tensor(0.5602) Feature CE: tensor(1.1973) KL: tensor(0.1193)
The last decorrelation: tensor(0.9108)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2553) local CE: tensor(0.2975) Feature CE: tensor(1.0075) KL: tensor(0.0735)
The last decorrelation: tensor(0.8718)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0496) local CE: tensor(0.1129) Feature CE: tensor(0.9202) KL: tensor(0.0864)
The last decorrelation: tensor(0.9300)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1275) local CE: tensor(0.2267) Feature CE: tensor(0.8560) KL: tensor(0.0593)
The last decorrelation: tensor(0.9644)
Global Model Acc on global data: 0.5704105870376655 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  75  -------------
selected users: [114, 125, 90, 97, 84, 35, 6, 51, 27, 63, 122, 28, 101, 47, 67]
Current data/feature buff: torch.Size([35, 128, 20, 7]) torch.Size([35]) 35
Buffer classes: Counter({5: 17, 1: 6, 2: 5, 3: 4, 4: 2, 0: 1})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4489) local CE: tensor(0.9047) Feature CE: tensor(1.2845) KL: tensor(0.3015)
The last decorrelation: tensor(0.9593)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1979) local CE: tensor(0.1501) Feature CE: tensor(1.0106) KL: tensor(0.0716)
The last decorrelation: tensor(0.9656)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2124) local CE: tensor(0.7867) Feature CE: tensor(1.2704) KL: tensor(0.1999)
The last decorrelation: tensor(0.9536)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1345) local CE: tensor(0.0894) Feature CE: tensor(1.1364) KL: tensor(0.0630)
The last decorrelation: tensor(0.8400)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6626) local CE: tensor(0.4758) Feature CE: tensor(1.2532) KL: tensor(0.0438)
The last decorrelation: tensor(0.8907)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6495) local CE: tensor(0.4424) Feature CE: tensor(1.2668) KL: tensor(0.0882)
The last decorrelation: tensor(0.8517)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5242) local CE: tensor(0.2600) Feature CE: tensor(1.2594) KL: tensor(0.0738)
The last decorrelation: tensor(0.9309)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4768) local CE: tensor(0.3031) Feature CE: tensor(1.2076) KL: tensor(0.0781)
The last decorrelation: tensor(0.8802)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3905) local CE: tensor(0.3413) Feature CE: tensor(1.1107) KL: tensor(0.0959)
The last decorrelation: tensor(0.8386)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5093) local CE: tensor(0.3796) Feature CE: tensor(1.1175) KL: tensor(0.1052)
The last decorrelation: tensor(0.9060)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3771) local CE: tensor(0.2536) Feature CE: tensor(1.1111) KL: tensor(0.1109)
The last decorrelation: tensor(0.8816)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4482) local CE: tensor(0.9665) Feature CE: tensor(1.3481) KL: tensor(0.1618)
The last decorrelation: tensor(0.9417)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5521) local CE: tensor(0.3498) Feature CE: tensor(1.2409) KL: tensor(0.0790)
The last decorrelation: tensor(0.8860)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0386) local CE: tensor(0.1432) Feature CE: tensor(0.8475) KL: tensor(0.0733)
The last decorrelation: tensor(0.9735)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4513) local CE: tensor(0.3938) Feature CE: tensor(1.1092) KL: tensor(0.0805)
The last decorrelation: tensor(0.8675)
Global Model Acc on global data: 0.6148625721072277 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  76  -------------
selected users: [46, 81, 32, 102, 104, 55, 13, 72, 61, 77, 33, 110, 87, 85, 18]
Current data/feature buff: torch.Size([59, 128, 20, 7]) torch.Size([59]) 59
Buffer classes: Counter({0: 19, 2: 12, 3: 10, 5: 9, 4: 6, 1: 3})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1698) local CE: tensor(0.8589) Feature CE: tensor(1.3357) KL: tensor(0.0679)
The last decorrelation: tensor(0.9073)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1713) local CE: tensor(0.2514) Feature CE: tensor(0.9987) KL: tensor(0.0609)
The last decorrelation: tensor(0.8640)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2787) local CE: tensor(0.2117) Feature CE: tensor(1.0604) KL: tensor(0.0557)
The last decorrelation: tensor(0.9570)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5447) local CE: tensor(0.3722) Feature CE: tensor(1.1472) KL: tensor(0.0682)
The last decorrelation: tensor(0.9444)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8952) local CE: tensor(0.6199) Feature CE: tensor(1.1161) KL: tensor(0.1592)
The last decorrelation: tensor(1.0000)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8625) local CE: tensor(0.6553) Feature CE: tensor(1.2101) KL: tensor(0.0679)
The last decorrelation: tensor(0.9109)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2216) local CE: tensor(0.7353) Feature CE: tensor(1.3713) KL: tensor(0.1262)
The last decorrelation: tensor(0.9887)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6844) local CE: tensor(0.5843) Feature CE: tensor(1.0779) KL: tensor(0.1111)
The last decorrelation: tensor(0.9108)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1562) local CE: tensor(0.1684) Feature CE: tensor(1.0467) KL: tensor(0.0765)
The last decorrelation: tensor(0.8565)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6032) local CE: tensor(0.4935) Feature CE: tensor(1.0544) KL: tensor(0.1351)
The last decorrelation: tensor(0.9204)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6267) local CE: tensor(0.3315) Feature CE: tensor(1.1872) KL: tensor(0.1543)
The last decorrelation: tensor(0.9622)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7047) local CE: tensor(0.5061) Feature CE: tensor(1.1221) KL: tensor(0.1687)
The last decorrelation: tensor(0.9240)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3570) local CE: tensor(0.2135) Feature CE: tensor(1.1165) KL: tensor(0.0518)
The last decorrelation: tensor(0.9788)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5217) local CE: tensor(0.3437) Feature CE: tensor(1.1691) KL: tensor(0.0598)
The last decorrelation: tensor(0.9492)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1361) local CE: tensor(0.1122) Feature CE: tensor(1.0222) KL: tensor(0.0598)
The last decorrelation: tensor(0.9395)
Global Model Acc on global data: 0.5544621649134713 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  77  -------------
selected users: [82, 133, 113, 93, 5, 114, 128, 119, 33, 94, 13, 134, 26, 14, 49]
Current data/feature buff: torch.Size([79, 128, 20, 7]) torch.Size([79]) 79
Buffer classes: Counter({4: 25, 3: 25, 5: 10, 2: 10, 1: 5, 0: 4})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5466) local CE: tensor(0.1939) Feature CE: tensor(1.4012) KL: tensor(0.0265)
The last decorrelation: tensor(0.9250)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0718) local CE: tensor(0.7763) Feature CE: tensor(1.2135) KL: tensor(0.1118)
The last decorrelation: tensor(0.9702)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4244) local CE: tensor(0.2723) Feature CE: tensor(1.1138) KL: tensor(0.0818)
The last decorrelation: tensor(0.9585)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3057) local CE: tensor(0.1354) Feature CE: tensor(1.0768) KL: tensor(0.0954)
The last decorrelation: tensor(0.9980)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1112) local CE: tensor(0.2236) Feature CE: tensor(0.8964) KL: tensor(0.0721)
The last decorrelation: tensor(0.9189)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6406) local CE: tensor(0.4592) Feature CE: tensor(1.0539) KL: tensor(0.1697)
The last decorrelation: tensor(0.9580)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5648) local CE: tensor(0.3842) Feature CE: tensor(1.2054) KL: tensor(0.0833)
The last decorrelation: tensor(0.9003)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9789) local CE: tensor(0.0939) Feature CE: tensor(0.8752) KL: tensor(0.0536)
The last decorrelation: tensor(0.9559)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7649) local CE: tensor(0.4731) Feature CE: tensor(1.1873) KL: tensor(0.1528)
The last decorrelation: tensor(0.9568)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4897) local CE: tensor(0.2783) Feature CE: tensor(1.2048) KL: tensor(0.0769)
The last decorrelation: tensor(0.9296)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0347) local CE: tensor(0.7475) Feature CE: tensor(1.2183) KL: tensor(0.0801)
The last decorrelation: tensor(0.9888)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9057) local CE: tensor(0.7091) Feature CE: tensor(1.1674) KL: tensor(0.1273)
The last decorrelation: tensor(0.9025)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2531) local CE: tensor(0.2522) Feature CE: tensor(1.1432) KL: tensor(0.0447)
The last decorrelation: tensor(0.8123)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2537) local CE: tensor(0.1025) Feature CE: tensor(1.1890) KL: tensor(0.0579)
The last decorrelation: tensor(0.9040)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6426) local CE: tensor(0.3425) Feature CE: tensor(1.2556) KL: tensor(0.0776)
The last decorrelation: tensor(0.9667)
Global Model Acc on global data: 0.496776382762131 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  78  -------------
selected users: [128, 131, 145, 50, 95, 94, 99, 33, 61, 144, 126, 70, 129, 30, 53]
Current data/feature buff: torch.Size([69, 128, 20, 7]) torch.Size([69]) 69
Buffer classes: Counter({4: 36, 3: 16, 1: 8, 0: 5, 2: 4})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5316) local CE: tensor(0.3729) Feature CE: tensor(1.1975) KL: tensor(0.0713)
The last decorrelation: tensor(0.8914)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9416) local CE: tensor(0.6669) Feature CE: tensor(1.1453) KL: tensor(0.1817)
The last decorrelation: tensor(0.9477)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2205) local CE: tensor(0.1474) Feature CE: tensor(1.0452) KL: tensor(0.1468)
The last decorrelation: tensor(0.8777)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9304) local CE: tensor(0.6097) Feature CE: tensor(1.1977) KL: tensor(0.1670)
The last decorrelation: tensor(0.9561)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7974) local CE: tensor(0.4525) Feature CE: tensor(1.4031) KL: tensor(0.0746)
The last decorrelation: tensor(0.8673)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4828) local CE: tensor(0.3641) Feature CE: tensor(1.1425) KL: tensor(0.0471)
The last decorrelation: tensor(0.9292)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8715) local CE: tensor(0.6007) Feature CE: tensor(1.2455) KL: tensor(0.1399)
The last decorrelation: tensor(0.8858)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3877) local CE: tensor(0.3120) Feature CE: tensor(0.9846) KL: tensor(0.1314)
The last decorrelation: tensor(0.9596)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3064) local CE: tensor(0.2215) Feature CE: tensor(1.1517) KL: tensor(0.0707)
The last decorrelation: tensor(0.8600)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4456) local CE: tensor(0.7191) Feature CE: tensor(1.6014) KL: tensor(0.1451)
The last decorrelation: tensor(0.9801)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4107) local CE: tensor(0.2122) Feature CE: tensor(1.1946) KL: tensor(0.0507)
The last decorrelation: tensor(0.9532)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6115) local CE: tensor(0.4521) Feature CE: tensor(0.9908) KL: tensor(0.2036)
The last decorrelation: tensor(0.9745)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6186) local CE: tensor(0.3114) Feature CE: tensor(1.2562) KL: tensor(0.1669)
The last decorrelation: tensor(0.8943)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6405) local CE: tensor(0.4317) Feature CE: tensor(1.1917) KL: tensor(0.1491)
The last decorrelation: tensor(0.8807)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4116) local CE: tensor(1.0559) Feature CE: tensor(1.3056) KL: tensor(0.0870)
The last decorrelation: tensor(0.9513)
Global Model Acc on global data: 0.5062775704105871 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  79  -------------
selected users: [29, 128, 52, 84, 53, 103, 32, 61, 125, 92, 11, 39, 65, 91, 81]
Current data/feature buff: torch.Size([49, 128, 20, 7]) torch.Size([49]) 49
Buffer classes: Counter({2: 14, 1: 12, 5: 9, 3: 7, 0: 4, 4: 3})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2530) local CE: tensor(0.1538) Feature CE: tensor(1.1215) KL: tensor(0.0826)
The last decorrelation: tensor(0.9040)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4625) local CE: tensor(0.3165) Feature CE: tensor(1.0799) KL: tensor(0.1743)
The last decorrelation: tensor(0.8859)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1934) local CE: tensor(0.1789) Feature CE: tensor(1.0000) KL: tensor(0.1401)
The last decorrelation: tensor(0.8670)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6073) local CE: tensor(0.4831) Feature CE: tensor(1.0824) KL: tensor(0.1544)
The last decorrelation: tensor(0.8883)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4721) local CE: tensor(0.9992) Feature CE: tensor(1.4397) KL: tensor(0.0765)
The last decorrelation: tensor(0.9543)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0679) local CE: tensor(0.1455) Feature CE: tensor(0.9749) KL: tensor(0.1116)
The last decorrelation: tensor(0.8387)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2463) local CE: tensor(0.1167) Feature CE: tensor(1.1161) KL: tensor(0.0761)
The last decorrelation: tensor(0.9263)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2101) local CE: tensor(0.1862) Feature CE: tensor(1.0121) KL: tensor(0.1497)
The last decorrelation: tensor(0.8637)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3815) local CE: tensor(0.8133) Feature CE: tensor(1.4639) KL: tensor(0.1389)
The last decorrelation: tensor(0.9655)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2078) local CE: tensor(0.1763) Feature CE: tensor(1.0321) KL: tensor(0.1389)
The last decorrelation: tensor(0.8533)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0372) local CE: tensor(0.7270) Feature CE: tensor(1.2954) KL: tensor(0.0720)
The last decorrelation: tensor(0.9428)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6578) local CE: tensor(0.2292) Feature CE: tensor(1.3135) KL: tensor(0.1530)
The last decorrelation: tensor(0.9622)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6451) local CE: tensor(0.4233) Feature CE: tensor(1.1898) KL: tensor(0.0976)
The last decorrelation: tensor(0.9255)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2361) local CE: tensor(0.8508) Feature CE: tensor(1.2734) KL: tensor(0.1591)
The last decorrelation: tensor(0.9528)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4604) local CE: tensor(0.3379) Feature CE: tensor(1.1424) KL: tensor(0.1205)
The last decorrelation: tensor(0.8600)
Global Model Acc on global data: 0.5978961655921275 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  80  -------------
selected users: [49, 42, 36, 74, 5, 99, 83, 18, 14, 29, 125, 82, 60, 28, 109]
Current data/feature buff: torch.Size([113, 128, 20, 7]) torch.Size([113]) 113
Buffer classes: Counter({2: 33, 1: 28, 4: 24, 5: 18, 0: 5, 3: 5})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2423) local CE: tensor(0.2278) Feature CE: tensor(0.9736) KL: tensor(0.0744)
The last decorrelation: tensor(0.9666)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2458) local CE: tensor(0.3119) Feature CE: tensor(1.0134) KL: tensor(0.0757)
The last decorrelation: tensor(0.8438)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2959) local CE: tensor(0.3383) Feature CE: tensor(0.9723) KL: tensor(0.0979)
The last decorrelation: tensor(0.9003)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0418) local CE: tensor(0.1728) Feature CE: tensor(0.9278) KL: tensor(0.0685)
The last decorrelation: tensor(0.8716)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2167) local CE: tensor(0.2183) Feature CE: tensor(0.9894) KL: tensor(0.0903)
The last decorrelation: tensor(0.9186)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4202) local CE: tensor(0.3769) Feature CE: tensor(1.0793) KL: tensor(0.0785)
The last decorrelation: tensor(0.8857)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3912) local CE: tensor(0.3371) Feature CE: tensor(1.1068) KL: tensor(0.0963)
The last decorrelation: tensor(0.8303)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0717) local CE: tensor(0.0927) Feature CE: tensor(0.9581) KL: tensor(0.0781)
The last decorrelation: tensor(0.9408)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6910) local CE: tensor(0.4112) Feature CE: tensor(1.2674) KL: tensor(0.1077)
The last decorrelation: tensor(0.9044)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0538) local CE: tensor(0.1471) Feature CE: tensor(0.9267) KL: tensor(0.0753)
The last decorrelation: tensor(0.9064)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5075) local CE: tensor(0.3873) Feature CE: tensor(1.1001) KL: tensor(0.0546)
The last decorrelation: tensor(0.9655)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8136) local CE: tensor(0.4597) Feature CE: tensor(1.3045) KL: tensor(0.1242)
The last decorrelation: tensor(0.9250)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0667) local CE: tensor(0.0906) Feature CE: tensor(0.9657) KL: tensor(0.0624)
The last decorrelation: tensor(0.9606)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1950) local CE: tensor(0.8557) Feature CE: tensor(1.3005) KL: tensor(0.0679)
The last decorrelation: tensor(0.9858)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0170) local CE: tensor(0.1415) Feature CE: tensor(0.9168) KL: tensor(0.0817)
The last decorrelation: tensor(0.8716)
Global Model Acc on global data: 0.5649813369528334 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  81  -------------
selected users: [117, 32, 130, 86, 13, 24, 78, 40, 147, 21, 82, 93, 118, 134, 39]
Current data/feature buff: torch.Size([77, 128, 20, 7]) torch.Size([77]) 77
Buffer classes: Counter({4: 24, 1: 20, 5: 14, 2: 10, 3: 6, 0: 3})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9809) local CE: tensor(0.7815) Feature CE: tensor(1.1986) KL: tensor(0.0644)
The last decorrelation: tensor(0.9359)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9606) local CE: tensor(0.1029) Feature CE: tensor(0.8558) KL: tensor(0.0533)
The last decorrelation: tensor(0.9494)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9843) local CE: tensor(0.6547) Feature CE: tensor(1.2360) KL: tensor(0.1210)
The last decorrelation: tensor(0.9788)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5984) local CE: tensor(0.4347) Feature CE: tensor(1.0133) KL: tensor(0.1831)
The last decorrelation: tensor(0.9628)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1536) local CE: tensor(0.6399) Feature CE: tensor(1.3806) KL: tensor(0.1442)
The last decorrelation: tensor(0.9888)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8724) local CE: tensor(0.5944) Feature CE: tensor(1.2354) KL: tensor(0.1092)
The last decorrelation: tensor(0.9268)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6537) local CE: tensor(0.3730) Feature CE: tensor(1.1770) KL: tensor(0.1041)
The last decorrelation: tensor(0.9996)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5205) local CE: tensor(0.3700) Feature CE: tensor(1.1657) KL: tensor(0.0660)
The last decorrelation: tensor(0.9184)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3541) local CE: tensor(0.2710) Feature CE: tensor(1.0387) KL: tensor(0.0852)
The last decorrelation: tensor(0.9596)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0490) local CE: tensor(0.8007) Feature CE: tensor(1.2240) KL: tensor(0.0416)
The last decorrelation: tensor(0.9827)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9290) local CE: tensor(0.4496) Feature CE: tensor(1.5013) KL: tensor(0.0531)
The last decorrelation: tensor(0.9249)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0527) local CE: tensor(0.0798) Feature CE: tensor(0.9389) KL: tensor(0.0359)
The last decorrelation: tensor(0.9980)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8524) local CE: tensor(0.5716) Feature CE: tensor(1.2613) KL: tensor(0.0709)
The last decorrelation: tensor(0.9697)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2499) local CE: tensor(0.3413) Feature CE: tensor(0.8715) KL: tensor(0.1362)
The last decorrelation: tensor(0.9010)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3109) local CE: tensor(0.2263) Feature CE: tensor(1.0577) KL: tensor(0.0647)
The last decorrelation: tensor(0.9622)
Global Model Acc on global data: 0.5520868680013573 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  82  -------------
selected users: [124, 114, 32, 2, 26, 77, 61, 76, 119, 72, 58, 134, 44, 20, 7]
Current data/feature buff: torch.Size([45, 128, 20, 7]) torch.Size([45]) 45
Buffer classes: Counter({4: 22, 3: 10, 5: 9, 2: 2, 0: 1, 1: 1})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3677) local CE: tensor(0.3572) Feature CE: tensor(0.9595) KL: tensor(0.0870)
The last decorrelation: tensor(0.9784)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0482) local CE: tensor(0.5501) Feature CE: tensor(1.3261) KL: tensor(0.2119)
The last decorrelation: tensor(0.9587)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9379) local CE: tensor(0.1176) Feature CE: tensor(0.8146) KL: tensor(0.0634)
The last decorrelation: tensor(0.9238)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7483) local CE: tensor(0.3352) Feature CE: tensor(1.4486) KL: tensor(0.0721)
The last decorrelation: tensor(0.8884)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5224) local CE: tensor(0.3238) Feature CE: tensor(1.3307) KL: tensor(0.0561)
The last decorrelation: tensor(0.8105)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6672) local CE: tensor(0.3178) Feature CE: tensor(1.3496) KL: tensor(0.0804)
The last decorrelation: tensor(0.9197)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3710) local CE: tensor(0.1889) Feature CE: tensor(1.2531) KL: tensor(0.0636)
The last decorrelation: tensor(0.8662)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0478) local CE: tensor(0.1041) Feature CE: tensor(0.9186) KL: tensor(0.0648)
The last decorrelation: tensor(0.9650)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.8682) local CE: tensor(0.0797) Feature CE: tensor(0.7710) KL: tensor(0.0709)
The last decorrelation: tensor(0.9473)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9679) local CE: tensor(0.7111) Feature CE: tensor(1.1865) KL: tensor(0.1595)
The last decorrelation: tensor(0.9109)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3351) local CE: tensor(1.0531) Feature CE: tensor(1.2140) KL: tensor(0.1594)
The last decorrelation: tensor(0.9089)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3237) local CE: tensor(0.2692) Feature CE: tensor(1.0275) KL: tensor(0.1262)
The last decorrelation: tensor(0.9009)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3602) local CE: tensor(0.3079) Feature CE: tensor(0.9594) KL: tensor(0.1059)
The last decorrelation: tensor(0.9954)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9766) local CE: tensor(0.6992) Feature CE: tensor(1.1902) KL: tensor(0.1338)
The last decorrelation: tensor(0.9535)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3365) local CE: tensor(0.8915) Feature CE: tensor(1.1708) KL: tensor(0.2826)
The last decorrelation: tensor(0.9916)
Global Model Acc on global data: 0.5463182897862233 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  83  -------------
selected users: [122, 18, 145, 31, 120, 106, 35, 17, 26, 104, 11, 84, 126, 114, 147]
Current data/feature buff: torch.Size([110, 128, 20, 7]) torch.Size([110]) 110
Buffer classes: Counter({4: 46, 5: 32, 2: 14, 3: 8, 1: 6, 0: 4})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8669) local CE: tensor(0.5308) Feature CE: tensor(1.2870) KL: tensor(0.1518)
The last decorrelation: tensor(0.8970)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9233) local CE: tensor(0.0904) Feature CE: tensor(0.8152) KL: tensor(0.0729)
The last decorrelation: tensor(0.9511)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4532) local CE: tensor(0.2609) Feature CE: tensor(1.2493) KL: tensor(0.0711)
The last decorrelation: tensor(0.8683)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5268) local CE: tensor(0.2279) Feature CE: tensor(1.3102) KL: tensor(0.1032)
The last decorrelation: tensor(0.8838)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9084) local CE: tensor(0.8234) Feature CE: tensor(1.1252) KL: tensor(0.0322)
The last decorrelation: tensor(0.9275)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3747) local CE: tensor(0.3624) Feature CE: tensor(1.0151) KL: tensor(0.0522)
The last decorrelation: tensor(0.9449)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9853) local CE: tensor(0.6744) Feature CE: tensor(1.3855) KL: tensor(0.0758)
The last decorrelation: tensor(0.8489)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1344) local CE: tensor(0.7942) Feature CE: tensor(1.2541) KL: tensor(0.1237)
The last decorrelation: tensor(0.9625)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0380) local CE: tensor(0.7575) Feature CE: tensor(1.4258) KL: tensor(0.0436)
The last decorrelation: tensor(0.8111)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3682) local CE: tensor(0.8002) Feature CE: tensor(1.4641) KL: tensor(0.1040)
The last decorrelation: tensor(1.0000)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7547) local CE: tensor(0.7574) Feature CE: tensor(1.0197) KL: tensor(0.0356)
The last decorrelation: tensor(0.9421)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.8914) local CE: tensor(1.1439) Feature CE: tensor(1.7750) KL: tensor(0.0867)
The last decorrelation: tensor(0.8867)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5162) local CE: tensor(0.6569) Feature CE: tensor(1.7994) KL: tensor(0.1065)
The last decorrelation: tensor(0.9533)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9770) local CE: tensor(0.4769) Feature CE: tensor(1.3868) KL: tensor(0.1553)
The last decorrelation: tensor(0.9566)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.8844) local CE: tensor(1.1745) Feature CE: tensor(1.6637) KL: tensor(0.0872)
The last decorrelation: tensor(0.9593)
Global Model Acc on global data: 0.5147607736681371 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  84  -------------
selected users: [40, 101, 135, 21, 8, 35, 79, 31, 1, 50, 120, 113, 146, 25, 37]
Current data/feature buff: torch.Size([44, 128, 20, 7]) torch.Size([44]) 44
Buffer classes: Counter({0: 17, 4: 15, 2: 4, 3: 4, 5: 2, 1: 2})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1084) local CE: tensor(0.1685) Feature CE: tensor(0.9031) KL: tensor(0.1191)
The last decorrelation: tensor(0.9176)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4508) local CE: tensor(0.3379) Feature CE: tensor(1.0827) KL: tensor(0.1556)
The last decorrelation: tensor(0.8754)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2403) local CE: tensor(0.2867) Feature CE: tensor(0.8376) KL: tensor(0.1971)
The last decorrelation: tensor(0.9188)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8794) local CE: tensor(0.6600) Feature CE: tensor(1.1523) KL: tensor(0.0845)
The last decorrelation: tensor(0.9826)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6980) local CE: tensor(0.4146) Feature CE: tensor(1.1773) KL: tensor(0.1420)
The last decorrelation: tensor(0.9642)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5639) local CE: tensor(0.4473) Feature CE: tensor(1.1047) KL: tensor(0.1627)
The last decorrelation: tensor(0.8490)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2264) local CE: tensor(0.3161) Feature CE: tensor(0.9511) KL: tensor(0.1235)
The last decorrelation: tensor(0.8326)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.8461) local CE: tensor(0.0674) Feature CE: tensor(0.7906) KL: tensor(0.1066)
The last decorrelation: tensor(0.8831)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8332) local CE: tensor(0.6860) Feature CE: tensor(1.0795) KL: tensor(0.0790)
The last decorrelation: tensor(0.9887)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2899) local CE: tensor(0.8105) Feature CE: tensor(1.3213) KL: tensor(0.2026)
The last decorrelation: tensor(0.9558)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1647) local CE: tensor(0.8756) Feature CE: tensor(1.2405) KL: tensor(0.1213)
The last decorrelation: tensor(0.9271)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6375) local CE: tensor(0.4109) Feature CE: tensor(1.1368) KL: tensor(0.1314)
The last decorrelation: tensor(0.9277)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5593) local CE: tensor(0.3461) Feature CE: tensor(1.0800) KL: tensor(0.2139)
The last decorrelation: tensor(0.9191)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.8718) local CE: tensor(1.0586) Feature CE: tensor(1.5315) KL: tensor(0.2820)
The last decorrelation: tensor(0.9997)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9434) local CE: tensor(0.1288) Feature CE: tensor(0.7623) KL: tensor(0.1571)
The last decorrelation: tensor(0.8978)
Global Model Acc on global data: 0.47438072616219884 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  85  -------------
selected users: [137, 146, 92, 10, 102, 124, 48, 88, 40, 23, 46, 70, 25, 43, 145]
Current data/feature buff: torch.Size([56, 128, 20, 7]) torch.Size([56]) 56
Buffer classes: Counter({0: 29, 3: 21, 2: 5, 4: 1})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1455) local CE: tensor(0.7074) Feature CE: tensor(1.2670) KL: tensor(0.2272)
The last decorrelation: tensor(0.9431)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.8529) local CE: tensor(0.2217) Feature CE: tensor(0.5771) KL: tensor(0.1349)
The last decorrelation: tensor(0.9190)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0903) local CE: tensor(0.2196) Feature CE: tensor(0.9077) KL: tensor(0.1072)
The last decorrelation: tensor(0.8526)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2007) local CE: tensor(0.8216) Feature CE: tensor(1.1945) KL: tensor(0.2036)
The last decorrelation: tensor(0.9929)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.8966) local CE: tensor(0.1174) Feature CE: tensor(0.7375) KL: tensor(0.0745)
The last decorrelation: tensor(0.9594)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0747) local CE: tensor(0.2737) Feature CE: tensor(0.7508) KL: tensor(0.0904)
The last decorrelation: tensor(0.9520)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.6646) local CE: tensor(0.0946) Feature CE: tensor(0.5595) KL: tensor(0.0826)
The last decorrelation: tensor(0.9277)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6351) local CE: tensor(0.4494) Feature CE: tensor(1.0093) KL: tensor(0.1983)
The last decorrelation: tensor(0.9745)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9713) local CE: tensor(0.1150) Feature CE: tensor(0.8248) KL: tensor(0.1141)
The last decorrelation: tensor(0.9174)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0287) local CE: tensor(0.7565) Feature CE: tensor(1.1180) KL: tensor(0.1552)
The last decorrelation: tensor(0.9990)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9062) local CE: tensor(0.7476) Feature CE: tensor(1.1298) KL: tensor(0.1225)
The last decorrelation: tensor(0.9062)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9922) local CE: tensor(0.6170) Feature CE: tensor(1.1699) KL: tensor(0.2545)
The last decorrelation: tensor(0.9667)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1550) local CE: tensor(0.7717) Feature CE: tensor(1.2887) KL: tensor(0.0948)
The last decorrelation: tensor(0.9997)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3794) local CE: tensor(0.9040) Feature CE: tensor(1.3890) KL: tensor(0.1890)
The last decorrelation: tensor(0.8976)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.7859) local CE: tensor(0.1020) Feature CE: tensor(0.7312) KL: tensor(0.0929)
The last decorrelation: tensor(0.8776)
Global Model Acc on global data: 0.45775364777740074 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  86  -------------
selected users: [32, 113, 30, 61, 1, 130, 55, 132, 128, 59, 8, 84, 138, 39, 72]
Current data/feature buff: torch.Size([46, 128, 20, 7]) torch.Size([46]) 46
Buffer classes: Counter({3: 23, 2: 10, 5: 5, 4: 4, 0: 3, 1: 1})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2208) local CE: tensor(0.2008) Feature CE: tensor(0.9786) KL: tensor(0.0950)
The last decorrelation: tensor(0.9444)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0269) local CE: tensor(0.1439) Feature CE: tensor(0.7840) KL: tensor(0.1222)
The last decorrelation: tensor(0.9706)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3207) local CE: tensor(0.8772) Feature CE: tensor(1.4529) KL: tensor(0.1311)
The last decorrelation: tensor(0.8460)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1192) local CE: tensor(0.2015) Feature CE: tensor(0.9573) KL: tensor(0.0991)
The last decorrelation: tensor(0.8589)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0630) local CE: tensor(0.8176) Feature CE: tensor(1.1492) KL: tensor(0.1074)
The last decorrelation: tensor(0.9887)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0837) local CE: tensor(0.7896) Feature CE: tensor(1.1181) KL: tensor(0.2035)
The last decorrelation: tensor(0.9741)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9753) local CE: tensor(0.7439) Feature CE: tensor(1.1752) KL: tensor(0.1237)
The last decorrelation: tensor(0.9508)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4583) local CE: tensor(0.0568) Feature CE: tensor(1.2520) KL: tensor(0.1528)
The last decorrelation: tensor(0.9967)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9562) local CE: tensor(0.6839) Feature CE: tensor(1.2524) KL: tensor(0.1299)
The last decorrelation: tensor(0.8956)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9422) local CE: tensor(0.7123) Feature CE: tensor(1.1729) KL: tensor(0.0697)
The last decorrelation: tensor(0.9887)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9125) local CE: tensor(0.1272) Feature CE: tensor(0.7442) KL: tensor(0.0745)
The last decorrelation: tensor(0.9716)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(4.3939) local CE: tensor(1.7728) Feature CE: tensor(1.6493) KL: tensor(0.0869)
The last decorrelation: tensor(0.8856)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3137) local CE: tensor(0.9814) Feature CE: tensor(1.2444) KL: tensor(0.1070)
The last decorrelation: tensor(0.9809)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7218) local CE: tensor(0.3613) Feature CE: tensor(1.1762) KL: tensor(0.2223)
The last decorrelation: tensor(0.9620)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4235) local CE: tensor(0.4135) Feature CE: tensor(0.9812) KL: tensor(0.1186)
The last decorrelation: tensor(0.9103)
Global Model Acc on global data: 0.4706481167288768 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  87  -------------
selected users: [7, 130, 111, 122, 132, 50, 38, 87, 78, 56, 18, 28, 29, 83, 32]
Current data/feature buff: torch.Size([76, 128, 20, 7]) torch.Size([76]) 76
Buffer classes: Counter({3: 25, 4: 13, 1: 13, 5: 12, 2: 10, 0: 3})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7859) local CE: tensor(0.7336) Feature CE: tensor(0.9937) KL: tensor(0.0670)
The last decorrelation: tensor(0.9917)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1977) local CE: tensor(0.7338) Feature CE: tensor(1.3192) KL: tensor(0.1741)
The last decorrelation: tensor(0.9775)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4825) local CE: tensor(0.3802) Feature CE: tensor(1.0217) KL: tensor(0.0848)
The last decorrelation: tensor(0.9959)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8647) local CE: tensor(0.4077) Feature CE: tensor(1.3895) KL: tensor(0.1594)
The last decorrelation: tensor(0.9191)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4587) local CE: tensor(0.0927) Feature CE: tensor(1.2182) KL: tensor(0.1511)
The last decorrelation: tensor(0.9966)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.5703) local CE: tensor(1.0185) Feature CE: tensor(1.4498) KL: tensor(0.1462)
The last decorrelation: tensor(0.9559)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3745) local CE: tensor(0.1518) Feature CE: tensor(1.3030) KL: tensor(0.0649)
The last decorrelation: tensor(0.8571)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8389) local CE: tensor(0.4990) Feature CE: tensor(1.2373) KL: tensor(0.1335)
The last decorrelation: tensor(0.9776)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3030) local CE: tensor(0.8841) Feature CE: tensor(1.3002) KL: tensor(0.1191)
The last decorrelation: tensor(0.9996)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7123) local CE: tensor(0.4523) Feature CE: tensor(1.2762) KL: tensor(0.0865)
The last decorrelation: tensor(0.8868)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3744) local CE: tensor(0.2132) Feature CE: tensor(1.1354) KL: tensor(0.0833)
The last decorrelation: tensor(0.9485)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9815) local CE: tensor(0.6945) Feature CE: tensor(1.2175) KL: tensor(0.0982)
The last decorrelation: tensor(0.9473)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4314) local CE: tensor(0.2738) Feature CE: tensor(1.1416) KL: tensor(0.1166)
The last decorrelation: tensor(0.8933)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4469) local CE: tensor(0.2494) Feature CE: tensor(1.2943) KL: tensor(0.0695)
The last decorrelation: tensor(0.8376)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4369) local CE: tensor(0.3184) Feature CE: tensor(1.0899) KL: tensor(0.0828)
The last decorrelation: tensor(0.9548)
Global Model Acc on global data: 0.5755005089921954 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  88  -------------
selected users: [84, 120, 39, 30, 52, 20, 57, 117, 134, 95, 15, 55, 60, 116, 121]
Current data/feature buff: torch.Size([64, 128, 20, 7]) torch.Size([64]) 64
Buffer classes: Counter({4: 35, 0: 10, 5: 9, 3: 7, 1: 3})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3238) local CE: tensor(0.8879) Feature CE: tensor(1.5004) KL: tensor(0.0497)
The last decorrelation: tensor(0.8874)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7774) local CE: tensor(0.7683) Feature CE: tensor(1.0594) KL: tensor(0.0223)
The last decorrelation: tensor(0.9274)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3592) local CE: tensor(0.2032) Feature CE: tensor(1.1249) KL: tensor(0.0692)
The last decorrelation: tensor(0.9619)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7905) local CE: tensor(0.5202) Feature CE: tensor(1.2933) KL: tensor(0.1049)
The last decorrelation: tensor(0.8805)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3939) local CE: tensor(0.2902) Feature CE: tensor(1.1573) KL: tensor(0.0748)
The last decorrelation: tensor(0.8763)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2041) local CE: tensor(0.8336) Feature CE: tensor(1.2702) KL: tensor(0.1473)
The last decorrelation: tensor(0.9531)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1286) local CE: tensor(0.1089) Feature CE: tensor(1.0761) KL: tensor(0.0529)
The last decorrelation: tensor(0.8946)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5280) local CE: tensor(0.6834) Feature CE: tensor(0.8717) KL: tensor(0.0366)
The last decorrelation: tensor(0.9243)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7892) local CE: tensor(0.6366) Feature CE: tensor(1.1469) KL: tensor(0.1055)
The last decorrelation: tensor(0.9005)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7032) local CE: tensor(0.3903) Feature CE: tensor(1.3810) KL: tensor(0.0660)
The last decorrelation: tensor(0.8660)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2152) local CE: tensor(0.2625) Feature CE: tensor(0.9551) KL: tensor(0.0520)
The last decorrelation: tensor(0.9662)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9656) local CE: tensor(0.7352) Feature CE: tensor(1.1688) KL: tensor(0.1295)
The last decorrelation: tensor(0.9273)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1268) local CE: tensor(0.1763) Feature CE: tensor(0.9430) KL: tensor(0.0671)
The last decorrelation: tensor(0.9292)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2904) local CE: tensor(0.8972) Feature CE: tensor(1.3857) KL: tensor(0.0921)
The last decorrelation: tensor(0.9166)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3498) local CE: tensor(0.2572) Feature CE: tensor(1.0631) KL: tensor(0.0837)
The last decorrelation: tensor(0.9459)
Global Model Acc on global data: 0.5717678995588734 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  89  -------------
selected users: [103, 116, 14, 32, 142, 87, 117, 80, 120, 11, 7, 90, 84, 96, 38]
Current data/feature buff: torch.Size([61, 128, 20, 7]) torch.Size([61]) 61
Buffer classes: Counter({1: 19, 5: 15, 4: 11, 3: 8, 0: 5, 2: 3})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3871) local CE: tensor(0.2428) Feature CE: tensor(1.2057) KL: tensor(0.1036)
The last decorrelation: tensor(0.8277)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7315) local CE: tensor(0.4639) Feature CE: tensor(1.2210) KL: tensor(0.1310)
The last decorrelation: tensor(0.9160)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3285) local CE: tensor(0.1891) Feature CE: tensor(1.1721) KL: tensor(0.0649)
The last decorrelation: tensor(0.9018)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1338) local CE: tensor(0.1370) Feature CE: tensor(0.9740) KL: tensor(0.0758)
The last decorrelation: tensor(0.9550)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1505) local CE: tensor(0.0921) Feature CE: tensor(1.1258) KL: tensor(0.0722)
The last decorrelation: tensor(0.8576)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5037) local CE: tensor(0.3914) Feature CE: tensor(1.0299) KL: tensor(0.1116)
The last decorrelation: tensor(0.9573)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9353) local CE: tensor(0.7478) Feature CE: tensor(1.1841) KL: tensor(0.0646)
The last decorrelation: tensor(0.9414)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5050) local CE: tensor(0.3892) Feature CE: tensor(1.1165) KL: tensor(0.1094)
The last decorrelation: tensor(0.8877)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9478) local CE: tensor(0.7828) Feature CE: tensor(1.1945) KL: tensor(0.0430)
The last decorrelation: tensor(0.9275)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9884) local CE: tensor(0.8046) Feature CE: tensor(1.1964) KL: tensor(0.0450)
The last decorrelation: tensor(0.9424)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9560) local CE: tensor(0.7365) Feature CE: tensor(1.1645) KL: tensor(0.0634)
The last decorrelation: tensor(0.9917)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6677) local CE: tensor(0.3471) Feature CE: tensor(1.1969) KL: tensor(0.1677)
The last decorrelation: tensor(0.9554)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6711) local CE: tensor(0.5361) Feature CE: tensor(1.1804) KL: tensor(0.0682)
The last decorrelation: tensor(0.8873)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3171) local CE: tensor(0.2661) Feature CE: tensor(1.0799) KL: tensor(0.0886)
The last decorrelation: tensor(0.8835)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1907) local CE: tensor(0.1376) Feature CE: tensor(1.1339) KL: tensor(0.0642)
The last decorrelation: tensor(0.8502)
Global Model Acc on global data: 0.5680352901255514 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  90  -------------
selected users: [90, 16, 15, 111, 136, 44, 85, 116, 49, 124, 131, 22, 117, 122, 41]
Current data/feature buff: torch.Size([76, 128, 20, 7]) torch.Size([76]) 76
Buffer classes: Counter({4: 24, 2: 17, 0: 16, 5: 8, 1: 6, 3: 5})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0048) local CE: tensor(0.3950) Feature CE: tensor(1.4044) KL: tensor(0.2507)
The last decorrelation: tensor(0.9552)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2961) local CE: tensor(0.2156) Feature CE: tensor(1.0125) KL: tensor(0.1049)
The last decorrelation: tensor(0.9801)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5416) local CE: tensor(0.3184) Feature CE: tensor(1.1892) KL: tensor(0.0862)
The last decorrelation: tensor(0.9372)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1078) local CE: tensor(0.7316) Feature CE: tensor(1.2786) KL: tensor(0.1017)
The last decorrelation: tensor(0.9959)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6910) local CE: tensor(0.5194) Feature CE: tensor(1.0811) KL: tensor(0.1499)
The last decorrelation: tensor(0.9171)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4533) local CE: tensor(0.3644) Feature CE: tensor(1.0342) KL: tensor(0.0701)
The last decorrelation: tensor(0.9884)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6915) local CE: tensor(0.5935) Feature CE: tensor(1.0194) KL: tensor(0.1302)
The last decorrelation: tensor(0.9485)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7293) local CE: tensor(0.4764) Feature CE: tensor(1.2034) KL: tensor(0.1345)
The last decorrelation: tensor(0.9156)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8553) local CE: tensor(0.5554) Feature CE: tensor(1.2202) KL: tensor(0.1139)
The last decorrelation: tensor(0.9661)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5864) local CE: tensor(0.3830) Feature CE: tensor(1.1740) KL: tensor(0.0666)
The last decorrelation: tensor(0.9777)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7377) local CE: tensor(0.4594) Feature CE: tensor(1.2060) KL: tensor(0.1252)
The last decorrelation: tensor(0.9471)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1357) local CE: tensor(0.2656) Feature CE: tensor(0.9375) KL: tensor(0.0947)
The last decorrelation: tensor(0.8375)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8795) local CE: tensor(0.7055) Feature CE: tensor(1.1592) KL: tensor(0.0755)
The last decorrelation: tensor(0.9371)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4915) local CE: tensor(0.3933) Feature CE: tensor(1.0334) KL: tensor(0.1635)
The last decorrelation: tensor(0.8758)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9906) local CE: tensor(0.0718) Feature CE: tensor(0.9664) KL: tensor(0.0846)
The last decorrelation: tensor(0.8656)
Global Model Acc on global data: 0.6409908381404819 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  91  -------------
selected users: [140, 97, 94, 120, 108, 50, 51, 24, 59, 100, 3, 125, 90, 135, 20]
Current data/feature buff: torch.Size([66, 128, 20, 7]) torch.Size([66]) 66
Buffer classes: Counter({0: 22, 5: 16, 3: 14, 4: 12, 1: 1, 2: 1})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0468) local CE: tensor(0.6699) Feature CE: tensor(1.1468) KL: tensor(0.2706)
The last decorrelation: tensor(0.9594)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9066) local CE: tensor(0.0543) Feature CE: tensor(0.9578) KL: tensor(0.0506)
The last decorrelation: tensor(0.8535)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9340) local CE: tensor(0.4311) Feature CE: tensor(1.3990) KL: tensor(0.1771)
The last decorrelation: tensor(0.9268)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9635) local CE: tensor(0.8123) Feature CE: tensor(1.1389) KL: tensor(0.0852)
The last decorrelation: tensor(0.9270)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7201) local CE: tensor(0.5046) Feature CE: tensor(1.1180) KL: tensor(0.1482)
The last decorrelation: tensor(0.9493)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1387) local CE: tensor(0.5449) Feature CE: tensor(1.5145) KL: tensor(0.1240)
The last decorrelation: tensor(0.9554)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3259) local CE: tensor(0.2382) Feature CE: tensor(1.1159) KL: tensor(0.0867)
The last decorrelation: tensor(0.8865)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5120) local CE: tensor(0.3305) Feature CE: tensor(1.0901) KL: tensor(0.1560)
The last decorrelation: tensor(0.9348)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0343) local CE: tensor(0.8011) Feature CE: tensor(1.1620) KL: tensor(0.0842)
The last decorrelation: tensor(0.9795)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5860) local CE: tensor(0.4089) Feature CE: tensor(1.1188) KL: tensor(0.1404)
The last decorrelation: tensor(0.9280)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1653) local CE: tensor(0.6764) Feature CE: tensor(1.3095) KL: tensor(0.1936)
The last decorrelation: tensor(0.9861)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4648) local CE: tensor(0.3950) Feature CE: tensor(1.0198) KL: tensor(0.0847)
The last decorrelation: tensor(0.9654)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8023) local CE: tensor(0.4234) Feature CE: tensor(1.1577) KL: tensor(0.2616)
The last decorrelation: tensor(0.9594)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3623) local CE: tensor(0.2417) Feature CE: tensor(1.0955) KL: tensor(0.1073)
The last decorrelation: tensor(0.9174)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0323) local CE: tensor(0.6449) Feature CE: tensor(1.3467) KL: tensor(0.0879)
The last decorrelation: tensor(0.9529)
Global Model Acc on global data: 0.6192738378011537 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  92  -------------
selected users: [40, 35, 25, 68, 112, 102, 123, 83, 43, 96, 13, 131, 70, 117, 138]
Current data/feature buff: torch.Size([49, 128, 20, 7]) torch.Size([49]) 49
Buffer classes: Counter({0: 14, 3: 12, 5: 9, 4: 7, 2: 6, 1: 1})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9460) local CE: tensor(0.1030) Feature CE: tensor(0.8764) KL: tensor(0.0494)
The last decorrelation: tensor(0.9167)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1877) local CE: tensor(0.3276) Feature CE: tensor(0.9783) KL: tensor(0.0335)
The last decorrelation: tensor(0.8481)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1252) local CE: tensor(0.7956) Feature CE: tensor(1.2637) KL: tensor(0.0661)
The last decorrelation: tensor(0.9997)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1955) local CE: tensor(0.1823) Feature CE: tensor(0.9559) KL: tensor(0.0582)
The last decorrelation: tensor(0.9991)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3490) local CE: tensor(0.3376) Feature CE: tensor(1.0226) KL: tensor(0.0587)
The last decorrelation: tensor(0.9302)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0774) local CE: tensor(0.1072) Feature CE: tensor(0.9426) KL: tensor(0.0646)
The last decorrelation: tensor(0.9632)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4480) local CE: tensor(0.3591) Feature CE: tensor(1.1761) KL: tensor(0.0529)
The last decorrelation: tensor(0.8600)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0563) local CE: tensor(0.1870) Feature CE: tensor(0.9902) KL: tensor(0.0369)
The last decorrelation: tensor(0.8283)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7043) local CE: tensor(0.5559) Feature CE: tensor(1.1329) KL: tensor(0.1183)
The last decorrelation: tensor(0.8974)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9700) local CE: tensor(0.6649) Feature CE: tensor(1.2898) KL: tensor(0.1323)
The last decorrelation: tensor(0.8886)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1456) local CE: tensor(0.6906) Feature CE: tensor(1.2660) KL: tensor(0.2006)
The last decorrelation: tensor(0.9883)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4410) local CE: tensor(0.3499) Feature CE: tensor(1.0077) KL: tensor(0.1363)
The last decorrelation: tensor(0.9471)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6104) local CE: tensor(0.4304) Feature CE: tensor(1.0881) KL: tensor(0.1304)
The last decorrelation: tensor(0.9503)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9927) local CE: tensor(0.7571) Feature CE: tensor(1.2285) KL: tensor(0.0646)
The last decorrelation: tensor(0.9367)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9905) local CE: tensor(0.7320) Feature CE: tensor(1.2090) KL: tensor(0.0686)
The last decorrelation: tensor(0.9810)
Global Model Acc on global data: 0.5785544621649135 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  93  -------------
selected users: [102, 131, 144, 123, 63, 103, 81, 126, 27, 1, 90, 84, 116, 35, 98]
Current data/feature buff: torch.Size([41, 128, 20, 7]) torch.Size([41]) 41
Buffer classes: Counter({3: 18, 4: 12, 1: 5, 0: 3, 2: 2, 5: 1})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.8272) local CE: tensor(0.0537) Feature CE: tensor(0.7506) KL: tensor(0.0540)
The last decorrelation: tensor(0.9620)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8152) local CE: tensor(0.4909) Feature CE: tensor(1.2789) KL: tensor(0.0983)
The last decorrelation: tensor(0.9471)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4206) local CE: tensor(0.7393) Feature CE: tensor(1.6121) KL: tensor(0.0899)
The last decorrelation: tensor(0.9795)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4957) local CE: tensor(0.3311) Feature CE: tensor(1.2422) KL: tensor(0.0627)
The last decorrelation: tensor(0.8599)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8596) local CE: tensor(0.4488) Feature CE: tensor(1.3802) KL: tensor(0.1276)
The last decorrelation: tensor(0.8999)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1999) local CE: tensor(0.1855) Feature CE: tensor(1.1055) KL: tensor(0.0732)
The last decorrelation: tensor(0.8321)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5194) local CE: tensor(0.3544) Feature CE: tensor(1.2531) KL: tensor(0.0545)
The last decorrelation: tensor(0.8530)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2815) local CE: tensor(0.0492) Feature CE: tensor(1.2060) KL: tensor(0.0739)
The last decorrelation: tensor(0.9525)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5408) local CE: tensor(0.3431) Feature CE: tensor(1.2849) KL: tensor(0.0767)
The last decorrelation: tensor(0.8376)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9641) local CE: tensor(0.7693) Feature CE: tensor(1.0868) KL: tensor(0.1192)
The last decorrelation: tensor(0.9888)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4726) local CE: tensor(0.3313) Feature CE: tensor(1.0026) KL: tensor(0.1824)
The last decorrelation: tensor(0.9566)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.9603) local CE: tensor(1.3594) Feature CE: tensor(1.5980) KL: tensor(0.1182)
The last decorrelation: tensor(0.8863)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.6815) local CE: tensor(1.2967) Feature CE: tensor(1.3545) KL: tensor(0.1155)
The last decorrelation: tensor(0.9159)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5978) local CE: tensor(0.3525) Feature CE: tensor(1.3402) KL: tensor(0.0568)
The last decorrelation: tensor(0.8485)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5456) local CE: tensor(0.4050) Feature CE: tensor(1.1922) KL: tensor(0.0808)
The last decorrelation: tensor(0.8699)
Global Model Acc on global data: 0.49406175771971494 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  94  -------------
selected users: [127, 74, 135, 53, 99, 76, 17, 81, 55, 128, 44, 83, 8, 57, 116]
Current data/feature buff: torch.Size([57, 128, 20, 7]) torch.Size([57]) 57
Buffer classes: Counter({2: 25, 3: 18, 0: 7, 1: 7})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9095) local CE: tensor(0.6525) Feature CE: tensor(1.1847) KL: tensor(0.1095)
The last decorrelation: tensor(0.9699)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.8038) local CE: tensor(0.1621) Feature CE: tensor(0.6699) KL: tensor(0.1029)
The last decorrelation: tensor(0.8639)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1625) local CE: tensor(0.1783) Feature CE: tensor(0.9397) KL: tensor(0.1270)
The last decorrelation: tensor(0.9173)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4901) local CE: tensor(1.0512) Feature CE: tensor(1.4225) KL: tensor(0.0480)
The last decorrelation: tensor(0.9397)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9006) local CE: tensor(0.4877) Feature CE: tensor(1.3401) KL: tensor(0.1884)
The last decorrelation: tensor(0.8848)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3280) local CE: tensor(0.1770) Feature CE: tensor(1.0964) KL: tensor(0.0961)
The last decorrelation: tensor(0.9704)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1255) local CE: tensor(0.7882) Feature CE: tensor(1.3189) KL: tensor(0.0552)
The last decorrelation: tensor(0.9631)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2916) local CE: tensor(0.3344) Feature CE: tensor(0.9898) KL: tensor(0.1094)
The last decorrelation: tensor(0.8611)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0521) local CE: tensor(0.7198) Feature CE: tensor(1.2667) KL: tensor(0.1365)
The last decorrelation: tensor(0.9343)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5822) local CE: tensor(0.4999) Feature CE: tensor(0.9753) KL: tensor(0.2154)
The last decorrelation: tensor(0.8950)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9491) local CE: tensor(0.5389) Feature CE: tensor(1.3614) KL: tensor(0.0718)
The last decorrelation: tensor(0.9666)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2883) local CE: tensor(0.2704) Feature CE: tensor(1.0947) KL: tensor(0.0829)
The last decorrelation: tensor(0.8343)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1299) local CE: tensor(0.1206) Feature CE: tensor(0.9077) KL: tensor(0.1440)
The last decorrelation: tensor(0.9580)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(1.9752) local CE: tensor(0.0928) Feature CE: tensor(0.9019) KL: tensor(0.0949)
The last decorrelation: tensor(0.8872)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2297) local CE: tensor(0.8565) Feature CE: tensor(1.1528) KL: tensor(0.3051)
The last decorrelation: tensor(0.9161)
Global Model Acc on global data: 0.5710892432982694 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  95  -------------
selected users: [101, 122, 108, 10, 48, 145, 88, 114, 21, 93, 47, 73, 18, 141, 146]
Current data/feature buff: torch.Size([94, 128, 20, 7]) torch.Size([94]) 94
Buffer classes: Counter({5: 40, 3: 18, 1: 13, 0: 12, 2: 8, 4: 3})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3074) local CE: tensor(0.2122) Feature CE: tensor(1.1555) KL: tensor(0.0622)
The last decorrelation: tensor(0.8798)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4490) local CE: tensor(0.2876) Feature CE: tensor(1.0901) KL: tensor(0.1697)
The last decorrelation: tensor(0.9149)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4838) local CE: tensor(0.3300) Feature CE: tensor(1.0221) KL: tensor(0.1820)
The last decorrelation: tensor(0.9496)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4614) local CE: tensor(0.4740) Feature CE: tensor(0.9258) KL: tensor(0.0796)
The last decorrelation: tensor(0.9832)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3602) local CE: tensor(0.1588) Feature CE: tensor(1.1643) KL: tensor(0.1069)
The last decorrelation: tensor(0.9301)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2982) local CE: tensor(0.1658) Feature CE: tensor(1.1895) KL: tensor(0.0735)
The last decorrelation: tensor(0.8631)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7560) local CE: tensor(0.3935) Feature CE: tensor(1.1872) KL: tensor(0.2009)
The last decorrelation: tensor(0.9701)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7892) local CE: tensor(0.5261) Feature CE: tensor(1.1516) KL: tensor(0.1509)
The last decorrelation: tensor(0.9573)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3351) local CE: tensor(0.9419) Feature CE: tensor(1.3225) KL: tensor(0.0880)
The last decorrelation: tensor(0.9826)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8039) local CE: tensor(0.4840) Feature CE: tensor(1.1368) KL: tensor(0.1851)
The last decorrelation: tensor(0.9980)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1279) local CE: tensor(0.2375) Feature CE: tensor(0.8385) KL: tensor(0.0761)
The last decorrelation: tensor(0.9854)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2221) local CE: tensor(0.1762) Feature CE: tensor(1.1450) KL: tensor(0.0561)
The last decorrelation: tensor(0.8494)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3868) local CE: tensor(0.2129) Feature CE: tensor(1.1326) KL: tensor(0.0958)
The last decorrelation: tensor(0.9501)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4029) local CE: tensor(0.2854) Feature CE: tensor(1.1802) KL: tensor(0.0391)
The last decorrelation: tensor(0.8982)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6182) local CE: tensor(0.4259) Feature CE: tensor(1.1586) KL: tensor(0.1137)
The last decorrelation: tensor(0.9197)
Global Model Acc on global data: 0.5989141499830336 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  96  -------------
selected users: [30, 47, 43, 90, 115, 49, 5, 70, 36, 86, 59, 48, 15, 144, 53]
Current data/feature buff: torch.Size([48, 128, 20, 7]) torch.Size([48]) 48
Buffer classes: Counter({4: 13, 2: 12, 5: 9, 0: 8, 3: 6})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7478) local CE: tensor(0.5254) Feature CE: tensor(1.2828) KL: tensor(0.0741)
The last decorrelation: tensor(0.8678)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1746) local CE: tensor(0.1862) Feature CE: tensor(0.9467) KL: tensor(0.0637)
The last decorrelation: tensor(0.9702)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6518) local CE: tensor(0.4761) Feature CE: tensor(1.1780) KL: tensor(0.1001)
The last decorrelation: tensor(0.8981)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6291) local CE: tensor(0.4077) Feature CE: tensor(1.0934) KL: tensor(0.1721)
The last decorrelation: tensor(0.9566)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1720) local CE: tensor(0.2052) Feature CE: tensor(0.9430) KL: tensor(0.0803)
The last decorrelation: tensor(0.9214)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3828) local CE: tensor(0.2524) Feature CE: tensor(1.1172) KL: tensor(0.0478)
The last decorrelation: tensor(0.9654)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6581) local CE: tensor(0.6324) Feature CE: tensor(1.0404) KL: tensor(0.0654)
The last decorrelation: tensor(0.9195)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7358) local CE: tensor(0.4671) Feature CE: tensor(1.1554) KL: tensor(0.1471)
The last decorrelation: tensor(0.9579)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4470) local CE: tensor(0.4021) Feature CE: tensor(1.1080) KL: tensor(0.0651)
The last decorrelation: tensor(0.8761)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4081) local CE: tensor(0.3595) Feature CE: tensor(0.9933) KL: tensor(0.0886)
The last decorrelation: tensor(0.9702)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9716) local CE: tensor(0.6525) Feature CE: tensor(1.2810) KL: tensor(0.0507)
The last decorrelation: tensor(0.9896)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.2292) local CE: tensor(0.0868) Feature CE: tensor(1.1113) KL: tensor(0.1012)
The last decorrelation: tensor(0.9295)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4188) local CE: tensor(0.2811) Feature CE: tensor(1.1335) KL: tensor(0.0472)
The last decorrelation: tensor(0.9566)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4123) local CE: tensor(0.2459) Feature CE: tensor(1.1293) KL: tensor(0.0575)
The last decorrelation: tensor(0.9799)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2628) local CE: tensor(0.9614) Feature CE: tensor(1.2908) KL: tensor(0.0366)
The last decorrelation: tensor(0.9788)
Global Model Acc on global data: 0.6019681031557517 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  97  -------------
selected users: [48, 21, 63, 88, 146, 91, 22, 59, 6, 117, 86, 38, 72, 55, 123]
Current data/feature buff: torch.Size([57, 128, 20, 7]) torch.Size([57]) 57
Buffer classes: Counter({5: 17, 4: 17, 3: 15, 1: 6, 2: 2})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4473) local CE: tensor(0.1623) Feature CE: tensor(1.2701) KL: tensor(0.0849)
The last decorrelation: tensor(0.9300)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9271) local CE: tensor(0.7715) Feature CE: tensor(1.0705) KL: tensor(0.1024)
The last decorrelation: tensor(0.9827)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6054) local CE: tensor(0.2486) Feature CE: tensor(1.3717) KL: tensor(0.0805)
The last decorrelation: tensor(0.9013)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2054) local CE: tensor(0.6713) Feature CE: tensor(1.3947) KL: tensor(0.1685)
The last decorrelation: tensor(0.9700)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1096) local CE: tensor(0.5145) Feature CE: tensor(1.4741) KL: tensor(0.2014)
The last decorrelation: tensor(0.9196)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.2631) local CE: tensor(0.8710) Feature CE: tensor(1.2583) KL: tensor(0.1812)
The last decorrelation: tensor(0.9525)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3768) local CE: tensor(0.2730) Feature CE: tensor(1.2121) KL: tensor(0.0532)
The last decorrelation: tensor(0.8385)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7970) local CE: tensor(0.6312) Feature CE: tensor(1.1000) KL: tensor(0.0757)
The last decorrelation: tensor(0.9889)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1606) local CE: tensor(0.2065) Feature CE: tensor(0.9560) KL: tensor(0.0689)
The last decorrelation: tensor(0.9291)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.8697) local CE: tensor(0.7558) Feature CE: tensor(1.1271) KL: tensor(0.0500)
The last decorrelation: tensor(0.9390)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4854) local CE: tensor(0.3284) Feature CE: tensor(0.9883) KL: tensor(0.2040)
The last decorrelation: tensor(0.9621)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3365) local CE: tensor(0.1041) Feature CE: tensor(1.3346) KL: tensor(0.0368)
The last decorrelation: tensor(0.8583)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0240) local CE: tensor(0.6861) Feature CE: tensor(1.2867) KL: tensor(0.1409)
The last decorrelation: tensor(0.9101)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.7952) local CE: tensor(0.6462) Feature CE: tensor(1.1036) KL: tensor(0.1155)
The last decorrelation: tensor(0.9383)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4717) local CE: tensor(0.2627) Feature CE: tensor(1.2965) KL: tensor(0.0521)
The last decorrelation: tensor(0.8607)
Global Model Acc on global data: 0.6504920257889379 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  98  -------------
selected users: [70, 96, 94, 52, 46, 78, 72, 97, 102, 14, 77, 53, 90, 41, 56]
Current data/feature buff: torch.Size([50, 128, 20, 7]) torch.Size([50]) 50
Buffer classes: Counter({5: 16, 4: 12, 3: 11, 0: 6, 2: 4, 1: 1})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6558) local CE: tensor(0.4283) Feature CE: tensor(1.0826) KL: tensor(0.1826)
The last decorrelation: tensor(0.9567)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9016) local CE: tensor(0.5854) Feature CE: tensor(1.3578) KL: tensor(0.0749)
The last decorrelation: tensor(0.8626)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0125) local CE: tensor(0.4389) Feature CE: tensor(1.5505) KL: tensor(0.0954)
The last decorrelation: tensor(0.9277)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5321) local CE: tensor(0.3222) Feature CE: tensor(1.2756) KL: tensor(0.0648)
The last decorrelation: tensor(0.8610)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0945) local CE: tensor(0.8358) Feature CE: tensor(1.2668) KL: tensor(0.0855)
The last decorrelation: tensor(0.9064)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3055) local CE: tensor(0.4259) Feature CE: tensor(0.7632) KL: tensor(0.1168)
The last decorrelation: tensor(0.9995)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6691) local CE: tensor(0.5565) Feature CE: tensor(1.1155) KL: tensor(0.0870)
The last decorrelation: tensor(0.9100)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1557) local CE: tensor(0.1148) Feature CE: tensor(1.1499) KL: tensor(0.0418)
The last decorrelation: tensor(0.8531)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0963) local CE: tensor(0.0818) Feature CE: tensor(1.0021) KL: tensor(0.0451)
The last decorrelation: tensor(0.9697)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4586) local CE: tensor(0.2716) Feature CE: tensor(1.2286) KL: tensor(0.0554)
The last decorrelation: tensor(0.9026)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.4006) local CE: tensor(0.8643) Feature CE: tensor(1.5015) KL: tensor(0.1155)
The last decorrelation: tensor(0.9199)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1372) local CE: tensor(0.9357) Feature CE: tensor(1.1977) KL: tensor(0.0412)
The last decorrelation: tensor(0.9778)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1076) local CE: tensor(0.4123) Feature CE: tensor(1.4309) KL: tensor(0.3090)
The last decorrelation: tensor(0.9549)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.1886) local CE: tensor(0.1045) Feature CE: tensor(1.1709) KL: tensor(0.0460)
The last decorrelation: tensor(0.8678)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5161) local CE: tensor(0.4051) Feature CE: tensor(1.1275) KL: tensor(0.0710)
The last decorrelation: tensor(0.9117)
Global Model Acc on global data: 0.4801493043773329 length of data: 2947
size of the global feature buffer: 15
-------------Round number:  99  -------------
selected users: [139, 8, 74, 120, 4, 89, 78, 108, 24, 70, 122, 87, 127, 94, 124]
Current data/feature buff: torch.Size([82, 128, 20, 7]) torch.Size([82]) 82
Buffer classes: Counter({0: 34, 3: 24, 1: 18, 4: 5, 5: 1})
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.0323) local CE: tensor(0.1210) Feature CE: tensor(0.7960) KL: tensor(0.1562)
The last decorrelation: tensor(0.9591)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.3112) local CE: tensor(0.1557) Feature CE: tensor(1.0667) KL: tensor(0.1244)
The last decorrelation: tensor(0.9597)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6547) local CE: tensor(0.3475) Feature CE: tensor(1.2099) KL: tensor(0.2237)
The last decorrelation: tensor(0.8754)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9593) local CE: tensor(0.7424) Feature CE: tensor(1.1834) KL: tensor(0.1058)
The last decorrelation: tensor(0.9277)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.1038) local CE: tensor(0.7712) Feature CE: tensor(1.1225) KL: tensor(0.3369)
The last decorrelation: tensor(0.8699)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.3307) local CE: tensor(0.8623) Feature CE: tensor(1.3850) KL: tensor(0.1495)
The last decorrelation: tensor(0.9338)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9445) local CE: tensor(0.5134) Feature CE: tensor(1.2757) KL: tensor(0.1560)
The last decorrelation: tensor(0.9995)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.9655) local CE: tensor(0.5315) Feature CE: tensor(1.2227) KL: tensor(0.2619)
The last decorrelation: tensor(0.9495)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.5894) local CE: tensor(0.2844) Feature CE: tensor(1.1648) KL: tensor(0.2093)
The last decorrelation: tensor(0.9262)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6813) local CE: tensor(0.4205) Feature CE: tensor(1.0716) KL: tensor(0.2288)
The last decorrelation: tensor(0.9425)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4534) local CE: tensor(0.2981) Feature CE: tensor(1.0432) KL: tensor(0.2128)
The last decorrelation: tensor(0.8926)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6791) local CE: tensor(0.3485) Feature CE: tensor(1.2177) KL: tensor(0.1454)
The last decorrelation: tensor(0.9805)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(3.0826) local CE: tensor(0.7496) Feature CE: tensor(1.2608) KL: tensor(0.1130)
The last decorrelation: tensor(0.9725)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.6218) local CE: tensor(0.4661) Feature CE: tensor(1.0004) KL: tensor(0.2279)
The last decorrelation: tensor(0.9272)
Local adapation with distilling: 0.0001 alphas: 1 1 1 1
MCE_DeC_KL Total: tensor(2.4031) local CE: tensor(0.2981) Feature CE: tensor(0.9977) KL: tensor(0.1352)
The last decorrelation: tensor(0.9797)
Global Model Acc on global data: 0.5819477434679335 length of data: 2947
size of the global feature buffer: 15
